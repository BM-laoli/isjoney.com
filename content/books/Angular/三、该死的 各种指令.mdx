---
title: "Angular æŒ‡ä»¤ä¸æ¨¡æ¿æ·±åº¦è§£æ"
date: "2024-06-17"
summary: "å…¨é¢è®²è§£ Angular æŒ‡ä»¤ç³»ç»Ÿï¼ŒåŒ…æ‹¬åŒå‘ç»‘å®šã€ç»“æ„å‹æŒ‡ä»¤ã€å±æ€§å‹æŒ‡ä»¤ã€æ¨¡æ¿å¼•ç”¨å˜é‡ã€ç®¡é“æ“ä½œç¬¦ä»¥åŠç»„ä»¶æŠ•å½±ç­‰æ ¸å¿ƒæ¦‚å¿µï¼Œé…åˆå®é™…ä»£ç ç¤ºä¾‹æ·±å…¥ç†è§£ Angular æ¨¡æ¿æœºåˆ¶ã€‚"
status: "completed"
tech: ["Angular", "Directives", "Templates"]
github: "https://github.com/BM-laoli"
arxiv: ""
keyId: "Angular"
---

# æŒ‡ä»¤
> åœ¨ngä¸­é™¤å»åŸºæœ¬çš„è¯­æ³•ä¹‹å¤– å¯¹äºæ¨¡æ¿ templateæ¥è¯´ æœ€å¤§ä¸€å—å†…å®¹å°±æ˜¯æŒ‡ä»¤äº†
>

## åŸºæœ¬çš„åŒå‘ç»‘å®š
> åŸºæœ¬çš„åŒå‘ç»‘å®šå’ŒVueå®é™…ä¸Šä¹Ÿå·®ä¸å¤š, å®ƒçš„å†™æ³•å¦‚ä¸‹é¢è¿™æ ·, è¿™é‡Œæˆ‘ä»¬ç»“åˆ ä¸¤ä¸ªçˆ¶å­ç»„ä»¶æ¥è¯´æ˜ å¦‚ä½•åš åŒå‘ç»‘å®š æ ¸å¿ƒè¦ç‚¹å°±æ˜¯**<font style="color:#F5222D;"> [ (  ) ] = event  è‡³äºå…·ä½“çš„å·¥ä½œåŸç† å®é™…ä¸Šå°±æ˜¯output input + emit å®˜æ–¹æ–‡æ¡£æœ‰è¯¦ç»†çš„</font>**[**è§£é‡Š**](https://angular.cn/guide/two-way-binding)
>

```typescript
# son ç»„ä»¶
import { Component, OnInit, Input, Output, EventEmitter, ChangeDetectionStrategy } from '@angular/core';

@Component({
  selector: 'app-son',
  template: `
    <div>
    <button class="btn btn-danger" (click)="dec()" title="smaller">-</button>
    <button class="btn btn-primary" (click)="inc()" title="bigger">+</button>
    <label [style.font-size.px]="size">FontSize: {{size}}px</label>
    </div>
  `,
  changeDetection: ChangeDetectionStrategy.OnPush,  // è¿™æ˜¯ä¸€ç§ å˜æ›´æ£€æµ‹ çš„ç­–ç•¥ï¼Œä½ ...æ— è„‘åŠ ä¸Šå°±å¥½äº†
  styles: [
  ]
})
export class SonComponent implements OnInit {
  @Input()  size: number | string;
  // æƒ³è¦ç”¨åŒå‘ç»‘å®šè¯­æ³•ï¼Œoutputå˜é‡åå°±ä¸€å®šæ˜¯è¾“å…¥å±æ€§ååŠ ä¸ŠChange
  @Output() sizeChange = new EventEmitter<number>();

  constructor() {}
  ngOnInit(): void {}

  dec() { this.resize(-1); }
  inc() { this.resize(+1); }
  resize(delta: number) {
    this.size = Math.min(40, Math.max(8, +this.size + delta));
    this.sizeChange.emit(this.size);
  }
}


# father ç»„ä»¶
import { Component, OnInit } from '@angular/core';

@Component({
  selector: 'app-father',
  template: `
   <app-son [(size)] = "fontSizePx"></app-son>
   <button class="btn btn-primary"  (click) ="getValue()" title="bigger">getValue</button>
  `,
  styles: [
  ]
})
export class FatherComponent implements OnInit {

  fontSizePx = 12;

  getValue(value:any) {
    console.log(this.fontSizePx);
  }

  constructor() {}

  ngOnInit(): void {}


}

```

## è¡¨å•ä¸­çš„åŒå‘ç»‘å®š
> è¯ä¸å¤šè¯´ ç›´æ¥çœ‹ ä»£ç Code [å®˜æ–¹æ–‡æ¡£](https://angular.cn/api/forms/NgModel)
>

```typescript
# é¦–å…ˆ ng ä¸­å®ç°åŒå‘ç»‘å®š éœ€è¦ä½¿ç”¨ä¸€ä¸ª å«åš â€œæŒ‡ä»¤ï¼ˆå‡†ç¡®æ¥è¯´ è¿™é‡Œè¦ä½¿ç”¨çš„ å†…ç½®æŒ‡ä»¤ï¼‰â€çš„ä¸œè¥¿ã€‚ngModel
# å‰é¢å°±è¯´è¿‡ å¦‚æœä¸€ä¸ª moduel è¦ä½¿ç”¨ä¸€äº› â€œä¸å±äºå®ƒçš„åŠŸèƒ½â€çš„æ—¶å€™ éœ€è¦å¼•å…¥ å¤–éƒ¨çš„ä¾èµ– å¹¶ä¸”æ”¾åˆ° 
imports æ•°ç»„ä¸­ï¼Œæ‰€ä»¥ ç¬¬ä¸€æ­¥ éœ€è¦åŠ å…¥ä¸€ä¸ªFormsModule è¿™æ · ngModel è¿™ä¸ª æŒ‡ä»¤ æ‰èƒ½ç”Ÿæ•ˆ

# app.moduel.ts
import { FormsModule } from '@angular/forms'
++++
@NgModule({
++++
  imports: [
    BrowserModule,  
    AppRoutingModule,
    FormsModule // é‡ç‚¹ï¼
  ], 
++++
})
export class AppModule { }

# demo.compnents.ts
import { Component, OnInit } from '@angular/core';

@Component({
  selector: 'app-family',
  template: `
    <input [(ngModel)]="name" #ctrl="ngModel" required>
      
    <p>Value: {{ name }}</p>
    <p>Valid: {{ ctrl.valid }}</p>
    
    <button (click)="setValue()">Set value</button>
  `,
  styles: [
  ]
})
export class FamilyComponent implements OnInit {
  
  name: string = '';

  constructor() { }

  ngOnInit(): void {
  }

  setValue() {
    this.name = 'Nancy';
  }
}

// å®é™…ä¸Šä»æœ¬è´¨æ¥è¯´ [( ngModel )] æŒ‡ä»¤æ˜¯ è¿™ä¸ªæ–¹å¼çš„ä¸Šå±‚å°è£…
<input [(ngModel)]="name" /> 
ä¸Šé¢è¿™è¡Œä»£ç ç›¸å½“äºï¼š 
<input [value]="name" (input)="name = $event.target.value" />
 
// å¦‚æœè¯´ä½ æƒ³åœ¨formè¡¨å•ä¸­ä½¿ç”¨ ngModelè¯·çœ‹ä¸‹é¢çš„ç¤ºä¾‹ä»£ç 
  
import { Component, OnInit } from '@angular/core';
import {NgForm} from '@angular/forms';

@Component({
  selector: 'app-family',
  template: `
  <form>
    <input [(ngModel)]="value" name="name" />
    <input [(ngModel)]="value" [ngModelOptions]="{ standalone: true }" />
  </form>
  `,
  styles: [
  ]
})
export class FamilyComponent implements OnInit {
  
  name: string = '';

  constructor() { }

  ngOnInit(): void {
  }

}

```

## NgIf
1. æˆ‘ä»¬å…ˆæ¥çœ‹åŸºæœ¬çš„ä½¿ç”¨ å’Œè¯­æ³•ç³–

```typescript
import { Component, OnInit } from '@angular/core';
import {NgForm} from '@angular/forms';

@Component({
  selector: 'app-family',
  template: `
    <div *ngIf="condition">Content to render when condition is true.</div>  
    <button class="btn btn-primary" (click)="condition = !condition" title="bigger">change</button>
  
    <!--è¯­æ³•ç³– æˆ‘ä»¬ä¸€èˆ¬æ€ä¹ˆå†™
      ng-templateæ˜¯ä¸€å—å†…åµŒæ¨¡æ¿ ç±»å‹ TemplateRef-->
    <ng-template [ngIf]="condition">
      <div>Content to render when condition is true.</div>
    </ng-template>

    <!--ä¸‹é¢çš„elseè¯­æ³• æ³¨æ„æ­¤å¤„çš„ elseBlock å¹¶ä¸æ˜¯æŸä¸ªboolean è€Œæ˜¯ng-template
    çš„ä¸€å¼•ç”¨-->
    <div *ngIf="condition; else elseBlock">conditionä¸ºçœŸæ—¶æ˜¾ç¤º</div>
    <ng-template #elseBlock>
      <p>conditionä¸ºå‡æ—¶æ˜¾ç¤º</p>
    </ng-template>
    <ng-template #thenBlock>conditionä¸ºtrueæ—¶æ˜¾ç¤º</ng-template>
  `,
  styles: [
  ]
})
export class FamilyComponent implements OnInit {
  
  condition = true;

  constructor() { }

  ngOnInit(): void {
  }

}

```

ä¸Šé¢å°±æ˜¯ ä¸€ç§ éšå¼ çš„ä½¿ç”¨templateRef ï¼Œä¸‹é¢æ¼”ç¤ºæ€ä¹ˆç”¨ç»„ä»¶ä¸­çš„å˜é‡TemplateRefç±»å‹ [è¯·çœ‹æ–‡æ¡£](https://angular.cn/api/core/TemplateRef)

```typescript
import { Component, OnInit, ChangeDetectionStrategy, 
        ViewChild, TemplateRef, AfterViewInit } from '@angular/core';

@Component({
  selector: 'app-family',
  template: `
  <button class="btn btn-primary" (click)="condition = !condition">toggle block</button>
  <p *ngIf="condition else elseBlocks">{{ condition }} === true æ—¶æ˜¾ç¤º</p>
  <ng-template #firstTpl>
    <p>{{ condition }} === false æ—¶æ˜¾ç¤º</p>
  </ng-template>
  `,
  styles: [
  ]
})
export class FamilyComponent implements OnInit {
  elseBlocks: TemplateRef<any> = null;
  @ViewChild('firstTpl', {static: true}) primaryBlock: TemplateRef<any> = null;
  // å…ˆä¸è¦ç®¡è¿™ä¸ªè¯­æ³• ä½ ç…§ç€å†™å°±æ˜¯äº†ï¼Œåç»­ä¼šæ…¢æ…¢çš„è¯¦ç»†çš„ä»‹ç»
  condition = false;

  constructor() { }

  ngOnInit(): void {
    console.log('ngOnInit', this.primaryBlock);
    this.elseBlocks = this.primaryBlock;
  }

}

```

## NgSwitch
```typescript
import { Component, OnInit, ChangeDetectionStrategy, ViewChild, TemplateRef, AfterViewInit } from '@angular/core';

@Component({
  selector: 'app-family',
  template: `
      <p>
      <input 
        type="radio" 
        name="fruit" 
        value="apple" 
        id="apple" 
        [(ngModel)]="fruit" />
      <label for="apple">ğŸ</label>
    </p>
    <p>
      <input 
        type="radio" 
        name="fruit" 
        value="pear" 
        id="pear" 
        [(ngModel)]="fruit" />
      <label for="pear">ğŸ</label>
    </p>
    <p>
      <input 
        type="radio" 
        name="fruit" 
        value="grape" 
        id="grape" 
        [(ngModel)]="fruit" />
      <label for="grape">ğŸ‡</label>
    </p>
    <p>
      <input 
        type="radio" 
        name="fruit" 
        value="other" 
        id="other"
         [(ngModel)]="fruit" />
      <label for="other">other</label>
    </p>

    selected fruit: {{ fruit }}

    <div class="content" [ngSwitch]="fruit">
      <p *ngSwitchCase="'apple'">è¿™æ˜¯ è‹¹æœ</p>
      <p *ngSwitchCase="'pear'">è¿™æ˜¯ æ¢¨</p>
      <p *ngSwitchCase="'grape'">è¿™æ˜¯ è‘¡è„</p>
      <p *ngSwitchDefault>å•¥éƒ½ä¸æ˜¯</p>
    </div>
  `,
  styles: [
  ]
})
export class FamilyComponent implements OnInit {
  fruit = '';
  condition = false;

  constructor() { }

  ngOnInit(): void {
  }

}

```

## NgFor
> è¿™ä¸ªNgFor ï¼Œ
>

æœ€åŸºç¡€çš„ä½¿ç”¨ 

```typescript
import { Component, OnInit } from '@angular/core';
const Heros = [
  {
    id: 'hero_0',
    name: 'ç›–ä¼¦'
  },
  {
    id: 'hero_1',
    name: 'èµµä¿¡'
  },
  {
    id: 'hero_2',
    name: 'å˜‰æ–‡'
  },
  {
    id: 'hero_3',
    name: 'æ˜“å¤§å¸ˆ'
  },
  {
    id: 'hero_3',
    name: 'æ³°è¾¾ç±³å°”'
  }
];
interface Hero {
  id: string;
  name: string;
}

@Component({
  selector: 'app-family',
  template: `
    <p>
      add heroï¼š
      <button class="btn btn-info" (click)="reset()">reset</button>
    </p>
    <ul>
      <li 
        *ngFor="let item of heros;  trackBy: trackByHero" 
        [style.color]="item.id === 'hero_2' ? 'orange' : '#333'">{{ item.name }}</li>
    </ul>
  `,
  styles: [
  ]
})
export class FamilyComponent implements OnInit {
  heros: Hero[] = Heros;
  constructor() { }
  ngOnInit(): void {
  }
  reset() {
    this.heros = [
      {
        id: 'hero_4',
        name: 'ç›–ä¼¦4'
      },
      {
        id: 'hero_5',
        name: 'èµµä¿¡5'
      },
      {
        id: 'hero_2',
        name: 'å˜‰æ–‡'
      },
      {
        id: 'hero_6',
        name: 'æ˜“å¤§å¸ˆ6'
      },
      {
        id: 'hero_7',
        name: 'æ³°è¾¾ç±³å°”7'
      }
    ];
  }

  // trackByæ¥æ”¶ä¸€ä¸ªå‡½æ•°ï¼Œè¿”å› NgFor åº”è¯¥è·Ÿè¸ªçš„å€¼ï¼ˆæ¯”å¦‚idï¼‰ï¼Œ
  // è¿™æ ·åˆ·æ–°åˆ—è¡¨æ—¶ï¼Œidç›¸åŒçš„domä¸ä¼šè§¦å‘æ›´æ–°
  trackByHero(hero: Hero): string {
    return hero.id;
  }
}

```

æˆ‘ä»¬æ¥çœ‹çœ‹æ›´å¤šçš„æ‰©å±•å­—æ®µ

| å‚æ•° | å«ä¹‰ |
| --- | --- |
| <font style="color:rgb(36, 41, 47);">$implicit: Tï¼š</font> | <font style="color:rgb(36, 41, 47);">è¿­ä»£ç›®æ ‡ï¼ˆç»‘å®šåˆ°ngForOfï¼‰ä¸­æ¯ä¸ªæ¡ç›®çš„å€¼ã€‚</font> |
| <font style="color:rgb(36, 41, 47);">ngForOf: NgIterable</font> | <font style="color:rgb(36, 41, 47);">è¿­ä»£è¡¨è¾¾å¼çš„å€¼ã€‚å½“è¡¨è¾¾å¼ä¸å±€é™äºè®¿é—®æŸä¸ªå±æ€§æ—¶ï¼Œè¿™ä¼šéå¸¸æœ‰ç”¨ï¼Œæ¯”å¦‚åœ¨ä½¿ç”¨ async ç®¡é“æ—¶ï¼ˆuserStreams | asyncï¼‰</font> |
| <font style="color:rgb(36, 41, 47);">index: number</font> | <font style="color:rgb(36, 41, 47);">å¯è¿­ä»£å¯¹è±¡ä¸­å½“å‰æ¡ç›®çš„ç´¢å¼•ã€‚</font> |
| countï¼šnumber | <font style="color:rgb(36, 41, 47);">å¯è¿­ä»£å¯¹è±¡çš„é•¿åº¦ã€‚</font> |
| <font style="color:rgb(36, 41, 47);">first: boolean</font> | <font style="color:rgb(36, 41, 47);">å¦‚æœå½“å‰æ¡ç›®æ˜¯å¯è¿­ä»£å¯¹è±¡ä¸­çš„ç¬¬ä¸€ä¸ªæ¡ç›®åˆ™ä¸º trueã€‚</font> |
| <font style="color:rgb(36, 41, 47);">last: boolean</font> | <font style="color:rgb(36, 41, 47);">å¦‚æœå½“å‰æ¡ç›®æ˜¯å¯è¿­ä»£å¯¹è±¡ä¸­çš„æœ€åä¸€ä¸ªæ¡ç›®åˆ™ä¸º trueã€‚</font> |
| <font style="color:rgb(36, 41, 47);">even: boolean</font> | <font style="color:rgb(36, 41, 47);">å¦‚æœå½“å‰æ¡ç›®åœ¨å¯è¿­ä»£å¯¹è±¡ä¸­çš„ç´¢å¼•å·ä¸ºå¶æ•°åˆ™ä¸º trueã€‚</font> |
| <font style="color:rgb(36, 41, 47);">odd: boolean</font> | <font style="color:rgb(36, 41, 47);">å¦‚æœå½“å‰æ¡ç›®åœ¨å¯è¿­ä»£å¯¹è±¡ä¸­çš„ç´¢å¼•å·ä¸ºå¥‡æ•°åˆ™ä¸º trueã€‚</font> |


```typescript
import {Component} from '@angular/core';
@Component({
  selector: 'app-switch',
  template: `
    <ul>
      <li
        *ngFor="
        let item of heros; 
        index as i 
				count as len;
        let ev = even; 
        let od = odd; 
        let f = first; 
        let l = last 
        trackBy: trackByHero"
        [class.even]="ev"
      	[class.odd]="od">
        
        <p>first: {{ f }} -- last: {{ l }}</p>
        <p>name: {{ item.name }}</p>
        <p>length: {{ len }}</p>
        <p>index: {{ i }}</p>
        <hr />
      </li>
    </ul>
  `,
    styles: [`
    .even {
      color: #82fa54;
    }

    .odd {
      color: #698efa;
    }
  `]
})
export class SwitchComponent {
  heros: Hero[] = Heros;
  trackByHero(hero: Hero): string {
    return hero.id;
  }
}
```



## æ¨¡æ¿å¼•ç”¨å˜é‡
æ‰€è°“çš„æ¨¡æ¿å¼•ç”¨å˜é‡å®é™…ä¸Šæœ‰ç‚¹ç±»ä¼¼ï¼ŒReactä¸­çš„é¢Refï¼ˆå¦‚æœä½ ä¸æ‡‚Reactè¯·å¿½ç•¥ï¼‰ï¼Œå®ƒçš„ä½œç”¨æ˜¯å¯ä»¥æ‹¿åˆ°ä¸€äº›ä¸œè¥¿çš„å¼•ç”¨ï¼Œæ¯”å¦‚dom ã€æŒ‡ä»¤ã€ç»„ä»¶ã€å…ƒç´ ç­‰ã€‚å®ƒçš„å†™æ³•éå¸¸çš„ç®€å•

```typescript
<input #phone placeholder="phone number" /> 
  // è¿™æ ·ä¹Ÿæ˜¯å¯ä»¥çš„
<input ref-phone placeholder="phone number" /> 
  
<button (click)="callPhone(phone.value)">Call</button>

// è¿™çš„callPhone(phone.value)é‡Œçš„phone å°±æ˜¯ä¸Šé¢çš„inputè¿™ä¸ªDOMåŸç´ 
```



+ å®ƒæœ‰ä¸‹é¢çš„ä¸€äº›è§„åˆ™

1.å¦‚æœæ˜¯ç»„ä»¶ä¸Šå£°æ˜ # å°±æ˜¯ è·å–ç»„ä»¶å®ä¾‹

2.å¦‚æœæ˜¯HTMLä¸Šå£°æ˜ # å°±æ˜¯ è·å–å¼•ç”¨å…ƒç´ 

3.å¦‚æœæ˜¯<ng-template>ä¸Šå£°æ˜ # å°±æ˜¯ TemplatRef

4.å¦‚æœ#å·¦è¾¹æŒ‡å®šäº†ä¸€ä¸ªåå­—ï¼Œå°±æ˜¯å¼•ç”¨å…ƒç´ ä¸Šå…·å¤‡è¿™ä¸ªåå­—çš„æŒ‡ä»¤/ç»„ä»¶

```typescript
#var="ngModel" 

å¦‚æœæ˜¯TemplateRef ä½ å¯ä»¥è¿™æ ·è·å¾—å®ƒ
@ViewChild('firstTpl', {static: true}) primaryBlock: TemplateRef<any> = null;
```

+ å®ƒå¯ä»¥å’ŒNgFormç»“åˆ

```typescript
<form #itemForm="ngForm" (ngSubmit)="onSubmit(itemForm)">
  <label for="name">Name</label>
  <input type="text" id="name" class="form-control" name="name" ngModel required />
  <button type="submit">Submit</button>
</form>

<div [hidden]="!itemForm.form.valid">
  <p>{{ submitMessage }}</p>
</div>

// itemFormå‡ºç°äº†ä¸‰æ¬¡
// å¦‚æœæ²¡æœ‰ngFormçš„è¯ï¼Œé‚£ä¹ˆè¿™ä¸ªitemFormå°±æ˜¯formè¿™ä¸ªDOM å¦‚æœæœ‰äº†å°±æ˜¯è¿™ä¸ª NgFromæŒ‡ä»¤çš„å¼•ç”¨äº†
// æœ‰äº†è¿™ä¸ªå¼•ç”¨å°±èƒ½æ‹¿å®ƒåšå¾ˆå¤šNgFromä¸Šçš„äº‹æƒ…äº† ï¼Œæ¯”å¦‚valid




```

+ ä½ åº”è¯¥è¿˜éœ€å‘€å°å¿ƒå®ƒçš„ä½œç”¨åŸŸ

```typescript
// æ€»çš„æ¥è¯´ï¼Œå¦‚æœä½ å†™æˆè¿™æ ·
<input *ngIf="true" #ref2 type="text" [(ngModel)]="secondExample" />
<span>Value: {{ ref2?.value }}</span> <!-- doesn't work -->

// æˆ–åˆ™è¿™æ ·é‚£ä¹ˆå°±ä¸Šæœ‰é—®é¢˜çš„ï¼
<ng-container *ngFor="let i of [1,2]">
  <input #ref type="text" [value]="i" />
</ng-container>
{{ ref.value }}

// ç¬¬ä¸€ä¸ªä¸Šref2ä¸ä¸€å®šèƒ½è·å–åˆ°ä½ çš„ref2 å› ä¸ºå®ƒå‰é¢æœ‰ä¸€ä¸ª*ngIf
// ç¬¬äºŒä¸ª ç”±äº*ngFormæŠŠ è¿™ä¸ªng-conotaiernå®ä¾‹åŒ–äº†ä¸¤æ¬¡ï¼Œå¯¼è‡´ä¸çŸ¥é“åˆ°åº•æ˜¯å“ªä¸€ä¸ª

```

  


## æ¨¡æ¿è¿ç®—ç¬¦
æ‰€è°“çš„æ¨¡æ¿è¿ç®—ç¬¦å°±æ˜¯ä¸€äº›åœ¨æ¨¡æ¿ä¸Šçš„ç‰¹æ®Šè¯­æ³•ï¼Œä»–ä»¬å…·å¤‡ç‰¹æ®Šçš„åŠŸèƒ½ï¼Œæ¯”å¦‚pipe   


### ç®¡é“PipeåŸºç¡€ä½¿ç”¨
```typescript
// æ¯”å¦‚ä¸‹é¢çš„è¿™ä¸ªæœ€ç®€å•çš„ä¾‹å­ å®ƒæ ¼å¼åŒ–äº†æ—¥æœŸå’Œäº‹ä»¶
<p>The hero's birthday is {{ birthday | date }}</p>

// 
 birthday = new Date(1988, 3, 15); 


```

### ç®¡é“å‚æ•°å’Œä¸²è”  

```typescript
 è¿™é‡Œæ˜¯åŸæ•°æ® | è¿™é‡Œæ˜¯å¤„ç†ç®¡é“

 // å‚æ•°åœ¨å¤„ç†ç®¡é“è¿™é‡ŒåŠ ï¼Œè­¬å¦‚
{{ amount | currency:'EUR' }}  // ä¼šæŠŠ amount è½¬æ¢æˆæ¬§å…ƒã€‚
{{ amount | currency:'EUR':'Euros '}} 
// ä¼šæŠŠç¬¬äºŒä¸ªå‚æ•°ï¼ˆå­—ç¬¦ä¸² 'Euros 'ï¼‰æ·»åŠ åˆ°è¾“å‡ºå­—ç¬¦ä¸²ä¸­
// ä¸‹é¢çš„ä¾‹å­å¾ˆç®€å•æ˜“æ‡‚ 
<p>The hero's birthday is {{ birthday | date:"MM/dd/yy" }} </p>
// å‚æ•°ä¹Ÿå¯ä»¥ä» ç»„ä»¶ä¸­é€šè¿‡å‡½æ•°è¿”å›æ¯”å¦‚
  <p>The hero's birthday is {{ birthday | date:format }}</p>
  get format()   { return this.toggle ? 'shortDate' : 'fullDate'; }

// å—åˆ°FPç¼–ç¨‹æ–¹å¼çš„å½±å“ç®¡é“å¯ä»¥ å…‹é‡ŒåŒ– ä¸€ä¸ªä¸€ä¸ªä¸²è”èµ·æ¥ç”¨
{{  birthday | date:'fullDate' | uppercase}}  // ä»å·¦åˆ°å³çš„æ‰§è¡Œ


```

### è‡ªå®šä¹‰ç®¡é“


<font style="color:rgb(255, 255, 255);background-color:rgb(51, 51, 51);"> </font>[ng generate pipe](https://angular.cn/cli/generate#pipe)<font style="color:rgb(255, 255, 255);background-color:rgb(51, 51, 51);"> å‘½ä»¤ä¼šè‡ªåŠ¨æ³¨å†Œè¯¥ç®¡é“ã€‚</font>

```typescript
// è‡ªå®šä¹‰ç®¡é“éå¸¸çš„ç®€å•
 @Pipe è£…é¥°å™¨åº”ç”¨åˆ°è¿™ä¸ªç±»ä¸Šã€‚å°±å¥½äº†ï¼Œæ¯”å¦‚ä¸‹é¢ğŸ‘‡ ï¼ˆä¸»è¦æ˜¯å®ç°PipeTransform æ¥å£å’Œé‡å†™
transformæ¥å£
ï¼‰


import { Pipe, PipeTransform } from '@angular/core';
@Pipe({name: 'exponentialStrength'})
export class ExponentialStrengthPipe implements PipeTransform {
  transform(value: number, exponent = 1): number {
    return Math.pow(value, exponent);
  }
}

// ä½¿ç”¨ 
<p>Super power boost: {{2 | exponentialStrength: 10}}</p>
 
```

### å…³äºç®¡é“çš„å˜æ›´æ£€æµ‹  



```typescript
import { Component } from '@angular/core';

@Component({
  selector: 'app-power-boost-calculator',
  template: `
    <h2>Power Boost Calculator</h2>
    <label for="power-input">Normal power: </label>
    <input id="power-input" type="text" [(ngModel)]="power">
    <label for="boost-input">Boost factor: </label>
    <input id="boost-input" type="text" [(ngModel)]="factor">
    <p>
      Super Hero Power: {{power | exponentialStrength: factor}}
    </p>
  `,
  styles: ['input {margin: .5rem 0;}']
})
export class PowerBoostCalculatorComponent {
  power = 5;
  factor = 1;
}

// ä»ä¸Šé¢çš„ä¾‹å­æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œå¦‚æœç®¡é“æœ‰ç»‘å®šï¼Œé‚£ä¹ˆæ„å‘³ç€ï¼Œå¦‚æœå€¼å˜äº† é‚£ä¹ˆç®¡é“å°±ä¼šé‡æ–°æ‰§è¡Œ


// ä½†æ˜¯å®ƒæ˜¯è¿™ä¹ˆåšåˆ°çš„ï¼Œå¦‚æœæˆ‘ä¸å¸Œæœ›å®ƒå˜æ€ä¹ˆåŠï¼Ÿ å¯¹äºç®¡é“æ¥è¯´é»˜è®¤çš„æƒ…å†µä¸‹éƒ½æ˜¯ï¼šâ€çº¯çš„pureâ€œé»˜
// äººåªèƒ½åšå€¼æ£€æµ‹å’Œå¼•ç”¨æ£€æµ‹ï¼Œdepæ£€æµ‹æ²¡æœ‰å¤„ç† ä¹Ÿå°±æ˜¯è¯´pushæ•°ç»„ä¸ä¼šè§¦å‘æ›´æ–°ï¼Œå¦‚æœä½ éœ€è¦
// æ€ä¹ˆåšçš„æ—¶å€™è¯·ä½¿ç”¨ [...] , or {...}

// å¦‚æœæˆ‘è¯´æœ‰å‰¯ä½œç”¨çš„ç®¡é“æ€ä¹ˆåŠï¼Ÿå®˜æ–¹çŸ¥é“æ˜¯æŠŠ å‚æ•°pureå˜æˆfasleå°±å¥½äº†ï¼Œè­¬å¦‚ä¸‹é¢
// åŸºç¡€ç±» ï¼ˆé»˜è®¤çº¯çš„ï¼‰
import { Pipe, PipeTransform } from '@angular/core';

import { Hero } from './heroes';

@Pipe({ name: 'flyingHeroes' })
export class FlyingHeroesPipe implements PipeTransform {
  transform(allHeroes: Hero[]) {
    return allHeroes.filter(hero => hero.canFly);
  }
}

// æ´¾ç”Ÿçš„éçº¯çš„
@Pipe({
  name: 'flyingHeroesImpure',
  pure: false
})
export class FlyingHeroesImpurePipe extends FlyingHeroesPipe {}


// å¦‚æœä½ çš„ç®¡é“ä¾èµ–çš„å€¼è¯´ observeçš„ï¼Œé‚£ä¹ˆéœ€è¦æ³¨æ„äº† ï¼Œä½ éœ€è¦åšçš„äº‹æƒ…æ˜¯ ä½¿ç”¨ async å†…ç½®ç®¡é“
// å¤„ç†æ•°æ®

import { Component } from '@angular/core';

import { Observable, interval } from 'rxjs';
import { map, take } from 'rxjs/operators';

@Component({
  selector: 'app-hero-async-message',
  template: `
    <h2>Async Hero Message and AsyncPipe</h2>
    <p>Message: {{ message$ | async }}</p>
    <button (click)="resend()">Resend</button>`,
})
export class HeroAsyncMessageComponent {
  message$: Observable<string>;

  private messages = [
    'You are my hero!',
    'You are the best hero!',
    'Will you be my hero?'
  ];

  constructor() {
    this.message$ = this.getResendObservable();
  }

  resend() {
    this.message$ = this.getResendObservable();
  }

  private getResendObservable() {
    return interval(500).pipe(
      map(i => this.messages[i]),
      take(this.messages.length)
    );
  }
}
```

### ä½¿ç”¨éçº¯ç®¡é“ç¼“å­˜Httpæ•°æ®( æ¯ä¸ªç®¡é“éƒ½å°†ä¼šæ˜¯ä¸€ä¸ªå®ä¾‹ )
```typescript
// ä½¿ç”¨éçº¯ç®¡é“å¯ä»¥ç¼“å­˜httpæ•°æ®
// æ¯å½“ç»„ä»¶è¿è¡Œå˜æ›´æ£€æµ‹æ—¶å°±ä¼šè°ƒç”¨éçº¯ç®¡é“ï¼Œè¿™å¯èƒ½æ¯éš”å‡ æ¯«ç§’å°±è¿è¡Œä¸€æ¬¡ã€‚ä¸ºé¿å…å‡ºç°æ€§èƒ½é—®é¢˜ï¼Œ
//åªæœ‰å½“è¯·æ±‚çš„ URL å‘ç”Ÿå˜åŒ–æ—¶æ‰ä¼šè°ƒç”¨è¯¥æœåŠ¡å™¨ï¼ˆå¦‚ä¸‹ä¾‹æ‰€ç¤ºï¼‰ 

import { HttpClient } from '@angular/common/http';
import { Pipe, PipeTransform } from '@angular/core';

@Pipe({
  name: 'fetch',
  pure: false
})
export class FetchJsonPipe implements PipeTransform {
  private cachedData: any = null;
  private cachedUrl = '';

  constructor(private http: HttpClient) { }

  transform(url: string): any {
    if (url !== this.cachedUrl) {
      this.cachedData = null;
      this.cachedUrl = url;
      this.http.get(url).subscribe(result => this.cachedData = result);
    }

    return this.cachedData;
  }
}

// ä½¿ç”¨

{
template: `
    <h2>Heroes from JSON File</h2>

    <div *ngFor="let hero of ('assets/heroes.json' | fetch) ">
      {{hero.name}}
    </div>

    <p>Heroes as JSON:
      {{'assets/heroes.json' | fetch | json}}
    </p>
`
}

```

## å±æ€§å‹æŒ‡ä»¤
å±æ€§å‹æŒ‡ä»¤ï¼Œå¯ä»¥ç”¨æ¥æ”¹å˜DOMå¤–è§‚å’Œè¡Œä¸º

### æœ€ç®€å•çš„ä½¿ç”¨
```typescript
// ä½¿ç”¨éå¸¸çš„å®¹æ˜“
import {Directive, ElementRef, EventEmitter, HostListener, Input, Output} from '@angular/core';

@Directive({
  selector: '[appHighlight]'
})
export class HighlightDirective {
  @Input('appHighlight') highlightColor: string;  // @HostListener èƒ½å¤Ÿæ›¿ä½ è¿›è¡Œäº‹ä»¶ç›‘å¬
  @Output() colorChange = new EventEmitter<string>();
  constructor(private el: ElementRef) {
    console.log('appHighlight');
  }
  @HostListener('mouseenter') onMouseEnter() {
    this.highlight(this.highlightColor || 'yellow');
  }

  @HostListener('mouseleave') onMouseLeave() {
    this.highlight('');
  }

  private highlight(color: string) {
    this.el.nativeElement.style.backgroundColor = color;
    this.colorChange.emit(color);
  }
}

//
<p [appHighlight]="color">Highlight me!</p>

```

### æˆ‘å¸Œæœ›å±•ç¤º <font style="color:rgb(255, 255, 255);background-color:rgb(68, 68, 68);">{{ 1 + 1 }}</font><font style="color:rgb(255, 255, 255);background-color:rgb(48, 48, 48);"> </font>æ€ä¹ˆåŠï¼Ÿ  

```typescript
<p ngNonBindable>This should not evaluate: {{ 1 + 1 }}</p>
// è¯·ä½¿ç”¨ç³»ç»Ÿå†…ç½®çš„ ngNonBindable æŒ‡ä»¤
```

## ç»“æ„å‹æŒ‡ä»¤  

ç»“æ„é¡¾åæ€ä¹‰å®ƒå¯ä»¥æ›´æ”¹domçš„ç»“æ„ï¼Œä¸“é—¨ç”¨æ¥å¹²è¿™ä»¶äº‹çš„ï¼Œæ¯”å¦‚ngIf ï¼ŒngFor ï¼ŒngSwitch éƒ½æ˜¯ç»“æ„æ€§æŒ‡ä»¤



```typescript
// åˆ›å»ºä¸€ä¸ªç»“æ„æ€§æŒ‡ä»¤ è¿™ä¸ªåŠŸèƒ½æ˜¯å¯¹NgIfçš„å–åæ“ä½œ 
import { Directive, Input, TemplateRef, ViewContainerRef } from '@angular/core';


@Directive({ selector: '[appUnless]'})
export class UnlessDirective {
  private hasView = false;

  constructor(
    private templateRef: TemplateRef<any>,  // è¿™ä¸ªå¯ä»¥å¸®ä½ è·å–ng-templayeå¼•ç”¨
    private viewContainer: ViewContainerRef) { } // è¿™ä¸ªä¹Ÿæ˜¯å¯ä»¥å¸®ä½ è·å–è§†å›¾å®¹å™¨
// å‰é¢çš„æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬æœ‰æŒ‡å‡º NgIfçš„å®Œæ•´å†™æ³•æ˜¯å°±æ˜¯å¤–é¢æœ‰ä¸€å±‚template

  @Input() set appUnless(condition: boolean) {
    if (!condition && !this.hasView) {
      this.viewContainer.createEmbeddedView(this.templateRef);
      this.hasView = true;
    } else if (condition && this.hasView) {
      this.viewContainer.clear();
      this.hasView = false;
    }
  }
}
// ä½¿ç”¨
<p *appUnless="condition">Show this sentence unless the condition is true.</p>
```



## TemplateRefå’ŒViewContainerRef  
  

å‰è€…è¡¨ç¤º ä¸€ä¸ªå†…åµŒçš„æ¨¡ç‰ˆï¼Œå®ƒçš„createEmbeddedVIewå¯ä»¥æŠŠå®ƒè‡ªå·±é™„ç€åˆ°ä¸€ä¸ªçˆ¶è¯•å›¾ä¸Š

åè€…è¡¨ç¤º  å¯ä»¥å°†ä¸€ä¸ª/å¤šä¸ª è§†å›¾é™„ç€åˆ°ç»„ä»¶ä¸­çš„å®¹å™¨ï¼Œåœ¨createComponentçš„æ—¶å€™

```typescript
import {AfterViewInit, Component, EmbeddedViewRef, OnInit, TemplateRef, ViewChild, ViewContainerRef} from '@angular/core';

@Component({
  selector: 'app-tpl-container',
  templateUrl: './tpl-container.component.html'
})
export class TplContainerComponent implements OnInit, AfterViewInit {
  // è·å–æ¨¡æ¿ä¸­çš„å…ƒç´ (ç»„ä»¶ã€ng-templateã€dom)
  @ViewChild('box') readonly boxEl: ElementRef;
  @ViewChild('firstTpl', { read: TemplateRef }) readonly firstTpl: TemplateRef<any>;
  @ViewChild('secondTpl', { read: TemplateRef }) readonly secondTpl: TemplateRef<any>;
  @ViewChild('thirdTpl', { read: TemplateRef }) readonly thirdTpl: TemplateRef<any>;
  @ViewChild('fourthTpl', { read: TemplateRef }) readonly fourTpl: TemplateRef<any>;
  @ViewChild('freeTpl', { read: TemplateRef }) readonly freeTpl: TemplateRef<any>;
  @ViewChild('firstContainer', { read: ViewContainerRef, static: true }) readonly firstContain: ViewContainerRef;
  @ViewChild('secondContainer', { read: ViewContainerRef, static: true }) readonly secondContain: ViewContainerRef;
  private freeViewRef: EmbeddedViewRef<any>;
  constructor() {
    // console.log('constructor');
  }

  insert(tpl: TemplateRef<any>) {
    this.firstContain.insert(tpl.createEmbeddedView(null));
  }

  insertAll() {
    [this.secondTpl, this.thirdTpl, this.fourTpl].forEach(tpl => {
      this.firstContain.insert(tpl.createEmbeddedView(null));
    });
  }

  getOne() {
    console.log(this.firstContain.get(2));
    console.log(this.firstContain.indexOf(this.freeViewRef));
  }

  insertFree() {
    this.firstContain.insert(this.freeViewRef, 1);
  }

  move() {
    // ä¸éœ€è¦äº‹å…ˆæ’å…¥ä¹Ÿå¯ä»¥ç§»åŠ¨(å®šå¥½ä½ç½®å†æ’å…¥)
    this.firstContain.move(this.freeViewRef, 2);
  }

  move2To4() {
    const view = this.firstContain.detach(1);
    this.firstContain.insert(view, 3);
  }

  move2ToOther() {
    const view = this.firstContain.detach(1);
    this.secondContain.insert(view);
  }

  ngOnInit(): void {
    // console.log('onInit');
  }

  ngAfterViewInit(): void {
    console.log('ngAfterViewInit');
    this.freeViewRef = this.freeTpl.createEmbeddedView({ $implicit: 'defaultValue', free: 'aa' });
    // console.log(this.firstTpl);
    // const viewRef = this.firstTpl.createEmbeddedView(null);
    // console.log('viewRef', viewRef);
    /*this.boxEl.nativeElement.appendChild(viewRef.rootNodes[0]);*/
    setTimeout(() => {
      this.firstContain.createEmbeddedView(this.firstTpl);
    }, 0);
  }

}
```

```html
<div class="box" #box>
  <button class="btn btn-primary mr-1" (click)="insert(secondTpl)">insert second</button>
  <button class="btn btn-primary mr-1" (click)="insert(thirdTpl)">insert third</button>
  <button class="btn btn-primary mr-1" (click)="insert(fourthTpl)">insert fourth</button>
  <button class="btn btn-primary mr-1" (click)="insertAll()">insert all</button>
  <button class="btn btn-secondary mr-1" (click)="insertFree()">insert free</button>
  <button class="btn btn-info mr-1" (click)="getOne()">get one</button>
  <button class="btn btn-success mr-1" (click)="move()">move free</button>
  <button class="btn btn-success mr-1" (click)="move2To4()">æŠŠç¬¬äºŒä¸ªç§»åŠ¨åˆ°ç¬¬å››ä¸ªä½ç½®ä¸Š</button>
  <button class="btn btn-success" (click)="move2ToOther()">æŠŠç¬¬äºŒä¸ªç§»åŠ¨åˆ°å…¶ä»–å®¹å™¨ä¸­</button>
  <p>é•¿åº¦ï¼š{{ firstContain?.length }}</p>
</div>
<ng-template #firstTpl>
  <p>first tpl content</p>
</ng-template>


<ng-template #secondTpl>
  <p>ç¬¬äºŒæ®µtemplate</p>
</ng-template>

<ng-template #thirdTpl>
  <p>ç¬¬ä¸‰æ®µtemplate</p>
</ng-template>

<ng-template #fourthTpl>
  <p>ç¬¬å››æ®µtemplate</p>
</ng-template>

<ng-template #freeTpl>
  <p>è‡ªç”±çš„template</p>
</ng-template>

<p>
  first container:
  <ng-container #firstContainer></ng-container>
</p>

<hr>

<p>
  second container:
  <ng-container #secondContainer></ng-container>
</p>
```

## 
## NgTemplateOutletæŒ‡ä»¤  

è¿™ä¸ªä¸œè¥¿å¯ä»¥â€œæ ¹æ®ä¸€ä¸ªæå‰å‡†å¤‡å¥½çš„templateRefæ’å…¥å†…åµŒè§†å›¾â€  


```typescript
import { Component, Input, TemplateRef } from '@angular/core';
@Component({
  selector: 'app-tpl-outlet',
  template: `<div>
               <ng-container *ngTemplateOutlet="render || defaultTpl; context: myContext"></ng-container>
               <!--      <ng-container [ngTemplateOutlet]="render || defaultTpl" [ngTemplateOutletContext]="myContext"></ng-container>-->
               
               <!--   ç”¨åœ¨ng-templateä¸Šä¹Ÿå¯ä»¥   -->
               <!--      <ng-template *ngTemplateOutlet="render || defaultTpl; context: myContext"></ng-template>-->
               <!--      <ng-template [ngTemplateOutlet]="render || defaultTpl" [ngTemplateOutletContext]="myContext"></ng-template>-->
             </div>
            <ng-template #customTpl let-def let-val="value">
              <b>customTpl rendered! def: {{ def }}; value: {{ val }}</b>
            </ng-template>`
})
export class TplOutletComponent  {
  @Input () render: TemplateRef<any>;
  myContext = {$implicit: 'World', value: 'Svet'};

}

//  åœ¨ä¸Šä¸‹æ–‡å¯¹è±¡ä¸­ä½¿ç”¨ $implicit è¿™ä¸ª key ä¼šæŠŠå¯¹åº”çš„å€¼è®¾ç½®ä¸ºé»˜è®¤å€¼ã€‚
```



è°ƒç”¨TplOutletComponentä¼ å…¥è‡ªå®šä¹‰çš„dom



```typescript
import { Component, Input } from '@angular/core';
@Component({
  selector: 'app-root',
  template: `<app-tpl-outlet [render]="render"></app-tpl-outlet>
             <ng-template #render let-value="value">
               <p><b>è‡ªå®šä¹‰çš„dom -- {{ value }}</b></p>
             </ng-template>
          `
})
export class ItemDetailComponent  {

}
```

## ç»„ä»¶æŠ•å½±  

è¿™ä¸ªä¸œè¥¿å°±åƒVueä¸­çš„æ’æ§½ æˆ–åˆ™Reactä¸­çš„Chilendä¸€æ ·, å®ƒæœ‰ä¸‹é¢å‡ ç§å˜ä½“ 

```typescript

// æœ€åŸºç¡€ä½¿ç”¨  å•æŠ•å½±
@Component({
  selector: 'app-zippy-basic',
  template: `
    <h2>Single-slot content projection</h2>
    <ng-content></ng-content>
  `
})
export class ZippyBasicComponent {}

<app-zippy-basic>
  <p>Is content projection cool?</p>  // è¿™ä¸ªå°†ä¼šæ˜¾ç¤ºåœ¨ng-content ä¸­
</app-zippy-basic>

// å¤šæ’æ§½ æŠ•å½±
@Component({
selector: 'app-zippy-multislot',
template: `
  <h2>Multi-slot content projection</h2>

  Default:
  <ng-content></ng-content>

  Question:
  <ng-content select="[question]"></ng-content>
`
})
export class ZippyMultislotComponent {}

// ä½¿ç”¨ question å±æ€§çš„å†…å®¹å°†æŠ•å½±åˆ°å¸¦æœ‰ select=[question] å±æ€§çš„ <ng-content> å…ƒç´ ã€‚
<app-zippy-multislot>
  <p question>
    Is content projection cool?
  </p>
  <p>Let's learn about content projection!</p>
</app-zippy-multislot>

// å¸¦æ¡ä»¶çš„ è¿™ä¸ªæ¯”è¾ƒçš„å¤æ‚
1.åœ¨continerä¸­æ¥å—ng-template
2.ç»™containeråŒ…è£¹ä¸€å±‚åˆ¤æ–­ï¼ˆæ—¢ä½ è‡ªå·±çš„åˆ¤æ–­é€»è¾‘ï¼‰
3.ç”¨templateæŠŠå†…å®¹æ‹¿å¥½
4.å¦‚ä½•å…³è”è¿›æ¥ï¼Ÿä½¿ç”¨è‡ªå®šä¹‰æŒ‡ä»¤ 
5.ä½¿ç”¨@contentChildè·å–æ­¤æŠ•å½±çš„æ¨¡æ¿


@Component({
  selector: 'app-example-zippy',
  template: `
  <ng-content></ng-content>
  <div *ngIf="expanded" [id]="contentId">
      <ng-container [ngTemplateOutlet]="content.templateRef"></ng-container>
  </div>
  `,
})
export class ZippyComponent {
  contentId = `zippy-${nextId++}`;
  @Input() expanded = false;
  @ContentChild(ZippyContentDirective) content!: ZippyContentDirective;
}


@Directive({
  selector: '[appExampleZippyContent]',
})
export class ZippyContentDirective {
  constructor(public templateRef: TemplateRef<unknown>) {}
}

let nextId = 0;

@Directive({
  selector: 'button[appExampleZippyToggle]',
})
export class ZippyToggleDirective {
  @HostBinding('attr.aria-expanded') ariaExpanded = this.zippy.expanded;
  @HostBinding('attr.aria-controls') ariaControls = this.zippy.contentId;
  @HostListener('click') toggleZippy() {
    this.zippy.expanded = !this.zippy.expanded;
  }
  constructor(public zippy: ZippyComponent) {}
}


//åœ¨htmlä¸Šçš„å‘ˆç°

<app-example-zippy>
  <button appExampleZippyToggle>Is content project cool?</button>
  <ng-template appExampleZippyContent>
    It depends on what you do with it.
  </ng-template>
</app-example-zippy>



```

## ViewChildå’ŒViewChildren  



## ContentChildå’ŒContentChildren




# ç”Ÿå‘½å‘¨æœŸ




# å˜æ›´æ£€æµ‹


# ç»„ä»¶æ ·å¼


# é«˜çº§å†…å®¹


## åŠ¨æ€ç»„ä»¶


## åˆ†é…æ¨¡å—
