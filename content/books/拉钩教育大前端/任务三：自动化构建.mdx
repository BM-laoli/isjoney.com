---
title: "ä»»åŠ¡ä¸‰ï¼šè‡ªåŠ¨åŒ–æ„å»º"
date: "2024-12-19"
summary: "æ·±å…¥è®²è§£å‰ç«¯è‡ªåŠ¨åŒ–æ„å»ºå·¥å…·çš„ä½¿ç”¨ï¼ŒåŒ…æ‹¬Gruntå’ŒGulpçš„åŸºç¡€ç”¨æ³•ã€ä»»åŠ¡é…ç½®ã€æ’ä»¶ä½¿ç”¨ã€å·¥ä½œæµå°è£…ä»¥åŠCLIè„šæ‰‹æ¶å¼€å‘ç­‰æ ¸å¿ƒå†…å®¹ã€‚"
status: "completed"
tech: ["Grunt","Gulp","è‡ªåŠ¨åŒ–æ„å»º","å‰ç«¯å·¥ç¨‹åŒ–"]
github: "https://github.com/BM-laoli"
arxiv: ""
keyId: "æ‹‰é’©æ•™è‚²å¤§å‰ç«¯"
---

## ä¸€ã€æ¦‚è¿°å’Œå¸¸ç”¨å·¥å…·ä»‹ç» grunt Â gulp 
### 1. å‰ç½®çŸ¥è¯†
æ‰€è°“è‡ªåŠ¨åŒ–ï¼Œå°±æ˜¯æŠŠä¸€äº›é‡å¤æ€§é«˜çš„ä¸œè¥¿ï¼Œç»™æœºå™¨å»åšï¼Œè€Œä¸æ˜¯æˆ‘ä»¬çš„äººå»æ¬ç –ï¼ï¼Œè‡ªåŠ¨åŒ–å°±æ˜¯å¦‚æ­¤ï¼Œåœ¨ä¼ ç»Ÿçš„é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æ‰“åŒ… ç„¶åå¤åˆ¶åˆ°æœåŠ¡å™¨ï¼Œç„¶åæœåŠ¡å™¨å†å¯åŠ¨ï¼Œè¿™å®é™…ä¸Šéå¸¸çš„lowï¼Œlowçˆ†äº†ã€‚

æˆ‘ä»¬ä¸ºäº†å®ç°è‡ªåŠ¨åŒ–çš„æ„å»ºï¼Œæˆ‘ä»¬éœ€è¦å…ˆäº†è§£ä¸€äº›è¾…åŠ©å·¥å…·ï¼ˆè½®å­ï¼‰

- [x] scssæ˜¯cssé¢„ç¼–è¯‘æœŸçš„æ–‡ä»¶ç»“å°¾å†™æ³•
- [x] sassæ˜¯npmçš„ä¸€ä¸ªåŒ…ç”¨æ¥ç¼–è¯‘scssæˆcss
- [x] NPM Script å°±æ˜¯ä½ çš„yarn start  / npm run xxx çš„è¿™ä¸ªxxx ï¼Œå®ƒæ˜¯ä½ è‡ªå·±å†™åœ¨pack.jsonä¸­çš„ï¼Œ
- [x] browser-sync èƒ½å¤Ÿè‡ªåŠ¨å¯åŠ¨ä¸€ä¸ªæœåŠ¡å™¨ï¼ŒæŠŠä½ çš„ä»£ç è¿è¡Œèµ·æ¥
- [x] preserve.  æˆ–è€… pre -xxxx.è¿™ä¸ªå°±æ˜¯NPM Scriptçš„é’©å­æœºåˆ¶ï¼Œæ­£åœ¨ä½ è·‘xxxçš„æ—¶å€™å…ˆæ‰§è¡Œ pre-xxx å†æ‰§è¡Œä½ çš„xxx
- [x] npm-run-all æ˜¯ä¸€ä¸ªè®©å¤šä¸ªscirpåŒæ—¶æ‰§è¡Œçš„åŒ… 

### 2. æä¸€ä¸ªå°demo
> ç°åœ¨æˆ‘ä»¬æ¥æ˜ç¡®ä¸€ä¸‹ç›®æ ‡ï¼šæˆ‘ä»¬éœ€è¦ç”¨sass å’Œ NPM script å’Œbrowser-sync æ¥è¿›è¡Œä¸€ä¸ªï¼Œè‡ªåŠ¨åŒ– ç¼–è¯‘sass å’Œè‡ªåŠ¨æ›´æ–°æµè§ˆå™¨çš„çƒ­ç¼–è¯‘çš„ä¸€ä¸ªå°demo
>

é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦èµ·ä¸€ä¸ªé¡¹ç›®ï¼Œè¿™é‡Œyarn init  æˆ‘å°±ä¸åšè¿‡å¤šçš„è¯´æ˜äº†, æ„å»ºå¥½é¡¹ç›®å¦‚ä¸‹å›¾

![](https://cdn.nlark.com/yuque/0/2021/png/1627571/1621476550544-b55121b0-d1d7-451b-af92-e776e1be6720.png)

ç„¶åï¼Œæˆ‘ä»¬éœ€è¦å®‰è£…ä¸€äº›åŒ…

```shell
yarn add sass browser-sync npm-run-all
```

å†åé¢å‘¢ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•ä½¿ç”¨ sass

```shell
# ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬åªéœ€è¦æŒ‡å®šä¸€äº›å‘½ä»¤å°±å¥½äº† æ¯”å¦‚,æˆ‘ç°åœ¨é€šè¿‡å‘½ä»¤è¡Œæ‰‹è¾“çš„æ–¹å¼ å»ç¼–è¯‘ main.scssåˆ°cssæ–‡ä»¶å¤¹ä¸­

./node_modules/.bin/ sass scss/main.scss css/style.css
```

ä½†è¿™ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼Œäºæ˜¯æˆ‘ä»¬æ¥é…ç½® ä¸€äº›NPM Scriptï¼Œæ¥å®ç°è‡ªåŠ¨åŒ–,pack.json

```javascript
  "scripts": {
    # è¿™æ˜¯æ‹¿æ¥æ‰§è¡Œ ç¼–è¯‘ scssçš„ åŠ watchå°±æ˜¯æ—¶åˆ»ç›‘è§†
    "build": "sass scss/main.scss css/style.css --watch",  
    # è¿™ä¸ªæ˜¯æ‹¿æ¥ ç›‘å¬å¦‚æœæœ‰ä»€ä¹ˆæ–‡ä»¶å˜åŒ– å°±æ›´æ–°çš„--files \"css/*.css\""
    "serve": "browser-sync . --files \"css/*.css\"",
    # è¿™ä¸ªæ˜¯æ‹¿æ¥ è§£å†³ åŒæ­¥çš„è¿è¡Œ build server
    "start": "run-p build serve"
  },
```

 è¿™æ ·æˆ‘ä»¬çš„ä¸€ä¸ªç®€å•è‡ªåŠ¨åŒ–å·¥ä½œæµå°±å®Œå·¥äº†ï¼éå¸¸çš„ç®€å•å“ˆ

### 3. çœ‹çœ‹æˆ‘ä»¬æœ‰å“ªäº›å·¥å…·å¯ä»¥ç”¨
å¯¹äºä¸€ä¸ªå¤æ‚çš„é¡¹ç›®å…‰æ˜¯å•å­˜çš„åƒä¸Šé¢è¿™æ ·ææ˜¯è¿œè¿œä¸å¤Ÿçš„ï¼Œä¸è¶³çš„ï¼Œæˆ‘ä»¬éœ€è¦å¤„ç†ä¸€äº›å¤æ‚é€»è¾‘çš„æ—¶å€™å°±å‡‰å‡‰äº†ï¼æ‰€ä»¥ä½ éœ€è¦ä¸€äº›å…¶ä»–å·¥å…·

![](https://cdn.nlark.com/yuque/0/2021/png/1627571/1621519456926-d5c098bc-9b5d-4d03-9db7-079293ce3421.png)

è¿™ä¸‰ä¸ªå„æœ‰å„ä¸ªçš„åˆ©å¼Šï¼ŒGruntå‘¢ï¼Œå®é™…ä¸Šæ˜¯é€šè¿‡ç£ç›˜è¿›è¡Œä¸€æ¡æ¡æ„å»ºä»»åŠ¡çš„ï¼Œæ˜¯æœ€æ—©çš„è‡ªåŠ¨åŒ–æ„å»ºå·¥å…·ã€‚gulpæ˜¯åŸºäºå†…å­˜çš„ï¼Œä¹Ÿæ˜¯ä»»åŠ¡æ‰§è¡Œæ¯”è¾ƒçš„æµè¡Œï¼ŒFISçš„ç™¾åº¦çš„ï¼Œç°åœ¨åŸºæœ¬ä¸Šå‡‰å‡‰äº†ï¼Œä¹Ÿæ²¡æœ‰äººå»ç»´æŠ¤ä»–

æ–°æ‰‹éœ€è¦è§„åˆ™ï¼Œè€æ‰‹æ¸´æœ›è‡ªç”±

## äºŒã€Grunt
### 1. åŸºç¡€çš„ç”¨æ³•
> æœ¬èŠ‚ä¼šè¯¦ç»†çš„è®²è§£ Gruntçš„ä»»åŠ¡å¦‚ä½•å®šä¹‰ï¼Œå¼‚æ­¥ä»»åŠ¡å¦‚ä½•æ‰§è¡Œï¼Œå¦‚æœå“¦ä»»åŠ¡æ‰§è¡Œé”™è¯¯ä¼šæ€ä¹ˆå¤„ç†
>

é¦–å…ˆæˆ‘ä»¬éœ€è¦åˆå§‹åŒ–ä¸€ä¸ªé¡¹ç›®ï¼ˆåŒæ ·çš„è¿™é‡Œä¸å¤šBBï¼‰

æˆ‘ä»¬éœ€è¦ç”¨åˆ°çš„åŒ…

```shell
yarn init --yes
yarn add grunt
```

	åˆ›å»ºä¸€ä¸ªå…¥å£æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶ å°±æ˜¯gruntçš„å…¥å£ï¼Œä½ å¯ä»¥åœ¨è¿™é‡Œé¢åšä½ æƒ³åšçš„ä»»æ„çš„äº‹æƒ…

gulpfile.js

```javascript
// Grunt çš„å…¥å£æ–‡ä»¶
// ç”¨äºå®šä¹‰ä¸€äº›éœ€è¦ Grunt è‡ªåŠ¨æ‰§è¡Œçš„ä»»åŠ¡
// éœ€è¦å¯¼å‡ºä¸€ä¸ªå‡½æ•°
// æ­¤å‡½æ•°æ¥æ”¶ä¸€ä¸ª grunt çš„å¯¹è±¡ç±»å‹çš„å½¢å‚
// grunt å¯¹è±¡ä¸­æä¾›ä¸€äº›åˆ›å»ºä»»åŠ¡æ—¶ä¼šç”¨åˆ°çš„ API

module.exports = grunt => {
  grunt.registerTask('foo', 'a sample task', () => {
    console.log('hello grunt')
  })

  grunt.registerTask('bar', () => {
    console.log('other task')
  })

  // // default æ˜¯é»˜è®¤ä»»åŠ¡åç§°
  // // é€šè¿‡ grunt æ‰§è¡Œæ—¶å¯ä»¥çœç•¥
  // grunt.registerTask('default', () => {
  //   console.log('default task')
  // })

  // ç¬¬äºŒä¸ªå‚æ•°å¯ä»¥æŒ‡å®šæ­¤ä»»åŠ¡çš„æ˜ å°„ä»»åŠ¡ï¼Œ
  // è¿™æ ·æ‰§è¡Œ default å°±ç›¸å½“äºæ‰§è¡Œå¯¹åº”çš„ä»»åŠ¡
  // è¿™é‡Œæ˜ å°„çš„ä»»åŠ¡ä¼šæŒ‰é¡ºåºä¾æ¬¡æ‰§è¡Œï¼Œä¸ä¼šåŒæ­¥æ‰§è¡Œ
  grunt.registerTask('default', ['foo', 'bar'])

  // ä¹Ÿå¯ä»¥åœ¨ä»»åŠ¡å‡½æ•°ä¸­æ‰§è¡Œå…¶ä»–ä»»åŠ¡
  grunt.registerTask('run-other', () => {
    // foo å’Œ bar ä¼šåœ¨å½“å‰ä»»åŠ¡æ‰§è¡Œå®Œæˆè¿‡åè‡ªåŠ¨ä¾æ¬¡æ‰§è¡Œ
    grunt.task.run('foo', 'bar')
    console.log('current task runing~')
  })

  // é»˜è®¤ grunt é‡‡ç”¨åŒæ­¥æ¨¡å¼ç¼–ç 
  // å¦‚æœéœ€è¦å¼‚æ­¥å¯ä»¥ä½¿ç”¨ this.async() æ–¹æ³•åˆ›å»ºå›è°ƒå‡½æ•°
  // grunt.registerTask('async-task', () => {
  //   setTimeout(() => {
  //     console.log('async task working~')
  //   }, 1000)
  // })

  // ç”±äºå‡½æ•°ä½“ä¸­éœ€è¦ä½¿ç”¨ thisï¼Œæ‰€ä»¥è¿™é‡Œä¸èƒ½ä½¿ç”¨ç®­å¤´å‡½æ•°
  grunt.registerTask('async-task', function () {
    const done = this.async()
    setTimeout(() => {
      console.log('async task working~')
      done()
    }, 1000)
  })
}

// // å¯¼å‡ºçš„å‡½æ•°éƒ½ä¼šä½œä¸º gulp ä»»åŠ¡
// exports.foo = () => {
//   console.log('foo task working~')
// }

// gulp çš„ä»»åŠ¡å‡½æ•°éƒ½æ˜¯å¼‚æ­¥çš„
// å¯ä»¥é€šè¿‡è°ƒç”¨å›è°ƒå‡½æ•°æ ‡è¯†ä»»åŠ¡å®Œæˆ
exports.foo = done => {
  console.log('foo task working~')
  done() // æ ‡è¯†ä»»åŠ¡æ‰§è¡Œå®Œæˆ
}

// default æ˜¯é»˜è®¤ä»»åŠ¡
// åœ¨è¿è¡Œæ˜¯å¯ä»¥çœç•¥ä»»åŠ¡åå‚æ•°
exports.default = done => {
  console.log('default task working~')
  done()
}

// v4.0 ä¹‹å‰éœ€è¦é€šè¿‡ gulp.task() æ–¹æ³•æ³¨å†Œä»»åŠ¡
const gulp = require('gulp')
gulp.task('bar', done => {  // è¿™ä¸ªé˜¿
  console.log('bar task working~')
  done()
})



```

æ¥ä¸‹æ¥ï¼Œå°±å»ç›®å½•ä¸­æ‰§è¡Œ ä¹‹åå‘½ä»¤è¡Œå°±å¥½äº†

```shell
yarn grunt xxx (xxxæ˜¯ä½ å®šä¹‰çš„ä»»åŠ¡çš„åç§°)
```



å¦‚æœæˆ‘ä»¬éœ€è¦æ ‡è®°ä¸€ä¸ªä»»åŠ¡æ˜¯å¤±è´¥çš„ã€‚ä½ éœ€è¦è¿™æ ·åš

```javascript
# ä¸€èˆ¬æ¥è¯´ åœ¨ä»»åŠ¡ä¸­è¿”å›ä¸€ä¸ªfalseå°±å¥½äº†ã€‚å¦‚æœæ˜¯å¼‚æ­¥çš„ ä½ å°±å¾€ ä½ çš„doneé‡Œé¢ä¸¢ä¸€ä¸ªfalseå°±å¥½äº†
```



### 2.é…ç½®æ–¹æ³•
> å‰é¢çš„ä¸œè¥¿å‘¢ï¼Œæˆ‘ä»¬éƒ½æ˜¯åœ¨è‡ªå·±æ‰‹åŠ¨çš„ä¸€ä¸ªä¸€ä¸ªé…ï¼Œæœ‰æ²¡æœ‰ä»€ä¹ˆçƒ¦å•Šèƒ½æŠŠè¿™äº›é›¶æ•£çš„ä»»åŠ¡å½’çº³æ•´ç†ä¸€ä¸‹å‘¢ï¼Ÿç­”æ¡ˆæ˜¯æœ‰çš„é‚£å°±æ˜¯é…ç½®æ–‡ä»¶
>

gulpfile.js

```javascript
module.exports = grunt => {
  // grunt.initConfig() ç”¨äºä¸ºä»»åŠ¡æ·»åŠ ä¸€äº›é…ç½®é€‰é¡¹
  grunt.initConfig({
    // é”®ä¸€èˆ¬å¯¹åº”ä»»åŠ¡çš„åç§°
    // å€¼å¯ä»¥æ˜¯ä»»æ„ç±»å‹çš„æ•°æ®
    foo: {
      bar: 'baz'
    }
  })

  grunt.registerTask('foo', () => {
    // ä»»åŠ¡ä¸­å¯ä»¥ä½¿ç”¨ grunt.config() è·å–é…ç½®
    console.log(grunt.config('foo'))
    // å¦‚æœå±æ€§å€¼æ˜¯å¯¹è±¡çš„è¯ï¼Œconfig ä¸­å¯ä»¥ä½¿ç”¨ç‚¹çš„æ–¹å¼å®šä½å¯¹è±¡ä¸­å±æ€§çš„å€¼
    console.log(grunt.config('foo.bar'))  // è¿™ä¸ªå°±èƒ½ç›´æ¥æ‹¿åˆ° bazäº†ï¼
  })
}
```

### 3.å¤šç›®æ ‡ä»»åŠ¡
> ä»€ä¹ˆæ˜¯å¤šç›®æ ‡ä»»åŠ¡ï¼Œä½ å¯ä»¥ç†è§£æˆå¤šä»»åŠ¡å§ï¼Œå°±æ˜¯ä¸€ä¸ªä»»åŠ¡å»æ˜ å°„å¤šä¸ªæ–‡ä»¶ä»€ä¹ˆçš„ï¼Œå…·ä½“çš„ç”¨æ³•å°±æ˜¯ä½¿ç”¨initConfigæ¥å¹²è¿™ä»¶äº‹ï¼Œå­ä»»åŠ¡å¿…é¡»è¦åšåœ¨å…·æœ‰initConfigçš„é…ç½®ä¸‹
>

gulpfile.js



```javascript
module.exports = grunt => {
  // å¤šç›®æ ‡æ¨¡å¼ï¼Œå¯ä»¥è®©ä»»åŠ¡æ ¹æ®é…ç½®å½¢æˆå¤šä¸ªå­ä»»åŠ¡
  // grunt.initConfig({
  //   build: {
  //     foo: 100,
  //     bar: '456'
  //   }
  // })

  // grunt.registerMultiTask('build', function () {  
  // è¿™æ ·å°±èƒ½æ‹¿åˆ°è¿™ä¸ªä½ initCOnfigä¸­æ‹¿åˆ°çš„æ•°æ® this.target å°±æ˜¯ build å­—ç¬¦ä¸²  this.dataå°±æ˜¯ { fooï¼š100.bar:456 }
  //   console.log(`task: build, target: ${this.target}, data: ${this.data}`)
  // })

  grunt.initConfig({
    build: {  
      options: {
        msg: 'task options'
      },// è¿™ä¸ªoptionæ˜¯ä½œä¸ºä»»åŠ¡çš„é…ç½®é€‰é¡¹ï¼Œé™¤äº†å®ƒä¹‹å¤–ï¼Œæ‰€æœ‰çš„å…¶å®ƒå»ºå€¼éƒ½å°†ä¼šä½œä¸ºbuildçš„å­ä»»åŠ¡å»æ‰§è¡Œ 
      foo: {
        options: {
          msg: 'foo target options'
        } // è‡ªå·±çš„optionså¯ä»¥è¦†ç›–å¤–é¢çš„option
      },
      bar: '456'
    }
  })

  grunt.registerMultiTask('build', function () {
    console.log(this.options())  // è¿™æ ·è¿™ä¸ªthis.options()  è¿”å›çš„å°±æ˜¯è¿™ä¸ªoptionså¯¹è±¡
  })
}

```

```shell
# è¿è¡Œä»»åŠ¡
yarn grunt build

# è¿è¡Œå­ä»»åŠ¡
yarn grunt build:foo


```

### 4.æ’ä»¶ç›¸å…³çš„ä½¿ç”¨
> æœ‰äº†ä¸Šé¢çš„è¿™ä¸ªäº›çŸ¥è¯†ä¹‹åï¼Œæˆ‘ä»¬å‘ç°å®é™…ä¸Šgruntçš„æ ¸å¿ƒå°±æ˜¯ä»»åŠ¡ï¼Œç”±äºä»»åŠ¡åœ¨å‰ç«¯è‡ªåŠ¨åŒ–æ„å»ºä¸­éƒ½æ˜¯å·®ä¸éƒ½çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨gruntä¸­çš„æ’ä»¶æ¥åšä¸€äº›ç›¸åŒæˆ–è€…å·®ä¸å¤šçš„ä»»åŠ¡æ¥æå‡å¼€å‘çš„æ•ˆç‡
>

é¦–å…ˆå»ä¸‹è½½æ’ä»¶ï¼Œæˆ‘ä»¬è¿™é‡Œå°±æ‹¿æˆ‘ä»¬çš„è¿™ä¸ªä¸€ä¸ªå«åš  'grunt-contrib-clean' çš„æ’ä»¶ï¼Œå®ƒçš„ä½œç”¨å°±å»åˆ é™¤æŒ‡å®šçš„æ–‡ä»¶æˆ–è€…æ–‡ä»¶å¤¹ï¼Œ

```shell
yarn add grunt-contrib-clean
```

ç„¶åå»æ ¹æ®æ’ä»¶çš„æ–‡æ¡£æ¥é…ç½®æ’ä»¶

```javascript
module.exports = grunt => {
  grunt.initConfig({
    clean: {
      temp: 'temp/**'  // è¿™å¥è¯çš„æ„æ€å°±æ˜¯åˆ é™¤å½“å‰ç›®å½•ä¸‹çš„tempä¸‹çš„æ‰€æœ‰æ–‡ä»¶
    }
  })
  
  grunt.loadNpmTasks('grunt-contrib-clean')
}
```



æœ€åæˆ‘ä»¬å»éªŒè¯ä¸€ä¸‹ è¿™ä¸ªä»»åŠ¡æ˜¯å¦å¯è¡Œ

```shell
yarn grunt  clean
# è¿™æ ·å°±è¡Œäº†
```

## 
#### 1ã€ æˆ‘ä»¬æ¥çœ‹çœ‹æœ€å¸¸è§çš„grunt æ’ä»¶
æˆ‘ä»¬è¿™é‡Œä¸»è¦ä»‹ç»äº†å¦‚ä¸‹çš„æ’ä»¶ï¼šgrunt-babeï¼Œgrunt-babelï¼Œgrunt-contrib-watcï¼Œgrunt-sassï¼Œload-grunt-tasks

é¦–å…ˆæˆ‘ä»¬æ¥æ„å»ºæˆ‘ä»¬çš„é¡¹ç›®æ–‡ä»¶å¤¹çš„ç»“æ„ï¼Œä¸€å¼€å§‹çš„æ˜¯å®é™…ä¸Šæˆ‘ä»¬åªæœ‰ srcæ–‡ä»¶å¤¹ï¼Œditæ–‡ä»¶å¤¹æ˜¯ä¸€ä¸ªç©ºçš„

![](https://cdn.nlark.com/yuque/0/2021/png/1627571/1621524944912-00be827c-d8fe-47dd-8f85-5351defc949d.png)

åœ¨æ–‡ä»¶å¤¹ä¸­distå°±æ˜¯æˆ‘ä»¬éœ€è¦æ„å»ºè¾“å‡ºçš„æ–‡ä»¶å¤¹ã€‚è€Œsrcå°±æ˜¯æˆ‘ä»¬çš„æºä»£ç æ–‡ä»¶å¤¹

ç„¶åå‘¢ï¼Œæˆ‘ä»¬å…ˆé¢„ç½®ä¸€äº›æ–‡ä»¶è¿›å»ï¼Œåšä¸€ä¸ªå°çš„demoæ¥çœ‹çœ‹è¿™ä¸œè¥¿åˆ°åº•å¦‚ä½•å®Œ

main.scss	





```css
$jumbotron-bg: #fff;
$jumbotron-padding: 3rem;

body {
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  text-rendering: optimizeLegibility;
}

.jumbotron {
  margin-bottom: 0;
  padding-top: $jumbotron-padding;
  padding-bottom: $jumbotron-padding;
  background-color: $jumbotron-bg;

  @media (min-width: 768px) {
    padding-top: 6rem;
    padding-bottom: 6rem;
  }

  .jumbotron-heading {
    font-weight: 300;
  }

  .container {
    max-width: 40rem;
  }

  p:last-child {
    margin-bottom: 0;
  }
}

.site-footer {
  padding-top: 3rem;
  padding-bottom: 3rem;
  font-family: monospace;

  a {
    text-decoration: none;
  }

  @keyframes beat {
    from,
    to {
      transform: none;
    }

    50% {
      transform: scale3d(1.4, 1.4, 1.4);
    }
  }

  .heart {
    display: inline-block;
    color: #f20;
    font-weight: normal;
    font-style: normal;
    animation: beat 0.4s ease-in-out infinite;
  }
}

```

app.js

```javascript

$(($) => {
  const $body = $('html, body')

  $('#scroll_top').on('click', () => {
    $body.animate({ scrollTop: 0 }, 600)
    return false
  })
})

```



å‡†å¤‡å¥½è¿™äº›ææ–™ä¹‹åï¼Œæˆ‘ä»¬éœ€è¦æŠŠä»–ä»¬çƒ¹é¥ªåœ¨ä¸€èµ·  

gruntfile.js

```javascript
const sass = require('sass')  
const loadGruntTasks = require('load-grunt-tasks')
// ä¸Šé¢ä¸¤ä¸ªæ˜¯éœ€è¦æˆ‘ä»¬å»ä½¿ç”¨çš„ 

module.exports = grunt => {
  grunt.initConfig({
    sass: {
      options: {
        sourceMap: true,
        implementation: sass
      },
      main: {
        files: {
          'dist/css/main.css': 'src/scss/main.scss'  // æŒ‡å®šè¾“å‡ºå’Œè¾“å…¥è·¯å¾„
        }
      }
    },
    babel: {
      options: {
        sourceMap: true,
        presets: ['@babel/preset-env']  
      },
      main: {
        files: {
          'dist/js/app.js': 'src/js/app.js'
        }
      }
    },
    watch: {  // watch å°±æ˜¯
      js: {
        files: ['src/js/*.js'],
        tasks: ['babel']
      },
      css: {
        files: ['src/scss/*.scss'],
        tasks: ['sass']
      }
    }
  })

  // grunt.loadNpmTasks('grunt-sass')
  loadGruntTasks(grunt) // è‡ªåŠ¨åŠ è½½æ‰€æœ‰çš„ grunt æ’ä»¶ä¸­çš„ä»»åŠ¡

 // åšä¸€ä¸ªæ•´ä½“çš„æ˜ å°„
  grunt.registerTask('default', ['sass', 'babel', 'watch'])  // æ³¨æ„ä¸ªé¡ºåºæ˜¯æœ‰è®²ç©¶çš„ã€‚
```

ç„¶åæˆ‘ä»¬å»è¿è¡Œå®ƒå°±å¥½äº†

```shell
# é¦–å…ˆæ˜¯å®æ—¶ç›‘æ§æ–‡ä»¶å˜åŒ–çš„
yarn grunt watch 

# å¼€å§‹defaultä»»åŠ¡
yarn gruntå°±å¥½äº†
```

## ä¸‰ã€Gulp
> Gruntå®é™…ä¸ŠåŸºæœ¬ä¹Ÿå‡‰å‡‰äº†ï¼Œè¿™é‡Œå°±ä¸è®²äº†å“ˆï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹æœ€æµè¡Œçš„ æ„å»ºå·¥å…·gulp
>



### 1.åŸºç¡€çš„ä½¿ç”¨
> å®é™…ä¸Šï¼Œgulpçš„ä½¿ç”¨å’Œgrunt ä¹Ÿå·®ä¸å¤š
>

é¦–å…ˆï¼Œæˆ‘ä»¬åˆå§‹åŒ–ä¸€ä¸ªé¡¹ç›®ï¼ŒæŒ‰ç…§å¥½æ‰€éœ€è¦ä¾èµ–

```shell
yarn add gulp
```

ç„¶åï¼Œæˆ‘ä»¬å»å†™ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œgulpfile.js,åœ¨é‡Œé¢å»å†™æˆ‘ä»¬éœ€è¦çš„ä¸œè¥¿

```javascript
// // å¯¼å‡ºçš„å‡½æ•°éƒ½ä¼šä½œä¸º gulp ä»»åŠ¡
// exports.foo = () => {
//   console.log('foo task working~')
// }

// gulp çš„ä»»åŠ¡å‡½æ•°éƒ½æ˜¯å¼‚æ­¥çš„
// å¯ä»¥é€šè¿‡è°ƒç”¨å›è°ƒå‡½æ•°æ ‡è¯†ä»»åŠ¡å®Œæˆ
//  è¿™è¦æ³¨æ„ä¸€ç‚¹ğŸ“¢ï¼Œå°±æ˜¯åœ¨gulpä¸­æ‰€æœ‰çš„ä»»åŠ¡éƒ½æ˜¯å¼‚æ­¥çš„ï¼Œä½ éœ€è¦ä¸€ä¸ªdone 
exports.foo = done => {
  console.log('foo task working~')
  done() // æ ‡è¯†ä»»åŠ¡æ‰§è¡Œå®Œæˆ
}

// default æ˜¯é»˜è®¤ä»»åŠ¡
// åœ¨è¿è¡Œæ˜¯å¯ä»¥çœç•¥ä»»åŠ¡åå‚æ•°
exports.default = done => {
  console.log('default task working~')
  done()
}

// v4.0 ä¹‹å‰éœ€è¦é€šè¿‡ gulp.task() æ–¹æ³•æ³¨å†Œä»»åŠ¡ï¼Œç°åœ¨æˆ‘ä»¬ç›´æ¥å¯¼å‡ºä»»åŠ¡å‡½æ•°å°±å¥½äº†
const gulp = require('gulp')

gulp.task('bar', done => {
  console.log('bar task working~')
  done()
})

```

æœ€åï¼Œæˆ‘ä»¬å»å‘½ä»¤è¡Œè¿è¡Œä¸€ä¸ªï¼Œçœ‹çœ‹è¿™ä¸ªgulpè‡ªåŠ¨åŒ–æ„å»ºï¼Œä»»åŠ¡èƒ½ä¸èƒ½æ­£å¸¸çš„å·¥ä½œ

```shell
#  è¿™ä¸ªxxxå°±æ˜¯ gulpä¸­çš„ ä»»åŠ¡åç§°
yarn gulp xxx

# è¿™ä¸ªæ˜¯é»˜è®¤ä»»åŠ¡
yarn gulp 
```

### 2.ç»„åˆä»»åŠ¡
> ç»„åˆä»»åŠ¡å’Œä¹‹å‰åœ¨gruntä¸­æåŠçš„ä»»åŠ¡ä¹Ÿéå¸¸çš„ç±»ä¼¼
>

è¿™é‡Œå‘¢ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨gulpfile.js å†™ä¸€ä¸‹å°±å¥½äº†



```javascript
const { series, parallel } = require('gulp')

const task1 = done => {
  setTimeout(() => {
    console.log('task1 working~')
    done()
  }, 1000)
}

const task2 = done => {
  setTimeout(() => {
    console.log('task2 working~')
    done()
  }, 1000)  
}

const task3 = done => {
  setTimeout(() => {
    console.log('task3 working~')
    done()
  }, 1000)  
}

// è®©å¤šä¸ªä»»åŠ¡æŒ‰ç…§é¡ºåºä¾æ¬¡æ‰§è¡Œ   è¿™é‡Œå°±æ˜¯æ‰§è¡Œå¤šä»»åŠ¡çš„å…³é”®ï¼Œè¿™ä¸ªä½ å¯ä»¥ç†è§£æˆï¼šâ€œä¸²è¡Œâ€
exports.foo = series(task1, task2, task3)

// è®©å¤šä¸ªä»»åŠ¡åŒæ—¶æ‰§è¡Œ, è¿™ä¸ªä½ å¯ä»¥ç†è§£è¯¶â€œå¹¶è¡Œâ€
exports.bar = parallel(task1, task2, task3)

```

æ‰§è¡Œå°±æ˜¯

```shell
yarn gulp foo
yarn gulp bar
```



### 3.å¼‚æ­¥ä»»åŠ¡
> è¿™å„¿ï¼Œæˆ‘ä»¬æ¥è¿›ä¸€æ­¥æ·±å…¥çš„ç†è§£ä¸€ä¸‹ ï¼Œgulpä¸­çš„å¼‚æ­¥ä»»åŠ¡çš„ç©æ³•
>

ä¸ä¸Šé¢åŒç†ğŸ‘†ğŸ» æˆ‘ä»¬åªéœ€è¦ç¼–è¾‘ fileæ–‡ä»¶å°±å¥½äº†

```javascript
const fs = require('fs')


// å°±æ˜¯ä¸¤ä¸ªåŸºç¡€çš„æ­£å¸¸çš„ ä»»åŠ¡ï¼Œä½¿ç”¨å›è°ƒçš„æ–¹å¼æ¥å¤„ç†
exports.callback = done => {
  console.log('callback task')
  done()
}

exports.callback_error = done => {
  console.log('callback task')
  done(new Error('task failed'))
}




// ä¸‹é¢ä¸¤ä¸ªå°±æ˜¯ä¸¤ä¸ªå¼‚æ­¥çš„ä»»åŠ¡ï¼Œæ”¾å›ä¸€ä¸ªpromise
exports.promise = () => {
  console.log('promise task')
  return Promise.resolve()
}

exports.promise_error = () => {
  console.log('promise task')
  return Promise.reject(new Error('task failed'))
}

const timeout = time => {
  return new Promise(resolve => {
    setTimeout(resolve, time)
  })
}


// æˆ‘ä»¬ç”šè‡³å¯ä»¥ä½¿ç”¨async å»ä¿®é¥°ä»»åŠ¡
exports.async = async () => {
  await timeout(1000)
  console.log('async task')
}

exports.stream = () => {
  const read = fs.createReadStream('yarn.lock')
  const write = fs.createWriteStream('a.txt')
  read.pipe(write)
  return read
}

// read.on  ç­‰ä»·äº read gunlpä¼šè‡ªåŠ¨çš„å¤„ç† è¿™ä¸ªonç›‘å¬ï¼Œå°±åƒä¸Šé¢çš„ğŸ‘†ğŸ»çš„ä»£ç ä¸€æ ·ï¼Œå¯ä»¥å…è®¸ç›´æ¥è¿”å›ä¸€ä¸ª read
// exports.stream = done => {
//   const read = fs.createReadStream('yarn.lock')
//   const write = fs.createWriteStream('a.txt')
//   read.pipe(write)
//   read.on('end', () => {  
//     done()
//   })
// }

```

### 4.æ„å»ºè¿‡ç¨‹ä¸­çš„æ ¸å¿ƒå·¥ä½œåŸç† ï¼ˆåŸºäºæµçš„å¤„ç†æ–¹æ¡ˆï¼‰
> ä»¥å‰æˆ‘ä»¬å¦‚æœè¦å†™ä¸€ä¸ªçº¯çš„é™æ€é¡µé¢ï¼Œæˆ‘ä»¬éœ€è¦ æ‰‹åŠ¨çš„å»å‹ç¼©ç„¶åï¼Œæ•´ç†å‹ç¼©æ–‡ä»¶ä¹‹åï¼Œæ‰æ‰‹åŠ¨çš„æŠŠè¿™ä¸ªæ–‡ä»¶å‘å¸ƒåˆ°æœåŠ¡å™¨ä¸Šå»ï¼Œè¿™å…¶å®ä¸æ˜¯ä¸€ä¸ªå¥½çš„è§£å†³æ–¹æ¡ˆï¼Œæˆ‘ä»¬éœ€è¦è‡ªåŠ¨åŒ–,æ‰€è°“çš„è‡ªåŠ¨åŒ–æ„å»ºï¼Œ<font style="color:#F5222D;">å°±æ˜¯é€šè¿‡é…ç½®å’Œä»»åŠ¡çš„æ–¹å¼å»åšä¸€äº›é‡å¤æ€§çš„äº‹æƒ…</font>
>

![](https://cdn.nlark.com/yuque/0/2021/png/1627571/1621576132365-78363f2e-42c0-4144-836d-baee60f8137f.png)

æ¯”å¦‚è¿™é‡Œå°±ä»¥ ï¼Œè‡ªåŠ¨è¯çš„æ„å»ºä¸€ä¸ª è‡ªåŠ¨å‹ç¼©æ–‡ä»¶çš„gulpå·¥ä½œæµ

é¦–å…ˆï¼Œæˆ‘ä»¬å‡†å¤‡ä¸€ä¸ªé¡¹ç›®ï¼ˆåŒç†è¿™ä¸€æ­¥æ¯”è¾ƒç®€å•ï¼Œå°±ä¸å¤šbbäº†ï¼Œé¡¹ç›®çš„ç»“æ„å¤§æ¦‚å¦‚ä¸‹æ‰€ç¤ºï¼‰

![](https://cdn.nlark.com/yuque/0/2021/png/1627571/1621576183451-db9b25fc-d13a-41ab-bcef-e974d9921793.png)

```shell
# è¿™æ˜¯éœ€è¦ç”¨åˆ°çš„npmåŒ…
yarn add gulp
```

ç„¶åï¼Œæˆ‘ä»¬å»æ„å»ºä¸€ä¸ªgileè§„åˆ™ï¼Œå†™å‡ ä¸ªæ„å»ºä»»åŠ¡

```javascript
const fs = require('fs')
const { Transform } = require('stream')

exports.default = () => {
  // æ–‡ä»¶è¯»å–æµ
  const readStream = fs.createReadStream('normalize.css')

  // æ–‡ä»¶å†™å…¥æµ
  const writeStream = fs.createWriteStream('normalize.min.css')

  // æ–‡ä»¶è½¬æ¢æµ
  const transformStream = new Transform({
    // æ ¸å¿ƒè½¬æ¢è¿‡ç¨‹
    transform: (chunk, encoding, callback) => {
      const input = chunk.toString()
      const output = input.replace(/\s+/g, '').replace(/\/\*.+?\*\//g, '')
      callback(null, output) // è¿™ä¸ªnull å°±æ˜¯æŒ‡å®šè¦è¾“å‡ºçš„ è·¯å¾„ï¼Œè¿™é‡Œå°±ä¸åˆ¶å®šäº†
    }
  })

  return readStream
    .pipe(transformStream) // è½¬æ¢ æ³¨æ„ğŸ“¢è¿™é‡Œçš„æ‰§è¡Œï¼Œæˆ‘ä»¬æ˜¯ä»¥ä»å·¦åˆ°åˆçš„æ–¹å¼å»æçš„
    .pipe(writeStream) // å†™å…¥
}

```

æ€»ç»“ï¼šä¸Šé¢çš„ä»£ç æˆ‘ä»¬ åªåšäº†è¿™æ ·çš„äº‹æƒ…ï¼Œè¯»å–æ–‡ä»¶ï¼Œåšæ–‡ä»¶çš„å¤„ç†ï¼Œè¾“å‡ºæ–‡ä»¶

æœ€åæˆ‘ä»¬æ¥è¿è¡Œè¿™ä¸ªä»»åŠ¡

```shell
yarn gulp å°±å¥½äº†ï¼Œæ‰§è¡Œå®Œä¹‹åå‘¢ï¼Œæˆ‘ä»¬çš„è¿™ä¸ªcsså°±å‘—å‹ç¼©å¤„ç†å®Œæˆäº†
```

### 5.æ“ä½œæ–‡ä»¶çš„API
> Gulp å®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªåŸºäºæµçš„nodeæ“ä½œç¨‹åºï¼Œgulpä¹Ÿå°è£…äº†å¾ˆå¤š æ–‡ä»¶è¯»å–æ“ä½œï¼Œè€Œä¸”éå¸¸çš„æ–¹ä¾¿å’Œå¼ºå¤§
>

Gulpæ•´ä¸ªå¤„ç†æµç¨‹å°±æ˜¯ï¼šè¯»å–  ===>  è½¬æ¢   =====>  å†™å…¥

 	

æˆ‘ä»¬è¿™é‡Œå…ˆæ¥çœ‹çœ‹ï¼Œå¦‚ä½•åŸºç¡€çš„ä½¿ç”¨

é¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç©ºé¡¹ç›®, 

![](https://cdn.nlark.com/yuque/0/2021/png/1627571/1621737996282-90e5c7e9-86a4-4609-ade4-0876e0fba027.png)

ç„¶åï¼Œæˆ‘ä»¬éœ€è¦å»å®‰è£…ä¸€äº›è¾…åŠ©æ’ä»¶

```shell
yarn gulp // 
yarn gulp-clean-cs //  è¿™ä¸ªæ˜¯ç”¨æ¥å¤„ç†cssçš„
yarn gulp-rename  // gulpçš„æ’ä»¶
```

æœ€åæˆ‘ä»¬æ„å»ºæˆ‘ä»¬çš„fileæ–‡ä»¶é…ç½®

```javascript
const { src, dest } = require('gulp')
const cleanCSS = require('gulp-clean-css')
const rename = require('gulp-rename')

exports.default = () => {
  return src('src/*.css')
    .pipe(cleanCSS())  
    .pipe(rename({ extname: '.min.css' }))
    .pipe(dest('dist'))
}

```

æ¥ä¸‹æ¥æˆ‘ä»¬å°±å»å‘½ä»¤è¡Œçœ‹çœ‹æ˜¯å¦æ˜¯å¯è¡Œçš„

```shell
yarn gulp 
```

### 6.ä¸€ä¸ªå°è€Œå…¨çš„é¡¹ç›®æ„å»ºè¿‡ç¨‹
> æˆ‘ä»¬è¿™é‡Œæå‰å‡†å¤‡äº†ä¸€äº›æ–‡ä»¶ï¼Œæˆ‘ä»¬çœ‹çœ‹ å¦‚æœä½¿ç”¨gulpè¿›è¡Œè¿™ä¸ªå·¥ç¨‹çš„è‡ªåŠ¨åŒ–ï¼Œè¿™æ ·æ¿ä»£ç åœ¨è¯·æ¥ä¿¡è€æå“ˆ
>

  	é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦æ‹‰å–å¯¹åº”çš„æ¨¡æ¿ä»£ç ç‰‡æ®µ

![](https://cdn.nlark.com/yuque/0/2021/png/1627571/1621743989619-1ad734d3-8e6f-4e67-836f-b7ece07647d9.png)

ç„¶åï¼Œæˆ‘ä»¬éœ€è¦å®‰è£…ä¸€äº›ä¾èµ–æ–‡ä»¶

```javascript
# åŸºæœ¬ä¸Šæ¯ä¸€ä¸ªæ’ä»¶éƒ½æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°å°±æ˜¯å»å¤„ç†æˆ‘ä»¬çš„æ–‡ä»¶æµ

    "@babel/core": "^7.5.5",
    "@babel/preset-env": "^7.5.5",  // è¿™ä¸¤ä¸ªæ˜¯babelå°±ä¸å¤šè¯´äº†
    "browser-sync": "^2.26.7",  
    "del": "^5.1.0", // è¿™ä¸ªå¯ä»¥ç”¨æ¥åˆ é™¤æ–‡ä»¶ï¼Œä¸æ˜¯gulpæ’ä»¶ï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥ç”¨
    "gulp": "^4.0.2",
    "gulp-babel": "^8.0.0", //  è¿™ä¸ªå’Œä¸Šé¢ä¸¤ä¸ªbableæ˜¯åˆåœ¨ä¸€èµ·ä½¿ç”¨çš„
    "gulp-clean-css": "^4.2.0", // è¿™ä¸ªæ˜¯æ¸…é™¤cssæ–‡ä»¶çš„
    "gulp-htmlmin": "^5.0.1",    // è¿™ä¸ªæ˜¯å‹ç¼©htmlçš„
    "gulp-if": "^3.0.0",   // è¿™ä¸ªæ˜¯åšåœ¨è¯»å–æµä¸­ åšifåˆ¤æ–­çš„
    "gulp-imagemin": "^6.1.0",  // è¿™ä¸ªæ˜¯å‹ç¼©å›¾ç‰‡çš„
    "gulp-load-plugins": "^2.0.1", // ç»Ÿä¸€pluginé…ç½®ï¼Œ è¿™ä¸ªæ˜¯åŠ è½½pluginçš„
    "gulp-sass": "^4.0.2", // è¿™ä¸ªæ˜¯åŠ è½½sasså¤„ç†çš„
    "gulp-swig": "^0.9.1", // è¿™ä¸ªæ˜¯åšhtmlçš„æ¨¡æ¿è¯­æ³•ç¼–è¯‘ç”¨çš„
    "gulp-uglify": "^3.0.2", // å‹ç¼©jsçš„
    "gulp-useref": "^3.1.6" // åšæŒ‡ä»¤ ç¼–è¯‘çš„plugin

// è¿™é‡Œéƒ½æ˜¯æˆ‘ä»¬éœ€è¦ç”¨åˆ°çš„ä¸œè¥¿
    
```

å†åï¼Œæˆ‘ä»¬éœ€è¦çœ‹çœ‹æˆ‘ä»¬éœ€è¦åšå“ªäº›äº‹æƒ…ï¼Œæˆ‘æŠŠä»–ä»¬éƒ½åˆ—æˆä¸€ç»„ Todo

    - [x] cssçš„ç¼–è¯‘
    - [x]  è„šæœ¬ç¼–è¯‘
    - [x] é¡µé¢æ¨¡æ¿ç¼–è¯‘
    - [x] é™æ€èµ„æºçš„ç¼–è¯‘
    - [x] æ¸…é™¤æ–‡ä»¶
    - [x] è‡ªåŠ¨åŠ è½½æ’ä»¶
    - [x] å¼€å‘æœåŠ¡å™¨
    - [x] ç›‘å¬æ–‡ä»¶å˜åŒ–å’Œæ„å»ºä¼˜åŒ–
    - [x] . userefæ–‡ä»¶çš„å¼•ç”¨å’Œå¤„ç†
    - [x]  æ–‡ä»¶å‹ç¼©
    - [x] æ–‡ä»¶å‹ç¼©å’Œå…¶å®ƒå†…å®¹çš„è¡¥å……

æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•ç¼–å†™file

```javascript
const { src, dest, parallel, series, watch } = require('gulp')

const del = require('del')
const browserSync = require('browser-sync')

const loadPlugins = require('gulp-load-plugins')
// è¿™ä¸ªæ˜¯ä¸€ä¸ªgulpä¸­çš„ä¸€ä¸ªè¾…åŠ©æ’ä»¶ï¼Œç”¨äºæ–¹ä¾¿æˆ‘ä»¬å¼€å‘è°ƒè¯•ï¼Œä¸ç”¨æˆ‘ä»¬æ¯æ¬¡éƒ½å†™require(â€˜æ’ä»¶åå­—â€™)
// å› ä¸ºä¹‹åï¼Œæ‰€æœ‰gulpçš„æ’ä»¶éƒ½ä¼šæˆä¸ºè¿™ä¸ªloadPulugs() è¿”å›çš„å¯¹è±¡ä¸Šçš„å±æ€§
// å…·ä½“çš„è§„åˆ™æ˜¯è¿™æ ·çš„ï¼šæ’ä»¶å gulp-sass ï¼Œä¼šå˜æˆ plugins.sassã€‚
// æ’ä»¶å  gulp-sass-loader  ä¼šå˜æˆ plugins.sassLoader
const plugins = loadPlugins()
const bs = browserSync.create()

const data = {
  menus: [
    {
      name: 'Home',
      icon: 'aperture',
      link: 'index.html'
    },
    {
      name: 'Features',
      link: 'features.html'
    },
    {
      name: 'About',
      link: 'about.html'
    },
    {
      name: 'Contact',
      link: '#',
      children: [
        {
          name: 'Twitter',
          link: 'https://twitter.com/w_zce'
        },
        {
          name: 'About',
          link: 'https://weibo.com/zceme'
        },
        {
          name: 'divider'
        },
        {
          name: 'About',
          link: 'https://github.com/zce'
        }
      ]
    }
  ],
  pkg: require('./package.json'),
  date: new Date()
}

// 6ã€æ¸…é™¤ä¹‹å‰æ—§çš„distä¸­çš„æ–‡ä»¶
const clean = () => {
  return del(['dist', 'temp'])
  // ä¸´æ—¶æ–‡ä»¶tempç”¨äºæä¾›åˆ°å¼€å‘é˜¶æ®µä½¿ç”¨çš„ åªæœ‰userefå½±å“åˆ°çš„é‡‡éœ€è¦æ”¾åˆ°tempä¸­ 
}

// 1.è¿™ä¸ªæ˜¯æ ·å¼çš„ç¼–è¯‘ä»»åŠ¡
const style = () => {
  return src('src/assets/styles/*.scss', { base: 'src' })
    .pipe(plugins.sass({ outputStyle: 'expanded' }))
    .pipe(dest('temp'))
    .pipe(bs.reload({ stream: true }))
}

// 2è¿™æ˜¯ç¼–è¯‘es6
const script = () => {
  return src('src/assets/scripts/*.js', { base: 'src' })
    .pipe(plugins.babel({ presets: ['@babel/preset-env'] }))
    .pipe(dest('temp'))
    .pipe(bs.reload({ stream: true }))
}

// 3ã€1 è¿™ä¸ªæ˜¯åš ï¼Œæ¨¡æ¿ç¼–è¯‘çš„
const page = () => {
  return src('src/*.html', { base: 'src' })
    .pipe(plugins.swig({ data, defaults: { cache: false } })) // é˜²æ­¢æ¨¡æ¿ç¼“å­˜å¯¼è‡´é¡µé¢ä¸èƒ½åŠæ—¶æ›´æ–°,è¿™ä¸ªå°±æ˜¯cacheçš„å‚æ•°çš„ä½œç”¨
    .pipe(dest('temp'))
    .pipe(bs.reload({ stream: true }))
}

// 4ã€è¿™ä¸ªæ˜¯åš å›¾ç‰‡å¤„ç†å’Œå‹ç¼©çš„çš„
const image = () => {
  return src('src/assets/images/**', { base: 'src' })
    .pipe(plugins.imagemin())
    .pipe(dest('dist'))
}
// 5.è¿™ä¸ªæ˜¯å¤„ç†å­—ä½“æ–‡ä»¶çš„ å‹ç¼© å’Œæ‰“åŒ…
const font = () => {
  return src('src/assets/fonts/**', { base: 'src' })
    .pipe(plugins.imagemin())
    .pipe(dest('dist'))
}

// 6ã€è¿™ä¸ªæ˜¯æ’é™¤çš„æ„æ€ï¼Œextra.æ„æ€æ˜¯æˆ‘ä»¬éƒ¨é˜Ÿpublicåšä»»ä½•å¤„ç†ï¼Œè¿™æ˜¯ä¸€ä¸ªç®€å•çš„å¤åˆ¶æ“ä½œ
const extra = () => {
  return src('public/**', { base: 'public' })
    .pipe(dest('dist'))
}

// 7. è¿™ä¸ªæ˜¯ä¸€ä¸ªå°å‹çš„å¼€å‘æœåŠ¡å™¨ï¼Œä½œç”¨å‘¢å°±æ˜¯å¯ä»¥å…è®¸ä½ è¿›è¡Œä¸€äº›çƒ­æ›´æ–° çƒ­ç¼–è¯‘ ï¼Œå®ƒä¸æ˜¯ä¸€ä¸ªgulpæ’ä»¶ï¼Œåªä¸è¿‡æˆ‘ä»¬ç”¨gulpå»ç®¡ç†å®ƒ 
const serve = () => {
  
  // è¿™ä¸ªæ˜¯gulpçš„ä¸€ä¸ªapiç”¨æ¥çœ‹çœ‹ï¼šâ€œå¦‚æœè¿™äº›ç›‘å¬çš„æ–‡ä»¶å˜åŒ–äº†ï¼Œå°±é‡å†™æ‰§è¡Œè¿™ä¸ªstyle/scrip/...ä»»åŠ¡â€
  watch('src/assets/styles/*.scss', style)
  watch('src/assets/scripts/*.js', script)
  watch('src/*.html', page)
  // watch('src/assets/images/**', image)  // è¿™äº›åœ¨ç¼–è¯‘ä»»åŠ¡ï¼Œåœ¨ å¼€å‘é˜¶æ®µæ˜¯æ²¡æœ‰å¿…è¦çš„
  // watch('src/assets/fonts/**', font)
  // watch('public/**', extra)
  watch([
    'src/assets/images/**',
    'src/assets/fonts/**',
    'public/**'
  ], bs.reload)

  
  // è¿™ä¸ªæ˜¯bsçš„æ­£å¼é…ç½®
  bs.init({
    notify: false, // è¿™ä¸ªé¡µé¢ä¸­çš„æç¤º
    port: 2080,  
    // open: false,
    // files: 'dist/**',
    server: {
      baseDir: ['temp', 'src', 'public'],  // ç›‘è§†çš„è·¯å¾„ è¯¦æƒ…
      routes: {// è¿™ä¸ªrouteræ˜¯ä¼šå…ˆäºbaseDirçš„é…ç½®ï¼Œé¦–å…ˆç½‘é¡µè¢«è®¿é—® å…ˆå»çœ‹çœ‹node_moduleä¸‹æœ‰æ²¡æœ‰èµ„æºæ²¡æœ‰çš„è¯å°±å»baseDiræ‰¾
        '/node_modules': 'node_modules'
      }
    }
  })
}

// 8ã€è¿™ä¸ªæ˜¯userefçš„gulpä¸­çš„ä¸€ä¸ªæ’ä»¶ï¼Œä¸»è¦å¤„ç†ç‰¹æ®Šhtmlzhushi 
```html
// æ¯”å¦‚è¿™ä¸€è¡Œæ³¨é‡Šï¼Œå°±æ˜¯userefæ’ä»¶èƒ½å¤„ç†çš„ä¸œè¥¿
  <!-- build:css assets/styles/vendor.css -->
  <link rel="stylesheet" href="/node_modules/bootstrap/dist/css/bootstrap.css">
  <!-- endbuild -->

// è¿™ä¸ªçš„æ„æ€å°±æ˜¯ï¼šæŠŠ /node_modules/bootstrap/dist/css/bootstrap.css è¿™ä¸ªè·¯å¾„ä¸‹çš„è¿™ä¸ªcssæ‰“åŒ…åˆ°assets/styles/vendor.css ä¸‹ï¼Œcsså°±æ˜¯æˆ‘ä»¬åœ¨fileä¸­å®šä¹‰çš„ cssä»»åŠ¡
```
// æˆ‘ä»¬çœ‹çœ‹è¿™ä¸ªé…ç½®çš„çš„å†™æ³• 
const useref = () => {
  return src('temp/*.html', { base: 'temp' }) // é¦–å…ˆæ˜¯è·å–è¿™äº›æºæ–‡ä»¶
    .pipe(plugins.useref({ searchPath: ['temp', '.'] })) // æŠŠè¿™äº›æ–‡ä»¶ ä¼ é€’åˆ° useref ä¸­ï¼Œpipeä¹‹åå°±å¯ä»¥ç›´pipe(dest('dist')) åˆ°distç›®å½•ä¸­
    // html js css è¿™ä¸ªå°±æ˜¯å‹ç¼©çš„è¿‡ç¨‹
    .pipe(plugins.if(/\.js$/, plugins.uglify()))
    .pipe(plugins.if(/\.css$/, plugins.cleanCss()))
    .pipe(plugins.if(/\.html$/, plugins.htmlmin({
      collapseWhitespace: true,
      minifyCSS: true,
      minifyJS: true
    })))
    .pipe(dest('dist'))
}

// é‡è¦ã€è¿™ä¸ª æ˜¯ç»„åˆä»»åŠ¡ï¼Œparallelæ˜¯å¹¶å‘çš„ï¼Œå› ä¸ºæˆ‘ä»¬è¿™ä¸ªä¸¤ä¸ªæ˜¯æ²¡æœ‰å…ˆåä¾èµ–çš„
const compile = parallel(style, script, page)

// é‡è¦ã€ä¸Šçº¿ä¹‹å‰æ‰§è¡Œçš„ä»»åŠ¡
const build =  series(
  clean,
  parallel(
    series(compile, useref), // è¿™ä¸ªuserefæ˜¯ä¸ºäº†è¡¥å……compileä»»åŠ¡çš„ï¼Œæ‰€æœ‰åº”è¯¥æ˜¯ä¸²è¡Œä»»åŠ¡çš„
    image,
    font,
    extra
  )
)

const develop = series(compile, serve)

module.exports = {
  clean,
  build,// æˆ‘ä»¬éœ€è¦å…ˆè¿è¡Œè¿™ä¸ªdevlop
  develop
}

```

æœ€åï¼Œæˆ‘ä»¬éœ€è¦å»æŠŠè¿™äº›ä»»åŠ¡éƒ½é…ç½®åˆ°package.json

```json

  "scripts": {
    "clean": "gulp clean",
    "build": "gulp build",
    "develop": "gulp develop"
  },
```

æˆ‘ä»¬è¿˜éœ€è¦å» gitignoe é…

```javascript
# Logs
logs
*.log
npm-debug.log*
yarn-debug.log*
yarn-error.log*

# Runtime data
pids
*.pid
*.seed
*.pid.lock

# Directory for instrumented libs generated by jscoverage/JSCover
lib-cov

# Coverage directory used by tools like istanbul
coverage

# nyc test coverage
.nyc_output

# Grunt intermediate storage (http://gruntjs.com/creating-plugins#storing-task-files)
.grunt

# Bower dependency directory (https://bower.io/)
bower_components

# node-waf configuration
.lock-wscript

# Compiled binary addons (https://nodejs.org/api/addons.html)
# è¿™ä¸ªæ¯”è¾ƒé‡è¦ï¼Œå°±æ˜¯å»æ‰releaseçš„æ„å»ºäº§ç‰©
build/Release

# Dependency directories
node_modules/
jspm_packages/

# TypeScript v1 declaration files
typings/

# Optional npm cache directory
.npm

# Optional eslint cache
.eslintcache

# Optional REPL history
.node_repl_history

# Output of 'npm pack'
*.tgz

# Yarn Integrity file
.yarn-integrity

# dotenv environment variables file
.env

# next.js build output
.next

# å»æ‰æ‰“åŒ…å¥½çš„distäº§ç‰©å’Œ tempäº§ç‰©
dist

temp

```

## å››ã€å°è£…ä¸€ä¸ªå·¥ä½œæµ
> ä»¥ä¸Šï¼Œæ˜¯ä¸€ä¸ªå•ä¸€çš„ä¸€ä¸ªfgulpå·¥ä½œæµï¼Œç°åœ¨æˆ‘ä»¬æ¥æƒ³æ³•å­ï¼ŒæŠŠè¿™å¥—å·¥ä½œæµç»™æŠ½ç¦»å‡ºæ¥ï¼Œä¸é¡¹ç›®ä¸é…ç½®æ— å…³çš„cli
>
> è¾¾åˆ°çš„æ•ˆæœå°±æ˜¯ï¼šä½ npmæŠŠè¿™ä¸ªæ¨¡å—ä¸‹è½½ä¸‹æ¥å°±èƒ½è‡ªåŠ¨çš„ç»™ä½ é…ç½®å¥½è¿™äº›æ„å»ºä»»åŠ¡ï¼Œå¹¶å¼€å§‹æ„å»ºå’Œæ‰§è¡Œ
>
> å°±å¥½åƒä½ ä¸‹è½½ä¸€ä¸ªvue cliä¹‹åï¼Œé»˜è®¤çš„æƒ…å†µä¸‹ä½ ä¸éœ€è¦ç»™å®ƒé…ä»€ä¹ˆï¼Œç›´æ¥è¿è¡Œé»˜è®¤çš„é…ç½®å¤§å¤šæ•°æƒ…å†µä¸‹ä¹Ÿæ˜¯å¤Ÿç”¨çš„ï¼Œå®ƒä¼šè‡ªåŠ¨å»è¯»å–ä½ çš„é¡¹ç›®ç»“æ„å¹¶åœ¨ä½ éœ€è¦æ‰“åŒ…çš„æ—¶å€™åšå¯¹åº”çš„ç¼–è¯‘ä»»åŠ¡ã€‚æˆ‘ä»¬ç°åœ¨è¦åšçš„å°±æ˜¯æŠŠä¸Šé¢æˆ‘ä»¬å†™çš„è¿™ä¸ªgulpå·¥ä½œæµä¹Ÿç»™æ‰“åŒ…è¿›æ¥ï¼Œå˜æˆä¸€ä¸ªä¸vue cliç±»ä¼¼çš„ä¸œè¥¿
>

### 1. ç¡®å®šç›®æ ‡
æˆ‘ä»¬éœ€åˆ›å»ºä¸€ä¸ªcliè„šæ‰‹æ¶é¡¹ç›® ï¼ŒåŠŸèƒ½å°±æ˜¯è¦æŠŠä¸Šé¢çš„è¿™äº›å·¥ä½œæµï¼Œç»™å®ƒåŠ åˆ°è¿™é‡Œé¢æ¥

### 2. åˆå§‹åŒ–é¡¹ç›®æ–‡ä»¶ç›®æ„é€ 
> æ³¨æ„è¿™ä¸ªé‡Œçš„è¿™ä¸ªæ–‡ä»¶å¤¹ç›®å½• ï¼Œéšä¾¿ä½ æ€ä¹ˆæï¼Œå®ƒåªæ˜¯æ„å»ºä½ è¿™ä¸ªclié¡¹ç›®çš„æˆ‘ä»¬çº¦å®šçš„è€Œå·²ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ä¹Ÿå¾ˆå°‘äººæœ‰äººæ”¹è¿™ä¸ªé¡¹ç›®ç›®å½•ç»“æ„
>



![](https://cdn.nlark.com/yuque/0/2021/png/1627571/1622385839968-36834fea-7a2d-42d9-a6aa-4da650c5db6b.png)

### 3. æå–gulpfile
æˆ‘ä»¬éœ€è¦æŠŠæ•´ä¸ª ä¹‹å‰çš„gulpfileé‡Œçš„é…ç½® cvè¿‡å» åˆ°libä¸‹çš„æ–‡ä»¶ä¸­å»,å¹¶ä¸”æŠŠéœ€è¦çš„devä¾èµ–éƒ½å®‰è£…ä¸‹å»

lib/index.js

```javascript
const { src, dest, parallel, series, watch } = require('gulp')

const del = require('del')
const browserSync = require('browser-sync')

const loadPlugins = require('gulp-load-plugins')

const plugins = loadPlugins()
const bs = browserSync.create()

const data = {
  menus: [
    {
      name: 'Home',
      icon: 'aperture',
      link: 'index.html'
    },
    {
      name: 'Features',
      link: 'features.html'
    },
    {
      name: 'About',
      link: 'about.html'
    },
    {
      name: 'Contact',
      link: '#',
      children: [
        {
          name: 'Twitter',
          link: 'https://twitter.com/w_zce'
        },
        {
          name: 'About',
          link: 'https://weibo.com/zceme'
        },
        {
          name: 'divider'
        },
        {
          name: 'About',
          link: 'https://github.com/zce'
        }
      ]
    }
  ],
  pkg: require('./package.json'),
  date: new Date()
}

const clean = () => {
  return del(['dist', 'temp'])
}

const style = () => {
  return src('src/assets/styles/*.scss', { base: 'src' })
    .pipe(plugins.sass({ outputStyle: 'expanded' }))
    .pipe(dest('temp'))
    .pipe(bs.reload({ stream: true }))
}

const script = () => {
  return src('src/assets/scripts/*.js', { base: 'src' })
    .pipe(plugins.babel({ presets: ['@babel/preset-env'] }))
    .pipe(dest('temp'))
    .pipe(bs.reload({ stream: true }))
}

const page = () => {
  return src('src/*.html', { base: 'src' })
    .pipe(plugins.swig({ data, defaults: { cache: false } })) // é˜²æ­¢æ¨¡æ¿ç¼“å­˜å¯¼è‡´é¡µé¢ä¸èƒ½åŠæ—¶æ›´æ–°
    .pipe(dest('temp'))
    .pipe(bs.reload({ stream: true }))
}

const image = () => {
  return src('src/assets/images/**', { base: 'src' })
    .pipe(plugins.imagemin())
    .pipe(dest('dist'))
}

const font = () => {
  return src('src/assets/fonts/**', { base: 'src' })
    .pipe(plugins.imagemin())
    .pipe(dest('dist'))
}

const extra = () => {
  return src('public/**', { base: 'public' })
    .pipe(dest('dist'))
}

const serve = () => {
  watch('src/assets/styles/*.scss', style)
  watch('src/assets/scripts/*.js', script)
  watch('src/*.html', page)
  // watch('src/assets/images/**', image)
  // watch('src/assets/fonts/**', font)
  // watch('public/**', extra)
  watch([
    'src/assets/images/**',
    'src/assets/fonts/**',
    'public/**'
  ], bs.reload)

  bs.init({
    notify: false,
    port: 2080,
    // open: false,
    // files: 'dist/**',
    server: {
      baseDir: ['temp', 'src', 'public'],
      routes: {
        '/node_modules': 'node_modules'
      }
    }
  })
}

const useref = () => {
  return src('temp/*.html', { base: 'temp' })
    .pipe(plugins.useref({ searchPath: ['temp', '.'] }))
    // html js css
    .pipe(plugins.if(/\.js$/, plugins.uglify()))
    .pipe(plugins.if(/\.css$/, plugins.cleanCss()))
    .pipe(plugins.if(/\.html$/, plugins.htmlmin({
      collapseWhitespace: true,
      minifyCSS: true,
      minifyJS: true
    })))
    .pipe(dest('dist'))
}

const compile = parallel(style, script, page)

// ä¸Šçº¿ä¹‹å‰æ‰§è¡Œçš„ä»»åŠ¡
const build =  series(
  clean,
  parallel(
    series(compile, useref),
    image,
    font,
    extra
  )
)

const develop = series(compile, serve)

module.exports = {
  clean,
  build,
  develop
}

```

å®‰è£…å¯¹åº”çš„éœ€è¦çš„dev



ç„¶åæˆ‘ä»¬ä¸ºäº†æ–¹ä¾¿æµ‹è¯•ï¼ŒæŠŠæˆ‘ä»¬çš„è€é¡¹ç›®çš„ä¹Ÿå°±æ˜¯ gulpä¸Šé¢ç¬¬å…­è®²çš„è¿™ä¸ªé¡¹ç›®ä¸­çš„gulpç›¸å…³çš„éƒ½å¹²æ‰ï¼Œç„¶åè®©è‡ªå·±çš„gulp cli linkåˆ°è¿™ä¸ªé¡¹ç›®ä¸­ï¼Œè¿™æ ·æˆ‘ä»¬å°±èƒ½æ–¹ä¾¿çš„è¿›è¡Œè°ƒè¯•äº†

```shell
# åœ¨ä½ çš„clié¡¹ç›®ä¸­linkä¸€ä¸‹
yarn link 

# å›åˆ°ä¹‹å‰é‚£çš„é¡¹ç›®ä¸­ linkå›æ¥
yarn link "ä½ çš„clié¡¹ç›®åå­—"
```

	åœ¨æ—§çš„é¡¹ç›® çš„gulpfile.js ä¸­æŠŠæˆ‘ä»¬çš„cliå¯¼å‡ºçš„ä¸œè¥¿ æ‹¿è¿‡æ¥å°±è¡Œäº†

/ æ—§é¡¹ç›® / gulpfile.js

```shell
module.exports = require('ä½ çš„clié¡¹ç›®åå­—')
```

æˆ‘ä»¬å»è¯•ä¸€ä¸‹

```shell
yarn build

# ç„¶åå‘ç°ä¿å­˜äº†ï¼ŒåŸå› æ˜¯ æˆ‘ä»¬åœ¨æ—§é¡¹ç›®ä¸­çš„node_moudleä¸‹æ²¡æœ‰gulpçš„å‘½ä»¤äº†ã€‚æˆ‘ä»¬æš‚æ—¶è§£å†³ä¸€ä¸‹ ï¼Œè¿™ä¸ªé—®é¢˜åœ¨æˆ‘ä»¬æ­£å¼å‘å¸ƒnpmä¹‹åï¼Œå°±ä¸ä¼šå­˜åœ¨è¿™ä¸ªé—®é¢˜äº†
yarn add gulp-cli gulp --dev

# å¦‚æœä½ å‘ç°è¿˜æ˜¯é”™è¯¯äº†ï¼Œé‚£ä¹ˆå¤§æ¦‚å°±æ˜¯ä½ çš„packJsonæ–‡ä»¶ï¼Œå› ä¸ºä¹‹å‰çš„ packJsonçš„ä¹‹å‰çš„é¡¹ç›®æ¥çš„å†™æ­»çš„ï¼Œæˆ‘ä»¬è¦æŠ½ç¦»å‡ºæ¥ åœ¨é¡¹ç›®ä¸­é…ç½®ä¸€ä¸‹è¿™ä¸ªé…ç½®æ–‡ä»¶ï¼Œå°±åƒwebpackå¾—config
```

### 4.åˆ›å»ºä¸€ä¸ª é…ç½®æ–‡ä»¶
.pages.config.js , å°±åƒvue ä¸‹çš„vue.configæ–‡ä»¶ä¸€æ ·	

```javascript


// è¿™ä¸ªå°±æ˜¯åœ¨æ—§é¡¹ç›®ä¸­é…çš„ï¼Œè¿™äº›æ•°æ®åº”è¯¥å±äº å½“å‰ä½¿ç”¨cliçš„é¡¹ç›®ï¼Œè€Œä¸æ˜¯cliè‡ªå·±æœ¬èº«çš„
module.exports = {  
  build: {  // ä½ é¡¹ç›®ä¸­çš„è·¯å¾„
    src: 'src',
    dist: 'release',
    temp: '.tmp',
    public: 'public',
    paths: {
      styles: 'assets/styles/*.scss',
      scripts: 'assets/scripts/*.js',
      pages: '*.html',  //  æ³¨æ„è¿™äº› é€šé…ç¬¦
      images: 'assets/images/**',
      fonts: 'assets/fonts/**'
    }
  },
  data: {  // ä½ é¡¹ç›®çš„data
    menus: [
      {
        name: 'Home',
        icon: 'aperture',
        link: 'index.html'
      },
      {
        name: 'Features',
        link: 'features.html'
      },
      {
        name: 'About',
        link: 'about.html'
      },
      {
        name: 'Contact',
        link: '#',
        children: [
          {
            name: 'Twitter',
            link: 'https://twitter.com/w_zce'
          },
          {
            name: 'About',
            link: 'https://weibo.com/zceme'
          },
          {
            name: 'divider'
          },
          {
            name: 'About',
            link: 'https://github.com/zce'
          }
        ]
      }
    ],
    pkg: require('./package.json'),
    date: new Date()
  }
}

```

 å½“æˆ‘ä»¬åœ¨é¡¹ç›®ä¸­é…ç½®å®Œäº†çš„æ—¶å€™ã€‚æˆ‘ä»¬è¿˜éœ€è¦å»cliä¸­æŠŠä¹‹å‰å†™æ­»çš„ config éƒ½æ”¹æ”¹

 åœ¨ä½ çš„clié¡¹ç›®çš„lib /inde.jsä¸­è·å–è¿™ä¸ªé…ç½®æ–‡ä»¶

### 5. æŠŠé¡¹ç›®ä¸­çš„gulpfielå»æ‰ï¼Ÿ 
> æˆ‘ä»¬å¸Œæœ›æŠŠè¿™ä¸ªgulpfile å»æ‰ æ€ä¹ˆåšå‘¢ï¼Ÿè¿™ä¸ªæ—¶å€™ä½ çš„binç›®å½•å°±æœ‰ä½œç”¨çš„
>

1. åœ¨gulpä¸­æœ‰è¿™æ ·çš„å‡ ä¸ªshell å‚æ•° å¯ä»¥æŒ‡å®šgulpå»è¿è¡ŒæŸæŒ‡å®šç›®å½•ä¸‹çš„gulpFile

```shell
yarn gulp build --gulpfile  ./node_moudle/ä½ çš„clié¡¹ç›®å/lib/index.js
# æˆ‘ä»¬å¯ä»¥åœ¨clié¡¹ç›®ä¸­ è‡ªå·±å»ºä¸€ä¸ª cli è‡ªå·±å»æ‰§è¡Œ ä¸Šé¢çš„è¯­å¥ã€‚è¿™ä¸ªå°±æ˜¯æŠŠgulpfileå»æ‰çš„æ€è·¯
```

2. åœ¨binä¸‹å»ºç«‹ä¸€ä¸ªjsæ–‡ä»¶
3. åœ¨ä½ çš„clié¡¹ç›®ä¸­ çš„pack.jsonä¸­é…ç½®è¿™ä¸ªbin

```javascript
#!/usr/bin/env node  è¿™ä¸ªæ˜¯å¿…è¦çš„ 

# å…·ä½“ä¸‹é¢çš„ä»£ç é…ç½®åˆ°åº•æ˜¯å¦‚ä½•æ¥çš„ï¼Œæˆ‘ä»¬å¯ä»¥å»çœ‹node_moduleä¸‹çš„ æºä»£ç binæ€ä¹ˆå†™çš„ï¼Œ

# process.argv èƒ½æ‹¿åˆ° æ‰€æœ‰çš„shellå‚æ•°
process.argv.push('--cwd')
process.argv.push(process.cwd())
process.argv.push('--gulpfile')
// è¿™ä¸ªæ˜¯clli é¡¹ç›®libä¸‹çš„ index ,æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªæ–¹æ³•æ¥æ‰¾è¿™ä¸ªæ–‡ä»¶
process.argv.push(require.resolve('..'))  // å®é™…ä¸Šä½ è¿™ä¸ªå°±æ˜¯ ../

require('gulp/bin/gulp') // è¿™ä¸ªå°±æ˜¯æºä»£ç ä¸­çš„gulp-cliçš„æ‰§è¡Œæ–¹å¼ 

```

```javascript
  ],
  "homepage": "https://github.com/zce/zce-pages#readme",
  "bugs": {
    "url": "https://github.com/zce/zce-pages/issues"
  },
  "license": "MIT",
  "author": "zce <w@zce.me> (https://zce.me)",
  "files": [
    "lib",
    "bin"
  ],
  "main": "lib/index.js",
  "bin": "bin/zce-pages.js",
  "directories": {
    "lib": "lib"
  },
```

ä»¥ä¸Šå°±å¯ä»¥å®Œç¾çš„è¿è¡Œäº†





### 6 å‘å¸ƒåˆ°npm
> é»˜è®¤çš„æ—¶å€™ npmä¸ä¼špublic ä¸Š bin å› æ­¤æˆ‘ä»¬éœ€è¦fileæŒ‡å®šä¸€ä¸‹
>

```javascript
  "files": [
    "lib",
    "bin"
  ],
```

## æ€»ç»“
æƒ³æ³•æ˜¯å»ºç«‹åœ¨é‡Œçš„æŠ€èƒ½ä¹‹ä¸Šçš„ï¼Œä½ çš„æŠ€èƒ½è¶Šå¤šæƒ³æ³•è¶Šå¤šä½ å°±è¶Šæœ‰æ›´å¤šçš„å°è¯•

