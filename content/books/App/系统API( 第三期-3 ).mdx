---
title: "IOSå¼€å‘ï¼šå›¾ç‰‡å­˜å‚¨ã€å¤šåª’ä½“å¤„ç†ä¸å¸ƒå±€é€‚é…"
date: "2025-06-17"
summary: "æ·±å…¥è®²è§£IOSä¸­å›¾ç‰‡å­˜å‚¨æ–¹æ¡ˆã€è§†é¢‘æ’­æ”¾å®ç°ã€AutoLayoutå¸ƒå±€åŸç†åŠå±å¹•é€‚é…æŠ€æœ¯ï¼ŒåŒ…å«SDWebImageä½¿ç”¨ã€AVFoundationæ¡†æ¶åº”ç”¨å’Œå“åº”å¼å¸ƒå±€å®è·µã€‚"
status: "completed"
tech: ["iOS", "Multimedia", "AutoLayout"]
github: "https://github.com/BM-laoli"
arxiv: ""
keyId: "App"
---

## IOSä¸­å›¾ç‰‡çš„å­˜å‚¨
### ç†è®ºçŸ¥è¯†
![](https://cdn.nlark.com/yuque/0/2021/png/1627571/1639110759878-2ece2818-9f15-43e9-a35c-8ea4cccd9deb.png)



å¯¹äºèµ„æºæ¥è¯´ï¼Œè¯»å–ç½‘ç»œæ˜¯æœ€è€—æ—¶çš„ï¼Œå­˜å‚¨æœ¬åœ°æ˜¯æœ€æ–¹ä¾¿çš„ã€‚ä¸Šè¿°å°±æ˜¯iosåŠ è½½ä¸€å¼ å›¾ç‰‡çš„è¿‡ç¨‹ï¼Œé‚£ä¹ˆæœ‰æ²¡æœ‰ å¥½çš„å¤„ç†æ–¹æ¡ˆå‘¢ï¼Ÿæ˜¯æœ‰çš„ä¸‹é¢å°±æ˜¯æ–¹æ¡ˆï¼Œæ˜¯æ•´ä¸ªå›¾ç‰‡çš„å­˜å‚¨æ–¹æ¡ˆå’Œè¿‡ç¨‹

![](https://cdn.nlark.com/yuque/0/2021/png/1627571/1639110901489-2f6cf545-ef4e-4f3d-90ba-59604b85e00d.png)



æˆ‘ä»¬å¸¸ç”¨çš„å°±æ˜¯ä¸€ä¸ªå¼€æºæ¡†æ¶SDWebImgae å…¶åº•å±‚å°±ç®—ä¸Šè¿°çš„

![](https://cdn.nlark.com/yuque/0/2021/png/1627571/1639111059190-35cf2643-734c-4237-a0bd-c1e7e435fc60.png)



### ä»£ç æŒ‡å—
> æˆ‘ä»¬ç°åœ¨å°±ç”¨cocoapodå¼•å…¥ä¸€ä¸ª å¼€æºçš„æ¡†æ¶SDWebImg
>

ç¬¬ä¸€æ­¥å‘¢ï¼Œæˆ‘ä»¬è¦ç”¨ä½¿ç”¨cocapads ä¸‹è½½è¿™ä¸ªå¼€æºçš„åº“ä¸‹æ¥ï¼Œ

1. ç¼–è¾‘æˆ‘ä»¬çš„podfileæ–‡ä»¶

```javascript
target 'SimpelApp' do 
  pod 'AFNetworking'
  pod 'SDWebImage'
end
```

2. å‘½ä»¤è¡Œèµ°èµ·æ¥

```bash
pod update
```

ç¼–ç å¼€å§‹

```objectivec

#import "CGPtTableViewCell.h"
#import "GTLIstItem.h"
#import "SDWebImage.h"

++++

- (void) layoutInitCellWithItem: (GTLIstItem *) item { 
   ++++
    // ä½¿ç”¨SDWebImageå®ç°å›¾ç‰‡çš„åŠ è½½  é€»è¾‘å¦‚ä¸‹ï¼šå…ˆçœ‹çœ‹ç¼“å­˜ä¸­æœ‰æ²¡æœ‰ï¼Œæ²¡æœ‰å°±å»åŠ è½½ï¼Œç„¶åæŠŠåŠ è½½å‡ºçš„å›¾ç‰‡å­˜åˆ°ç¼“å­˜ä¸­å»
    [self.rightImageView sd_setImageWithURL:[NSURL URLWithString:item.picUrl]
                                  completed:^(UIImage * _Nullable image, NSError * _Nullable error, SDImageCacheType cacheType, NSURL * _Nullable imageURL) {
        NSLog(@"666");
    }];
    //åŸºæœ¬ä¸Šè¿™äº›ç½‘å›¾ç‰‡æ¡†æ¶éƒ½æ˜¯å›´ç»•æ¢å­˜å±•ä½å›¾å†…å­˜ï¼Œå®é™…ä¸Šæœ€åå¦‚ä½•å®ç° é‡‡ç”¨ä»€ä¹ˆæ ·çš„æ–¹æ¡ˆï¼Œéƒ½æ˜¯éœ€è¦æ·±å¦‚æ€è€ƒçš„
}


@end

```

![](https://cdn.nlark.com/yuque/0/2021/png/1627571/1639111655215-348f5d63-d0ff-4583-8fb0-6a99759f7312.png)

![](https://cdn.nlark.com/yuque/0/2021/png/1627571/1639111755720-eb01b7bd-e658-4774-9f34-0aae0011ade7.png)



# æˆ‘ä»¬æ¥èŠèŠIOSå¤šåª’ä½“å¤„ç†
> éŸ³è§†é¢‘èµ„æºå¤„ç†
>

## ç†è®ºçŸ¥è¯†
![](https://cdn.nlark.com/yuque/0/2021/png/1627571/1640005308820-aa913ff3-9d45-4354-8b85-3886318a3c70.png)

![](https://cdn.nlark.com/yuque/0/2021/png/1627571/1640005418754-eddf1a57-ad2d-4dd5-90e4-b7d08067bcfc.png)

æ³¨æ„ï¼šè¿™é‡Œæœ‰å¾ˆå¤šæˆ‘ä»¬ä¹‹å‰è¯´è¿‡çš„çŸ¥è¯† æ¯”å¦‚Layerè€Œä¸æ˜¯ä¸€ä¸ªView , å¯¹äºIOSä¸­çš„éŸ³è§†é¢‘ï¼Œæˆ‘ä»¬åªéœ€è¦æŒæ¡ä¸Šé¢çš„ä¸‰ä¸ªå°±å¤Ÿäº†å“ˆã€‚

![](https://cdn.nlark.com/yuque/0/2021/png/1627571/1640005710611-6e224ac6-e6f5-4d16-9d53-51deb6605d84.png)



## é‡æ„è§†é¢‘åˆ—è¡¨
æˆ‘ä»¬ç›®å‰å¸Œæœ›åšçš„æ•ˆæœå°±æ˜¯åšå…ˆæŠŠè§†é¢‘åˆ—è¡¨åšå¥½ï¼Œï¼ˆå–è§†é¢‘çš„ç¬¬ä¸€å¾ï¼Œå’Œä¸€ä¸ªæ’­æ”¾æŒ‰é’®ï¼Œitemç»„ä»¶åˆå§‹åŒ–çš„æ—¶å€™éœ€è¦è‡ªå®šä¹‰ä¸€ä¸ªåˆå§‹åŒ–å‡½æ•°å¯ä»¥æŠŠVideoçš„ç¬¬ä¸€å¾+è§†é¢‘urlåœ°å€ä¼ å…¥å…¶ä¸­ï¼‰

å®ƒå‘¢å¤§æ¦‚å°±æ˜¯é•¿æˆäº†ä¸‹é¢è¿™ä¸ªæ ·å­

![](https://cdn.nlark.com/yuque/0/2021/png/1627571/1640095049768-beece137-4557-482c-aef5-93a348dd9607.png)



```objectivec
# ç¬¬ä¸€æ­¥æˆ‘ä»¬æ–°å¢ä¸€ä¸ªæ–‡ä»¶ï¼Œh m è¿™ä¸¤å°±æ˜¯Itemçš„ç»„ä»¶ç±»

# .h 
#import <UIKit/UIKit.h>

NS_ASSUME_NONNULL_BEGIN

@interface GTVideioCoverCell : UICollectionViewCell
- (void) layoutWithVideoCoverUrl:(NSString *)videoCoverUrl  videoUrl: (NSString *)videoUrl;
@end

NS_ASSUME_NONNULL_END


# .m
#import "GTVideioCoverCell.h"

@interface GTVideioCoverCell()
@property(nonatomic, strong, readwrite) UIImageView *coverView;
@property(nonatomic, strong, readwrite) UIImageView *playButton;
@property(nonatomic, strong, readwrite) NSString *VideoUrl;
@end

@implementation GTVideioCoverCell

- (instancetype)initWithFrame:(CGRect)frame{
    self = [super initWithFrame:frame];
    if(self){
        [self addSubview:({
            _coverView  = [[UIImageView alloc] initWithFrame:CGRectMake(0, 0, frame.size.width, frame.size.height)];
            _coverView;
        })];
        
        [self addSubview:({
            _playButton  = [[UIImageView alloc] initWithFrame:CGRectMake((frame.size.width - 50) / 2, (frame.size.width - 50) / 2 , 50, 50)];
        })];
        
        UITapGestureRecognizer *tapGesture = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(_tapClick)];
        [self addGestureRecognizer: tapGesture];
    }
    return  self;
};

#pragma mark - public method
- (void) layoutWithVideoCoverUrl:(NSString *)videoCoverUrl  videoUrl: (NSString *)videoUrl {
    _coverView.image = [UIImage imageNamed:videoCoverUrl];
    _playButton.image = [UIImage imageNamed:@"icon.bundle/palyer-start.png"];
    _VideoUrl = videoUrl;
};

#pragma mark - private method
- (void)_tapClick {
    NSLog(@"");
};
@end

```

> ç„¶åæˆ‘ä»¬åœ¨ä½¿ç”¨çš„æ—¶å€™åªéœ€è¦è¿™æ · ä¼ å…¥æ•°æ®å°±å¥½äº†
>

```javascript
# è¿™ä¸ªå°±æ˜¯æˆ‘ä»¬ä¹‹å‰åšçš„ æ•´ä¸ªè§†é¢‘åˆ—è¡¨é¡µé¢çš„Controller
//  CGVideoViewController.m
//  SimpelApp
//
//  Created by æä»•å¢ on 2021/10/22.
//

#import "CGVideoViewController.h"
#import "GTVideioCoverCell.h"


@interface CGVideoViewController ()<UICollectionViewDelegate,UICollectionViewDataSource>

@end
@implementation CGVideoViewController

- (instancetype) init {
    self = [super init];
    if (self) {
        self.view.backgroundColor = [UIColor orangeColor];
        self.tabBarItem.title =@"è§†é¢‘";
        self.tabBarItem.image = [UIImage imageNamed:@"icon.bundle/all.png"];
        self.tabBarItem.selectedImage = [UIImage imageNamed:@"icon.bundle/allActive.png"];
    }
    return  self;
};

- (void)viewDidLoad {
    [super viewDidLoad];
    
    UICollectionViewFlowLayout *flowLayout  = [[UICollectionViewFlowLayout alloc] init];
    flowLayout.minimumLineSpacing = 10;
    flowLayout.minimumInteritemSpacing = 10;
    // åšä¸€ä¸ª16 * 9  View
    flowLayout.itemSize = CGSizeMake( self.view.bounds.size.width,  self.view.bounds.size.width /16 * 9 );
    
    
    UICollectionView *collectionViee = [[UICollectionView alloc] initWithFrame:self.view.bounds collectionViewLayout:flowLayout];
    
    
    
    collectionViee.delegate =self;
    collectionViee.dataSource =self;
    
    [collectionViee registerClass:[GTVideioCoverCell class] forCellWithReuseIdentifier:@"GTVideioCoverCell"];
    [self.view addSubview:collectionViee];
};



- (NSInteger)collectionView:(UICollectionView *)collectionView numberOfItemsInSection:(NSInteger)section {
    return 20;
};


- (__kindof UICollectionViewCell *)collectionView:(UICollectionView *)collectionView cellForItemAtIndexPath:(NSIndexPath *)indexPath{
    // é»˜è®¤çš„å¤§å°æ˜¯50 * 50çš„å¤§å°å“ˆ
    UICollectionViewCell *cell = [collectionView dequeueReusableCellWithReuseIdentifier:@"GTVideioCoverCell" forIndexPath:indexPath];
    cell.backgroundColor = [UIColor systemPinkColor];
    // å¤„ç†ä¸€äº›ç‰¹æ®Šçš„é€»è¾‘
  ++++é‡ç‚¹ä»£ç ï¼
    if([cell isKindOfClass:[GTVideioCoverCell class]]){
        [((GTVideioCoverCell *) cell) layoutWithVideoCoverUrl:@"icon.bundle/cover.png" videoUrl:@"http://vfx.mtime.cn/Video/2019/03/19/mp4/190319222227698228.mp4"];
    }
    return cell;
};


@end
```

> ä»¥ä¸Šå°±æ˜¯ æœ€åŸºç¡€çš„è§†é¢‘åˆ—è¡¨çš„é‡æ„
>



## ç°åœ¨è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå¯ä»¥æ’­æ”¾çš„è§†é¢‘
æˆ‘ä»¬æ¥ä¸‹æ¥è¦åšä¸€ä¸ª ç‚¹å‡»å°±èƒ½è®©è§†é¢‘æ’­æ”¾çš„åŠŸèƒ½ï¼Œæœ€ç»ˆçš„æ•ˆæœå¦‚ä¸‹  
![](https://cdn.nlark.com/yuque/0/2021/png/1627571/1640099406739-4ef9f1c7-f8a6-4fab-afff-355636bb13b2.png)

æˆ‘ä»¬åªéœ€è¦åœ¨ç‚¹å‡»çš„æ—¶å€™ ï¼ŒæŒ‰ç…§ä¸Šé¢çš„æ­¥éª¤ ï¼Œå°±èƒ½åˆ›å»ºä¸€è§†é¢‘æ’­æ”¾åŒºåŸŸ

```objectivec
+++++
#import "GTVideioCoverCell.h"
#import <AVFoundation/AVFoundation.h>  // å¾ˆé‡è¦ï¼è®°å¾—å¯¼å…¥
+++++
# ä¿®æ”¹ä¸€ä¸‹è¿™é‡Œï¼Œè¦ä¸ç„¶æŒ‰é’®å°±å åŠ åˆ°è§†é¢‘layerä¹‹ä¸Š
    if(self){
        [self addSubview:({
            _coverView  = [[UIImageView alloc] initWithFrame:CGRectMake(0, 0, frame.size.width, frame.size.height)];
            _coverView;
        })];
        
      // _coverView ä¸Šå®¶subView
        [_coverView addSubview:({
            _playButton  = [[UIImageView alloc] initWithFrame:CGRectMake((frame.size.width - 50) / 2, (frame.size.width - 50) / 2 , 50, 50)];
        })];
        
        UITapGestureRecognizer *tapGesture = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(_tapClick)];
        [self addGestureRecognizer: tapGesture];
    }
+++++
- (void)_tapClick {
//  ä½¿ç”¨URLç”Ÿäº§ä¸€ä¸ªAsset
    NSURL *videoURL = [NSURL URLWithString:_VideoUrl];
    AVAsset *asset = [AVAsset assetWithURL:videoURL];
    
//  ä½¿ç”¨asset ç”Ÿäº§ä¸€ä¸ªPlayer
    AVPlayer *avPlayer = [AVPlayer playerWithURL:videoURL];
    
//  ç”Ÿæˆä¸€ä¸ªLayerè®¾ç½®å¤§å†™å¹¶ä¸”æ’­æ”¾å®ƒ
    AVPlayerLayer *palyerLayer = [AVPlayerLayer playerLayerWithPlayer:avPlayer];
    palyerLayer.frame = _coverView.bounds;
    [_coverView.layer addSublayer:palyerLayer];
    [avPlayer play];
    
};
```

## è¯•ä¸€ä¸‹å¦‚ä½•åšä¸€ä¸ªæ›´å¤šçš„åŠŸæ¯”å¦‚æš‚åœä»€ä¹ˆçš„
### ç†è®ºçŸ¥è¯†
> åœ¨å›é¡¾ä¸€ä¸‹ OCç±»ä¸ç±»é€šä¿¡æ–¹å¼deleagteï¼ˆä¼ å‡½æ•°å›è°ƒï¼Œåªèƒ½ä¸€å¯¹ä¸€ï¼‰KVOï¼ˆç›‘å¬å€¼å˜åŒ–ï¼Œè§£å†³äº†ä¸€å¯¹ä¸€çš„é—®é¢˜ï¼‰notiifcationiï¼ˆä¸€å¯¹å¤šï¼Œå°±æ˜¯ä¸€ä¸ªå¹¿æ’­äº‹ä»¶ï¼‰
>

![](https://cdn.nlark.com/yuque/0/2021/png/1627571/1640099739808-96e8d7ee-9166-4027-b53b-331b61a4fc99.png)

![](https://cdn.nlark.com/yuque/0/2021/png/1627571/1640099885704-8ad0541a-0880-453b-9d6e-c68cb2708dfe.png)

è¿™ä¸ªä¸œè¥¿å°±æ˜¯ä¸€ä¸ªå‘å¸ƒè®¢é˜…å¾ˆåƒä½†æ˜¯åˆä¸æ˜¯å¾ˆåƒã€‚å¦‚æœä½ æ™“å¾—å‘å¸ƒè®¢é˜…ï¼Œå’Œè§‚å¯Ÿè€…æ¨¡å¼ è¯·çœ‹ä¸‹é¢çš„æ–‡ç« ï¼š[å‘å¸ƒè®¢é˜… / è§‚å¯Ÿè€…æ¨¡å¼](https://zhuanlan.zhihu.com/p/51357583)

### å°è¯•ç‰›åˆ€ Notification
> ä¸‹é¢æˆ‘ä»¬çš„ä»£ç å°†ä¼šç®€å•çš„é€šè¿‡Notifcationi æ¥ç›‘å¬æ’­æ”¾å®Œæˆçš„æ¶ˆæ¯
>

```objectivec
++++
// é€šè¿‡Notificatiion å®ç°ç±»é€šä¿¡
- (instancetype)initWithFrame:(CGRect)frame{
  +++
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(_handlePalyEnd) name:AVPlayerItemDidPlayToEndTimeNotification object:nil];
	+++
++++
// é¦–å…ˆæˆ‘ä»¬éœ€è¦å®šä¹‰  ç»„ä»¶å¸è½½çš„æ—¶å€™å»æ‰notifationå•ä¾‹
#pragma mark - ç»„ä»¶å¸è½½çš„æ—¶å€™å»æ‰notifationå•ä¾‹
-  (void)dealloc {
    [[NSNotificationCenter defaultCenter] removeObserver:self];
};

#pragma mark - private method
- (void)_tapClick {
   // è¿™ä¸ªæ–¹æ³•æ”¹åŠ¨ä¸€ä¸‹ï¼ŒæŠŠæ‰€æœ‰çš„æ•°æ®éƒ½å­˜åˆ°å±æ€§ä¸Šå»
    //  ä½¿ç”¨URLç”Ÿäº§ä¸€ä¸ªAsset
        NSURL *videoURL = [NSURL URLWithString:_VideoUrl];
        AVAsset *asset = [AVAsset assetWithURL:videoURL];
        
    //  ä½¿ç”¨asset ç”Ÿäº§ä¸€ä¸ªPlayer
        _videoItem = [AVPlayerItem playerItemWithAsset:asset];
        _avPlayer = [AVPlayer playerWithPlayerItem:_videoItem];
        
    //  ç”Ÿæˆä¸€ä¸ªLayerè®¾ç½®å¤§å†™å¹¶ä¸”æ’­æ”¾å®ƒ
        _palyerLayer = [AVPlayerLayer playerLayerWithPlayer:_avPlayer];
        _palyerLayer.frame = _coverView.bounds;
        [_coverView.layer addSublayer:_palyerLayer];
        [_avPlayer play];
};

// æ’­æ”¾ç»“æŸçš„æ—¶å€™çš„å›è°ƒå‡½æ•°
- (void) _handlePalyEnd {
    [_palyerLayer removeFromSuperlayer];
    _videoItem = nil;
    _avPlayer = nil;
};
```

### ä½¿ç”¨KVOæ¥ç›‘å¬
> ç°åœ¨æˆ‘ä»¬çš„éœ€æ±‚å¦‚ä¸‹ï¼š ä½¿ç”¨KVOé€šä¿¡æ–¹æ¡ˆï¼Œç›‘å¬è§†é¢‘æ˜¯å¦åŠ è½½å®Œæ¯•ï¼ŒåŠ è½½å®Œä¹‹åå†æ’­æ”¾
>

![](https://cdn.nlark.com/yuque/0/2021/png/1627571/1640180279314-2548d065-dac3-405b-bc42-feabd72b3163.png)

```javascript
#pragma mark - ç»„ä»¶å¸è½½çš„æ—¶å€™å»æ‰notifationå•ä¾‹ å’ŒKVO
-  (void)dealloc {
    [[NSNotificationCenter defaultCenter] removeObserver:self];
    [_videoItem removeObserver:self forKeyPath:@"status"];
};
++++ æ·»åŠ ä¸€ä¸ªKVOç›‘å¬
#pragma mark - private method
- (void)_tapClick {
+++++
    // ä½¿ç”¨KVOäº†æ¥ç›‘å¬è§†é¢‘æ˜¯å¦è¢«åŠ è½½å®Œæ¯• æœ‰æ–°å˜åŒ–çš„æ—¶å€™å¤„ç†
    [_videoItem addObserver:self forKeyPath:@"status" options:NSKeyValueObservingOptionNew context:nil];
        
+++++
};

++++ ç›‘å¬çœ‹çœ‹ æ˜¯å¦stauså˜åŒ–æ¥
-(void) observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary<NSKeyValueChangeKey,id> *)change context:(void *)context {
    if ( [keyPath isEqualToString:@"status"] ) {
        if( ((NSNumber *)[change objectForKey:NSKeyValueChangeNewKey]).integerValue == AVPlayerItemStatusReadyToPlay ) {
            [_avPlayer play];
        }else {
            NSLog(@""); // å¦‚æœå‡ºé”™äº†
        }
    }
};
```

### ç›‘å¬è§†é¢‘ç¼“å†²1
> æˆ‘ä»¬çš„éœ€æ±‚å¦‚ä¸‹ï¼š è·å– æ’­æ”¾è¿›åº¦ï¼Œ å¾—åˆ°æ’­æ”¾å¸§çš„æ§åˆ¶å™¨ï¼Œè·å–ç¼“å†²è¿›åº¦ , ç»“åˆä¹‹å‰çš„æ’­æ”¾ç»“æŸæ—¶é—´åšä¸€ä¸ª æ— é™å¾ªç¯æ’­æ”¾çš„åŠŸèƒ½
>

```javascript
# å¤šåŠ å‡ ä¸ªç›‘å¬ï¼Œç”¨æ¥ç›‘å¬ä¸åŒå±æ€§çš„å˜åŒ–
#pragma mark - private method
- (void)_tapClick {
    //  ä½¿ç”¨URLç”Ÿäº§ä¸€ä¸ªAsset
        NSURL *videoURL = [NSURL URLWithString:_VideoUrl];
        AVAsset *asset = [AVAsset assetWithURL:videoURL];
        
    //  ä½¿ç”¨asset ç”Ÿäº§ä¸€ä¸ªPlayer
        _videoItem = [AVPlayerItem playerItemWithAsset:asset];
        _avPlayer = [AVPlayer playerWithPlayerItem:_videoItem];
    
    // ä½¿ç”¨KVOäº†æ¥ç›‘å¬è§†é¢‘æ˜¯å¦è¢«åŠ è½½å®Œæ¯• æœ‰æ–°å˜åŒ–çš„æ—¶å€™å¤„ç†
    [_videoItem addObserver:self forKeyPath:@"status" options:NSKeyValueObservingOptionNew context:nil];
    // ç›‘å¬æ’­æ”¾è¿›åº¦ï¼Œç¼“å†²è¿›åº¦
    [_videoItem addObserver:self forKeyPath:@"loadedTimeRanges" options:NSKeyValueObservingOptionNew context:nil];
//    CMTime duratino = _videoItem.duration;
//    CGFloat videoDuratio = CMTimeGetSeconds(duratino) // æ³¨æ„å•Šâš ï¸ è¿™ä¸ªä»£ç è¦æ”¾åˆ°è§†é¢‘åŠ è½½å†å»æ‹¿
//    ç›‘å¬ æ’­æ”¾çš„è¿›åº¦ï¼Œè¿™æ ·éœ€è¦è¯´æ˜ä¸€ä¸‹CMTImå°±æ˜¯ä¸€ä¸ªæ—¶é—´åˆ‡ç‰‡æ§åˆ¶ï¼Œæ§åˆ¶å¸§ è¿™é‡Œçš„1/1 å°±ä¸Šä»£è¡¨ 1s 1så›è°ƒä¸€æ¬¡ï¼Œå¹¶ä¸”æŠŠè¿™ä¸ªæ”¾åˆ°ä¸»çº¿ç¨‹ä¸­å» _avPlayer æä¾›æ¥ä¸€ä¸ªç®€å•çš„block æ¥å®ç°è¿™ä¸ªç›‘å¬åŠŸèƒ½
    [_avPlayer addPeriodicTimeObserverForInterval:CMTimeMake(1, 1) queue:dispatch_get_main_queue() usingBlock:^(CMTime time) {
        NSLog(@"æ’­æ”¾è¿›åº¦:%@", @(CMTimeGetSeconds(time)));
    }];
    //  ç”Ÿæˆä¸€ä¸ªLayerè®¾ç½®å¤§å†™å¹¶ä¸”æ’­æ”¾å®ƒ
        _palyerLayer = [AVPlayerLayer playerLayerWithPlayer:_avPlayer];
        _palyerLayer.frame = _coverView.bounds;
        [_coverView.layer addSublayer:_palyerLayer];
        [_avPlayer play];
};
# åˆ«å¿˜è®° ç»„ä»¶ è¦é”€æ¯ç›‘å¬å™¨
#pragma mark - ç»„ä»¶å¸è½½çš„æ—¶å€™å»æ‰notifationå•ä¾‹
-  (void)dealloc {
    [[NSNotificationCenter defaultCenter] removeObserver:self];
    [_videoItem removeObserver:self forKeyPath:@"status"];
    [_videoItem removeObserver:self forKeyPath:@"loadedTimeRanges"];
};

# å¦å¤–ä¹Ÿåˆ«å¿˜è®°äº† ä¸€å®šæ˜¯èµ„æºåŠ è½½å®Œæ‰æœ‰èµ„æºæ•°æ®çš„é—®é¢˜
#pragma mark - KVO
-(void) observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary<NSKeyValueChangeKey,id> *)change context:(void *)context {
    
    if ( [keyPath isEqualToString:@"status"] ) {
        if( ((NSNumber *)[change objectForKey:NSKeyValueChangeNewKey]).integerValue == AVPlayerItemStatusReadyToPlay ) {
            [_avPlayer play];
        }else {
            NSLog(@""); // å¦‚æœå‡ºé”™äº†
        }
        
        CMTime duratino = _videoItem.duration;
        CGFloat videoDuratio = CMTimeGetSeconds(duratino);
        // æ³¨æ„å•Šâš ï¸ è¿™ä¸ªä»£ç è¦æ”¾åˆ°è§†é¢‘åŠ è½½å†å»æ‹¿
    } else if ( [keyPath isEqualToString:@"loadedTimeRanges"]) {
        NSLog(@"ç¼“å†²ï¼š%@",[change objectForKey:NSKeyValueChangeNewKey]);
    }
};

# å¦‚ä½•åšå¾ªç¯æ’­æ”¾ï¼Ÿ
- (void) _handlePalyEnd {
//    [_palyerLayer removeFromSuperlayer];
//    _videoItem = nil;
//    _avPlayer = nil;
//    å¦‚æœè¦åšé‡å¤æ’­æ”¾ å°±æ˜¯æŠŠ_avPlayerçš„CMTime å¸§ç»™é‡ç»„å›0 å°±å¥½äº†
    [_avPlayer seekToTime: CMTimeMake(0, 1)];
};
```





### ç›‘å¬è§†é¢‘ç¼“å†²2
> æˆ‘ä»¬çš„éœ€æ±‚å¦‚ä¸‹ï¼šå•ä¾‹åŒ– ä¸€ä¸‹
>

![](https://cdn.nlark.com/yuque/0/2021/png/1627571/1640182827273-ef8c1c7d-c103-42ee-a177-2a356aa5766e.png)

ç¬¬ä¸€æ­¥ï¼Œæˆ‘ä»¬éœ€è¦æ–°åˆ›ä¸€ä¸ªæ–‡ä»¶ä¸“é—¨ç”¨æ¥æ”¾Video

![](https://cdn.nlark.com/yuque/0/2021/png/1627571/1640266308415-89c30479-9236-4c1c-b239-4568b1665466.png)

ç¬¬äºŒæ­¥ï¼ŒæŠŠä¹‹å‰ä»£ç ä¸­çš„ä¸œè¥¿è¿ç§»å‡º

```objectivec
# .h
//
//  GTVideoPlayer.h
//  SimpelApp
//
//  Created by æä»•å¢ on 2021/12/23.
//

#import <Foundation/Foundation.h>
#import <UIKit/UIKit.h>

NS_ASSUME_NONNULL_BEGIN

@interface GTVideoPlayer : NSObject
+ (GTVideoPlayer *)Player;
- (void) palytVideoByUrl:(NSString *)videoUrl  attachView: (UIView *)attachView;
@end

NS_ASSUME_NONNULL_END


# må®ç°
//
//  GTVideoPlayer.m
//  SimpelApp
//
//  Created by æä»•å¢ on 2021/12/23.
//

#import "GTVideoPlayer.h"
#import <AVFoundation/AVFoundation.h>

@interface GTVideoPlayer()
@property(nonatomic, strong, readwrite) AVPlayerItem *videoItem;
@property(nonatomic, strong, readwrite) AVPlayer *avPlayer;
@property(nonatomic, strong, readwrite) AVPlayerLayer *palyerLayer;
@end

@implementation GTVideoPlayer

// ä½¿ç”¨GCD Distacp ones å®ç°ä¸€ä¸ªå•ä¾‹
+ (GTVideoPlayer *)Player {
    static GTVideoPlayer *player;
    static dispatch_once_t onceToke;
    dispatch_once(&onceToke, ^{
        player = [[GTVideoPlayer alloc] init];
    });
    return  player;
};

- (void) palytVideoByUrl:(NSString *)videoUrl  attachView: (UIView *)attachView {
    [self _stopPalyer];  // æ–°åˆ›å»ºæ’­æ”¾å™¨çš„æ—¶å€™é”€æ¯ä¹‹å‰çš„æ’­æ”¾å™¨
    //  ä½¿ç”¨URLç”Ÿäº§ä¸€ä¸ªAsset
        NSURL *videoURL = [NSURL URLWithString:videoUrl];
        AVAsset *asset = [AVAsset assetWithURL:videoURL];
        
    //  ä½¿ç”¨asset ç”Ÿäº§ä¸€ä¸ªPlayer
        _videoItem = [AVPlayerItem playerItemWithAsset:asset];
        _avPlayer = [AVPlayer playerWithPlayerItem:_videoItem];
    
    // ä½¿ç”¨KVOäº†æ¥ç›‘å¬è§†é¢‘æ˜¯å¦è¢«åŠ è½½å®Œæ¯• æœ‰æ–°å˜åŒ–çš„æ—¶å€™å¤„ç†
    [_videoItem addObserver:self forKeyPath:@"status" options:NSKeyValueObservingOptionNew context:nil];
    // ç›‘å¬æ’­æ”¾è¿›åº¦ï¼Œç¼“å†²è¿›åº¦
    [_videoItem addObserver:self forKeyPath:@"loadedTimeRanges" options:NSKeyValueObservingOptionNew context:nil];
//    CMTime duratino = _videoItem.duration;
//    CGFloat videoDuratio = CMTimeGetSeconds(duratino) // æ³¨æ„å•Šâš ï¸ è¿™ä¸ªä»£ç è¦æ”¾åˆ°è§†é¢‘åŠ è½½å†å»æ‹¿
//    ç›‘å¬ æ’­æ”¾çš„è¿›åº¦ï¼Œè¿™æ ·éœ€è¦è¯´æ˜ä¸€ä¸‹CMTImå°±æ˜¯ä¸€ä¸ªæ—¶é—´åˆ‡ç‰‡æ§åˆ¶ï¼Œæ§åˆ¶å¸§ è¿™é‡Œçš„1/1 å°±ä¸Šä»£è¡¨ 1s 1så›è°ƒä¸€æ¬¡ï¼Œå¹¶ä¸”æŠŠè¿™ä¸ªæ”¾åˆ°ä¸»çº¿ç¨‹ä¸­å» _avPlayer æä¾›æ¥ä¸€ä¸ªç®€å•çš„block æ¥å®ç°è¿™ä¸ªç›‘å¬åŠŸèƒ½
    [_avPlayer addPeriodicTimeObserverForInterval:CMTimeMake(1, 1) queue:dispatch_get_main_queue() usingBlock:^(CMTime time) {
        NSLog(@"æ’­æ”¾è¿›åº¦:%@", @(CMTimeGetSeconds(time)));
    }];
    //  ç”Ÿæˆä¸€ä¸ªLayerè®¾ç½®å¤§å†™å¹¶ä¸”æ’­æ”¾å®ƒ
        _palyerLayer = [AVPlayerLayer playerLayerWithPlayer:_avPlayer];
        _palyerLayer.frame = attachView.bounds;
        [attachView.layer addSublayer:_palyerLayer];
        [_avPlayer play];
    
    // é€šè¿‡Notificatiion å®ç°ç±»é€šä¿¡
    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(_handlePalyEnd) name:AVPlayerItemDidPlayToEndTimeNotification object:nil];
}


#pragma mark - ç»„ä»¶å¸è½½çš„æ—¶å€™å»æ‰notifationå•ä¾‹
-  (void)dealloc {
    [[NSNotificationCenter defaultCenter] removeObserver:self];
    [_videoItem removeObserver:self forKeyPath:@"status"];
    [_videoItem removeObserver:self forKeyPath:@"loadedTimeRanges"];
};

#pragma mark - private method
- (void)_stopPalyer {
        [_palyerLayer removeFromSuperlayer];
        _videoItem = nil;
        _avPlayer = nil;
    
    [_videoItem removeObserver:self forKeyPath:@"status"];
    [_videoItem removeObserver:self forKeyPath:@"loadedTimeRanges"];
    
    [[NSNotificationCenter defaultCenter] removeObserver:self];
};

- (void) _handlePalyEnd {
//    å¦‚æœè¦åšé‡å¤æ’­æ”¾ å°±æ˜¯æŠŠ_avPlayerçš„CMTime å¸§ç»™é‡ç»„å›0 å°±å¥½äº†
    [_avPlayer seekToTime: CMTimeMake(0, 1)];
};

#pragma mark - KVO
-(void) observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary<NSKeyValueChangeKey,id> *)change context:(void *)context {
    
    if ( [keyPath isEqualToString:@"status"] ) {
        if( ((NSNumber *)[change objectForKey:NSKeyValueChangeNewKey]).integerValue == AVPlayerItemStatusReadyToPlay ) {
            [_avPlayer play];
        }else {
            NSLog(@""); // å¦‚æœå‡ºé”™äº†
        }
        
        CMTime duratino = _videoItem.duration;
        CGFloat videoDuratio = CMTimeGetSeconds(duratino);
        // æ³¨æ„å•Šâš ï¸ è¿™ä¸ªä»£ç è¦æ”¾åˆ°è§†é¢‘åŠ è½½å†å»æ‹¿
    } else if ( [keyPath isEqualToString:@"loadedTimeRanges"]) {
        NSLog(@"ç¼“å†²ï¼š%@",[change objectForKey:NSKeyValueChangeNewKey]);
    }
};

@end

```

ç¬¬ä¸‰æ­¥ï¼Œæ¸…ç†ä¹‹å‰çš„è€ä»£ç é€»è¾‘

```objectivec
//
//  GTVideioCoverCell.m
//  SimpelApp
//
//  Created by æä»•å¢ on 2021/12/20.
//

#import "GTVideioCoverCell.h"
#import "GTVideoPlayer.h"

@interface GTVideioCoverCell()
@property(nonatomic, strong, readwrite) UIImageView *coverView;
@property(nonatomic, strong, readwrite) UIImageView *playButton;
@property(nonatomic, strong, readwrite) NSString *VideoUrl;
@end

@implementation GTVideioCoverCell

- (instancetype)initWithFrame:(CGRect)frame{
    self = [super initWithFrame:frame];
    if(self){
        [self addSubview:({
            _coverView  = [[UIImageView alloc] initWithFrame:CGRectMake(0, 0, frame.size.width, frame.size.height)];
            _coverView;
        })];
        
        [_coverView addSubview:({
            _playButton  = [[UIImageView alloc] initWithFrame:CGRectMake((frame.size.width - 50) / 2, (frame.size.height - 50) / 2 , 50, 50)];
        })];
        
        
        UITapGestureRecognizer *tapGesture = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(_tapClick)];
        [self addGestureRecognizer: tapGesture];
    }
    return  self;
};

#pragma mark - ç»„ä»¶å¸è½½çš„æ—¶å€™å»æ‰notifationå•ä¾‹
-  (void)dealloc {
};

#pragma mark - public method
- (void) layoutWithVideoCoverUrl:(NSString *)videoCoverUrl  videoUrl: (NSString *)videoUrl {
    _coverView.image = [UIImage imageNamed:videoCoverUrl];
    _playButton.image = [UIImage imageNamed:@"icon.bundle/palyer-start.png"];
    _VideoUrl = videoUrl;
};

#pragma mark - private method
- (void)_tapClick {
    [[GTVideoPlayer Player] palytVideoByUrl:_VideoUrl attachView:(_coverView)];
};

@end

```

æœ€åï¼šè°ƒè¯•, ä»¥ä¸Šå°±æ˜¯æ‰€æœ‰çš„ä»£ç äº†ï¼

![](https://cdn.nlark.com/yuque/0/2021/png/1627571/1640266416390-27fde71d-2e32-4326-a75e-647d4b21b5a5.png)



### å›é¡¾ä¸€ä¸‹æ•´ä¸ªIOSè®¾å¤‡çš„è§†é¢‘æ’­æ”¾çš„ä¸šåŠ¡é€»è¾‘
> ä¸Šé¢çš„é€»è¾‘å°±æ˜¯çº¯æ‰‹å†™ï¼Œç°åœ¨æˆ‘ä»¬è°ƒç”¨ä¸€ä¸ªç³»ç»Ÿå·²ç»é›†æˆå¥½çš„æ’­æ”¾å™¨ ï¼ˆåŒ…æ‹¬äº†è¿›åº¦æ¡ï¼Œç¼“å†²æ¡ å…¨å±xxxç­‰å¾ˆå¤šåŠŸèƒ½ï¼‰
>

![](https://cdn.nlark.com/yuque/0/2021/png/1627571/1640266568507-cddbc477-e6f6-4d88-a7bb-32e6230a4780.png)

![](https://cdn.nlark.com/yuque/0/2021/png/1627571/1640266593019-fdb87dd4-de13-4825-b9c8-3c8890866273.png)



ä»£ç å®ç°é€»è¾‘å¦‚ä¸‹ï¼šxx

![](https://cdn.nlark.com/yuque/0/2021/png/1627571/1640266663641-28622b8c-c5fb-4d6e-a3a1-7de4faf93a32.png)

![](https://cdn.nlark.com/yuque/0/2021/png/1627571/1640266877530-77bb0481-62e8-41d4-a3d8-9304d440d213.png)

ä¸Šè¿°å°±æ˜¯å¾ˆå¤šå¼€æºçš„è§†é¢‘æ’­æ”¾è§£å†³æ–¹æ¡ˆï¼Œç›®å‰è€æåœ¨Neweggè¿™é‡Œæœ‰ä¸€ä¸ªç›´æ’­Appä½¿ç”¨é˜¿é‡Œäº‘çš„ç›´æ’­æ¨æµSDK åšäº†ä¸€ä¸ªç›´æ’­çš„App ä¹Ÿæ˜¯è¿™æ ·çš„å®ç°çš„ã€‚æ„Ÿå…´è¶£ä¸‹æ¥å¯ä»¥ç ”ç©¶ä¸€ä¸‹ï¼Œï¼ˆç­‰å¾…åŠ å…¥çš„è¿æ¥ğŸ”—æœ‰æ—¶é—´ç ”ç©¶ä¸€ä¸‹ è¿™ä¸ªæ’­æ”¾çœ‹çœ‹å¦‚ä½•åšï¼‰

# IOSä¸­çš„å¸ƒå±€AutoLayout
## ç®€ä»‹å’Œç†è®ºçŸ¥è¯†
> æˆ‘ä»¬ä¹‹å‰å†™çš„å¸ƒå±€éƒ½æ˜¯å®šé«˜å®šæ¡† å’Œå®šXYåæ ‡å®ç°çš„å¸ƒå±€ï¼ˆFrameï¼‰
>

![](https://cdn.nlark.com/yuque/0/2021/png/1627571/1640267240972-59d715c2-1c09-42c6-969c-4e802e99a70e.png)

> autoLayouterå°±æ˜¯è¿™æ ·çš„ä¸€ä¸ªè‡ªé€‚åº”çš„å¸ƒå±€
>

![](https://cdn.nlark.com/yuque/0/2021/png/1627571/1640267341420-88da8fa5-bb2f-46b7-a77d-912b08ae3199.png)

> AutoLayoueå®é™…ä¸Šå°±æ˜¯åŠ â€œçº¦æŸâ€ æ¥å®ç°ä¸€ä¸ªè‡ªåŠ¨è®¡ç®— frame
>
> ![](https://cdn.nlark.com/yuque/0/2021/png/1627571/1640267542534-27a3aab2-dfee-49b8-836f-2356416fe301.png)
>
> ä¸Šé¢çš„è¿™ä¸ªä¸œè¥¿å°±æ˜¯ä¸€ä¸ª ä½¿ç”¨é¢„
>

ä¸Šé¢çš„æè¿°å®åœ¨æ˜¯å¤ªå¤æ‚äº†ï¼Œå› æ­¤æˆ‘éœ€è¦ä½¿ç”¨ä¸€ä¸ªæ–°çš„è§£å†³æ–¹æ¡ˆæ¥ç®€åŒ– å¸ƒå±€å¼€å‘



![](https://cdn.nlark.com/yuque/0/2021/png/1627571/1640267813220-1d463e7c-13ea-4d5c-bcfa-8e9343c7dde7.png)

## ä½¿ç”¨
> æˆ‘ä»¬å‰é¢çš„å·²ç»æŠŠç†è®ºçŸ¥è¯†è¯´çš„å·®ä¸å¤šäº†ï¼Œç°åœ¨æˆ‘ä»¬å®ç°ä¸€ä¸ªğŸ˜‚
>

æˆ‘ä»¬éœ€è¦è¾¾åˆ°è¿™æ ·çš„æ•ˆæœ

![](https://cdn.nlark.com/yuque/0/2021/png/1627571/1640275663939-6b454fb0-644a-439a-9367-21bb48f807bc.png)

![](https://cdn.nlark.com/yuque/0/2021/png/1627571/1640268054621-6f8a9fc0-2b4f-4e2d-a071-6c59aee1f797.png)

ç¬¬ä¸€æ­¥è¦æ–°æ¥ä¸€ä¸ªtoobarç»„ä»¶

```javascript

//
//  GTVideoToobar.h
//  SimpelApp
//
//  Created by æä»•å¢ on 2021/12/23.
//

#import <UIKit/UIKit.h>

NS_ASSUME_NONNULL_BEGIN

// å®šä¹‰ä¸€ä¸ªé«˜åº¦
#define GTVideoToobarHeight 60
@interface GTVideoToobar : UIView
- (void)layoutWithModel:(id)modle;
@end

NS_ASSUME_NONNULL_END



//
//  GTVideoToobar.m
//  SimpelApp
//
//  Created by æä»•å¢ on 2021/12/23.
//

#import "GTVideoToobar.h"

@interface GTVideoToobar()
@property(nonatomic, strong, readwrite) UIImageView *avatorImageView;
@property(nonatomic, strong, readwrite) UILabel *nickLable;

@property(nonatomic, strong, readwrite) UIImageView *commonImgaeView;
@property(nonatomic, strong, readwrite) UILabel *commonLable;

@property(nonatomic, strong, readwrite) UIImageView *linkImagView;
@property(nonatomic, strong, readwrite) UILabel *linkLable;

@property(nonatomic, strong, readwrite) UIImageView *shareImageView;
@property(nonatomic, strong, readwrite) UILabel *shareLable;

@end

@implementation GTVideoToobar
- (instancetype)initWithFrame:(CGRect)frame{
    self = [super initWithFrame:frame];
    if ( self ) {
        self.backgroundColor = [UIColor whiteColor];
        
        [self addSubview: ({
            _avatorImageView = [[UIImageView alloc] initWithFrame:CGRectZero];
            _avatorImageView.layer.masksToBounds = YES;
            _avatorImageView.layer.cornerRadius = 15;
            _avatorImageView.translatesAutoresizingMaskIntoConstraints = NO;
            _avatorImageView;
        })];
        [self addSubview: ({
            _nickLable = [[UILabel alloc] init];
            _nickLable.font = [UIFont systemFontOfSize:15 ];
            _nickLable.textColor = [UIColor lightGrayColor];
            _nickLable.translatesAutoresizingMaskIntoConstraints = NO;
            _nickLable;
        })];
        
        [self addSubview: ({
            _commonImgaeView = [[UIImageView alloc] initWithFrame:CGRectZero];
            _commonImgaeView.layer.masksToBounds = YES;
            _commonImgaeView.layer.cornerRadius = 15;
            _commonImgaeView.translatesAutoresizingMaskIntoConstraints = NO;
            _commonImgaeView;
        })];
        [self addSubview: ({
            _commonLable = [[UILabel alloc] init];
            _commonLable.font = [UIFont systemFontOfSize:15 ];
            _commonLable.textColor = [UIColor lightGrayColor];
            _commonLable.translatesAutoresizingMaskIntoConstraints = NO;
            _commonLable;
        })];
        
        [self addSubview: ({
            _linkImagView = [[UIImageView alloc] initWithFrame:CGRectZero];
            _linkImagView.layer.masksToBounds = YES;
            _linkImagView.layer.cornerRadius = 15;
            _linkImagView.translatesAutoresizingMaskIntoConstraints = NO;
            _linkImagView;
        })];
        [self addSubview: ({
            _linkLable = [[UILabel alloc] init];
            _linkLable.font = [UIFont systemFontOfSize:15 ];
            _linkLable.textColor = [UIColor lightGrayColor];
            _linkLable.translatesAutoresizingMaskIntoConstraints = NO;
            _linkLable;
        })];
        
        [self addSubview: ({
            _shareImageView = [[UIImageView alloc] initWithFrame:CGRectZero];
            _shareImageView.layer.masksToBounds = YES;
            _shareImageView.layer.cornerRadius = 15;
            _shareImageView.translatesAutoresizingMaskIntoConstraints = NO;
            _shareImageView;
        })];
        [self addSubview: ({
            _shareLable = [[UILabel alloc] init];
            _shareLable.font = [UIFont systemFontOfSize:15 ];
            _shareLable.textColor = [UIColor lightGrayColor];
            _shareLable.translatesAutoresizingMaskIntoConstraints = NO;
            _shareLable;
        })];
    };
    return  self;
};

// è®¾è®¡ä¸€ä¸ªåˆå§‹åŒ–çš„æ–¹æ³•
- (void)layoutWithModel:(id)modle {
	
}

@end

```

ç¬¬äºŒæ­¥ æŠŠtoobar è´´åˆ°åˆé€‚çš„ä½ç½®ï¼Œå¹¶ä¸”ä¿®æ”¹åŸæ¥çš„å±æ€§

```javascript
//  GTVideioCoverCell.m
//  SimpelApp
//
//  Created by æä»•å¢ on 2021/12/20.
//

#import "GTVideioCoverCell.h"
#import "GTVideoPlayer.h"
#import "GTVideoToobar.h"
++++
# initWithFrameï¼›é‡Œè¿½åŠ ä¸€ä¸ª
  [_coverView addSubview:({
            _playButton  = [[UIImageView alloc] initWithFrame:CGRectMake((frame.size.width - 50) / 2, (frame.size.height -
                                                                                                       GTVideoToobarHeight - 
                                                                                                       50) / 2 , 50, 50)];
        })];
++++
#pragma mark - public method
- (void) layoutWithVideoCoverUrl:(NSString *)videoCoverUrl  videoUrl: (NSString *)videoUrl {
    _coverView.image = [UIImage imageNamed:videoCoverUrl];
    _playButton.image = [UIImage imageNamed:@"icon.bundle/palyer-start.png"];
    _VideoUrl = videoUrl;
    [_toobar layoutWithModel:nil];
};
++++


//
//  CGVideoViewController.m
//  SimpelApp
//
//  Created by æä»•å¢ on 2021/10/22.
//

- (void)viewDidLoad {
    [super viewDidLoad];
++++
++++
 // åšä¸€ä¸ª16 * 9  View
    flowLayout.itemSize = CGSizeMake( self.view.bounds.size.width,  self.view.bounds.size.width /16 * 9 + GTVideoToobarHeight );
++++
}
    
```

ç¬¬ä¸‰æ­¥ ä¿®æ”¹å¸ƒå±€æ–¹å¼

```javascript
- (void)layoutWithModel:(id)modle {
    _avatorImageView.image = [UIImage imageNamed:@"icon.bundle/CustomerActive.png"];
    _nickLable.text = @"åŒ—å²›é¡¹ç›®ç»„";
    
    _commonImgaeView.image = [UIImage imageNamed:@"icon.bundle/palyer-start.png"];
    _commonLable.text = @"è¯„è®º";

    _linkImagView.image = [UIImage imageNamed:@"icon.bundle/palyer-start.png"];
    _linkLable.text = @"ç‚¹èµ";

    _shareImageView.image = [UIImage imageNamed:@"icon.bundle/palyer-start.png"];
    _shareLable.text = @"åˆ†äº«";
    

    
    [NSLayoutConstraint activateConstraints:@[

             [NSLayoutConstraint constraintWithItem:_avatorImageView
                                          attribute:NSLayoutAttributeCenterY  // xxx å¯¹è±¡ çš„xxxå±æ€§  ã€æ¡ä»¶ã€‘ ç›¸å¯¹äºçš„xxxå¯¹è±¡ çš„xxxå±æ€§ çš„å€æ•° åŠ ä¸Šé¢å¤–çš„å€¼
                                          relatedBy:NSLayoutRelationEqual
                                             toItem:self
                                          attribute:NSLayoutAttributeCenterY
                                         multiplier:1
                                           constant:0],

             [NSLayoutConstraint constraintWithItem:_avatorImageView
                                          attribute:NSLayoutAttributeLeft
                                          relatedBy:NSLayoutRelationEqual
                                             toItem:self
                                          attribute:NSLayoutAttributeLeft
                                         multiplier:1
                                           constant:15],

             [NSLayoutConstraint constraintWithItem:_avatorImageView
                                          attribute:NSLayoutAttributeWidth
                                          relatedBy:NSLayoutRelationEqual
                                             toItem:nil
                                          attribute:NSLayoutAttributeNotAnAttribute // ä¸ºç©ºçš„æ—¶å€™ç”¨è¿™ä¸ª
                                         multiplier:1
                                           constant:30],

             [NSLayoutConstraint constraintWithItem:_avatorImageView
                                          attribute:NSLayoutAttributeHeight
                                          relatedBy:NSLayoutRelationEqual
                                             toItem:nil
                                          attribute:NSLayoutAttributeNotAnAttribute
                                         multiplier:1
                                           constant:30],

             [NSLayoutConstraint constraintWithItem:_nickLable
                                          attribute:NSLayoutAttributeCenterY
                                          relatedBy:NSLayoutRelationEqual
                                             toItem:_avatorImageView
                                          attribute:NSLayoutAttributeCenterY
                                         multiplier:1
                                           constant:0],

             [NSLayoutConstraint constraintWithItem:_nickLable
                                          attribute:NSLayoutAttributeLeft
                                          relatedBy:NSLayoutRelationEqual
                                             toItem:_avatorImageView
                                          attribute:NSLayoutAttributeRight
                                         multiplier:1
                                           constant:0],
        ]];

  // ä¸‹é¢çš„å°±æ˜¯å»ºè®®çš„ç®—æ³•

    NSString *vflString = @"H:|-15-[_avatorImageView]-0-[_nickLable]-(>=0)-[_commonImgaeView(==_avatorImageView)]-0-[_commonLable]-15-[_linkImagView(==_avatorImageView)]-0-[_linkLable]-15-[_shareImageView(==_avatorImageView)]-0-[_shareLable]-15-|";

      [NSLayoutConstraint activateConstraints:[NSLayoutConstraint constraintsWithVisualFormat:vflString options:NSLayoutFormatAlignAllCenterY metrics:nil views:NSDictionaryOfVariableBindings(_avatorImageView, _nickLable, _commonImgaeView, _commonLable, _linkImagView, _linkLable, _shareImageView, _shareLable)]];
}
```



## IOSä¸­å¸ƒå±€æ–¹å¼çš„é€‰æ‹©
> æˆ‘ä»¬æ¥çœ‹çœ‹ç¤¾åŒºçš„å¼€æºå®ç°
>

![](https://cdn.nlark.com/yuque/0/2022/png/1627571/1641473475363-64053f65-f791-4111-90a1-f85b09fc61a8.png)æˆ‘ä»¬ç°åœ¨çš„å¸ƒå±€è¿˜æ˜¯å¤ªéº»çƒ¦äº†ï¼Œä¸Šé¢å°±æ˜¯ç¤¾åŒºçš„å¼€æºæ¡†æ¶

å®é™…ä¸Šæˆ‘ä»¬åœ¨xcodeä¸­å¯ä»¥ä½¿ç”¨å¯è§†åŒ–çš„æ–¹å¼å»æå¸ƒå±€ï¼ˆä¸»è¦æ˜¯å›¢é˜Ÿåˆä½œä¸ä¼šç”¨ï¼Œå› ä¸ºç¼ºç‚¹æ¯”è¾ƒå¤š æ²¡æœ‰ä»£ç æ›´æ”¹ æ²¡æœ‰å¯ç”¨çš„é€»è¾‘ç­‰ã€‚ã€‚ã€‚ï¼‰

![](https://cdn.nlark.com/yuque/0/2022/png/1627571/1641473692965-f21931f0-4bac-4c20-b757-706f2da47905.png)

# IOSé€‚é…é—®é¢˜
> åœ¨æ—©æœŸ æ˜¯ä¸éœ€è¦è€ƒè™‘IOSé€‚é…ç­‰ï¼Œæ•´ä½“å°±æ˜¯ä¸‹é¢ä¸‰ä¸ªç»´åº¦ æ¥åšé€‚é…
>

![](https://cdn.nlark.com/yuque/0/2022/png/1627571/1641473834408-6076281b-15de-4538-a989-72bc75725a56.png)

## é€»è¾‘åˆ†è¾¨ç‡
### ç†è®ºçŸ¥è¯†
![](https://cdn.nlark.com/yuque/0/2022/png/1627571/1641473943625-5499fceb-600d-477c-8907-e1dbc87d9f4b.png)

é€»è¾‘åˆ†è¾¨ç‡éƒ½æ˜¯ä¸€ä¸ªç›´è§‚çš„å¤§å°ï¼Œæˆ‘ä»¬å¹³æ—¶å†™çš„æ—¶å€™ä¹Ÿæ˜¯ é€»è¾‘åˆ†è¾¨ç‡ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸‹é¢çš„ğŸ‘‡çš„ç³»ç»ŸAPI æ¥åšæ­¤åŠŸèƒ½

![](https://cdn.nlark.com/yuque/0/2022/png/1627571/1641474142159-3b8b6318-9cd3-4e31-ad8f-00cbaeaaf3bd.png)

UIScreenååº”çš„å±å¹•çš„æ¶ˆæ¯ï¼ŒDevice æ˜¯è®¾å¤‡çš„ä¿¡æ¯

å¯¹äºé€‚é… æœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯ ä»¥ æŸä¸ªæœºå‹ åšæ ‡å‡†ï¼Œç„¶åå…¶ä»–çš„æœºå‹ ä½¿ç”¨ UIScreen è·å–è®¾å¤‡çš„å±å¹•ä¿¡æ¯ï¼Œç„¶å*ä¸€ä¸ªç³»æ•°å°±å¥½äº†



### ä»£ç å®è·µ
> æˆ‘ä»¬å°±ç®€å•çš„ä½¿ç”¨ ä¸€ä¸ªç±» å»å†™å‡ ä¸ª è®¡ç®—æ¯”ä¾‹çš„ å‡½æ•°å°±å¥½äº†
>

æ–°å»ºä¸€ä¸ªUIView å«åš Screen é›†æˆè‡ªNSObject

```objectivec
//
//  GTScreen.h
//  SimpelApp
//
//  Created by æä»•å¢ on 2022/1/6.
//

#import <UIKit/UIKit.h>

NS_ASSUME_NONNULL_BEGIN

// ä½¿ç”¨ä¸¤ä¸ªå® 1.æ˜¯å¦æ˜¯æ¨ªå‘å±å¹• 2. å®šä¹‰å±å¹•çš„å®½åº¦ 3. å®šä¹‰å±å¹•çš„é«˜åº¦ ï¼ˆéƒ½éœ€è¦æ³¨æ„å±å¹•æ¨ªå‘é—®é¢˜ï¼‰
#define IS_LANDSCAPE (UIInterfaceOrientationIsLandscape([ [UIApplication sharedApplication] statusBarOrientation  ]))

#define SCREEN_WIDTH (IS_LANDSCAPE ? [[UIScreen mainScreen] bounds].size.height :  [[UIScreen mainScreen] bounds].size.width )
#define SCREEN_HEIGHT (IS_LANDSCAPE ? [[UIScreen mainScreen] bounds].size.width :  [[UIScreen mainScreen] bounds].size.height )

//æˆ‘ä»¬åœ¨å®šä¹‰ä¸¤ä¸ªå‡½æ•°çš„åˆ«å ï¼ˆåˆæ˜¯ä¸¤ä¸ªå®ï¼‰
#define UI(x) UIAdapter(x)
#define UIRect(x,y,width,height) UIRectAdapter(x,y,width,height)

// å®šä¹‰ä¸€ä¸ªå†…è”å‡½æ•° ç”¨äºæŒ‰ç…§æ¯”ä¾‹çš„è¿›è¡Œç¼©æ”¾æ“ä½œ
static inline NSInteger UIAdapter (float x) {
//    1. åˆ†æœºå‹
//    2. æŒ‰å±å¹•æ¯”ä¾‹å»åšé€‚é…
    CGFloat scale = 414 / SCREEN_WIDTH;
    return (NSInteger) x / scale;
};

// å¯¹ä¸€äº›å¸ƒå±€çš„é€‚é…æ¯”å¦‚ å››è¾¹çš„é…ç½®
static inline CGRect UIRectAdapter(x,y,width,height) {
    return  CGRectMake(UIAdapter(x), UIAdapter(y), UIAdapter(width), UIAdapter(height));
};

@interface GTScreen : NSObject

@end

NS_ASSUME_NONNULL_END


# ====== .mæ²¡æœ‰åšä»»ä½•é€»è¾‘çš„å¤„ç†

# æ‰¾æˆ‘ä»¬ä¹‹å‰çš„æ–°é—»åˆ—è¡¨çš„ cell è¯•è¯•çœ‹ ä¸»è¦æ˜¯æŠŠå®éƒ½ç»™å¥—ä¸Šå°±å¥½äº†
//
//  CGPtTableViewCell.m
//  SimpelApp
//
//  Created by æä»•å¢ on 2021/10/23.
//

#import "CGPtTableViewCell.h"
#import "GTLIstItem.h"
#import "SDWebImage.h"
#import "GTScreen.h"

@interface CGPtTableViewCell ()

@property(nonatomic, strong, readwrite) UILabel *titleLabel;
@property(nonatomic, strong, readwrite) UILabel *sourceLabel;
@property(nonatomic, strong, readwrite) UILabel *commentLabel;
@property(nonatomic, strong, readwrite) UILabel *timeLabel;
@property(nonatomic, strong, readwrite) UIImageView *rightImageView;
@property(nonatomic, strong, readwrite) UIButton *myButton;

@end

@implementation CGPtTableViewCell

- (instancetype) initWithStyle:(UITableViewCellStyle)style reuseIdentifier:(nullable NSString *)reuseIdentifier {
    
    self=[super initWithStyle:style reuseIdentifier:reuseIdentifier];
    
    if(self){
        // åˆ›å»ºè‡ªå·±çš„cell
        [self.contentView addSubview:({
            self.titleLabel = [[UILabel alloc] initWithFrame:UIRect( 20, 15, 250, 50)];
//            self.titleLabel.backgroundColor = [UIColor redColor];
            self.titleLabel.font = [UIFont systemFontOfSize:16];
            self.titleLabel.textColor = [UIColor blackColor];
            self.titleLabel;
        })];
        
        [self.contentView addSubview:({
            self.sourceLabel = [[UILabel alloc] initWithFrame:UIRect(20, 80, 50, 20)];
//            self.sourceLabel.backgroundColor = [UIColor redColor];
            self.sourceLabel.font = [UIFont systemFontOfSize:12];
            self.sourceLabel.textColor = [UIColor grayColor];
            self.sourceLabel;
        })];
        
        [self.contentView addSubview:({
            self.commentLabel = [[UILabel alloc] initWithFrame:UIRect(100, 80, 50, 20)];
//            self.commentLabel.backgroundColor = [UIColor redColor];
            self.commentLabel.font = [UIFont systemFontOfSize:12];
            self.commentLabel.textColor = [UIColor grayColor];
            self.commentLabel;
        })];
        
        [self.contentView addSubview:({
            self.timeLabel = [[UILabel alloc] initWithFrame:UIRect(150, 80, 50, 20)];
//            self.timeLabel.backgroundColor = [UIColor redColor];
            self.timeLabel.font = [UIFont systemFontOfSize:12];
            self.timeLabel.textColor = [UIColor grayColor];
            self.timeLabel;
        })];
        
//        è¿™é‡Œæˆ‘ä»¬æ¥åŠ ä¸€ä¸ªUIImageVIew
        [self.contentView addSubview:({
            self.rightImageView = [[UIImageView alloc] initWithFrame:UIRect(260, 25, 100, 60)];
            self.rightImageView.backgroundColor = [UIColor redColor];
//          å…ˆç»™ä¸€ä¸ªå›¾ç‰‡çš„è‡ªé€‚åº”æ¨¡å¼
            self.rightImageView.contentMode =UIViewContentModeScaleAspectFit;
            self.rightImageView;
        })];

//        è¿™é‡Œæˆ‘ä»¬æ¥åŠ ä¸€ä¸ªUIButton
        [self.contentView addSubview:({
            self.myButton = [[UIButton alloc] initWithFrame:UIRect(260, 35, 30, 30)];
            [self.myButton setTitle:@"X" forState:UIControlStateNormal];
            [self.myButton setTitle:@"V" forState:UIControlStateHighlighted];
            self.myButton.backgroundColor = [UIColor systemBlueColor];
//            æ·»åŠ ä¸€ä¸ªäº‹ä»¶
            [self.myButton addTarget:self action:@selector(myButtonClick) forControlEvents:UIControlEventTouchUpInside];
            
//            æ·»åŠ åœ†è§’
            self.myButton.layer.cornerRadius = UI(10) ;
            self.myButton.layer.masksToBounds = YES ;
            self.myButton.layer.borderColor = [UIColor lightGrayColor ].CGColor;
            self.myButton.layer.borderWidth = UI(2);
            self.myButton;
        })];
        
        
    }
    return  self;
}

@end

```



## ç‰©ç†åˆ†è¾¨ç‡
> æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•åšç‰©ç†åˆ†è¾¨ç‡çš„é€‚é…
>

![](https://cdn.nlark.com/yuque/0/2022/png/1627571/1641476235637-a624762b-76c9-41af-a09c-3a66a3c76639.png)

å®é™…ä¸Šç‰©ç†åˆ†è¾¨ç‡ ä¸»è¦æ˜¯ç”¨åœ¨ç‰©ç†åˆ†è¾¨ç‡ä¸Šå°±æ˜¯å€å›¾( å‰ç«¯çŸ¥è¯† è¿™é‡Œå°±ä¸è¿‡å¤šè®²è§£äº† )ï¼Œå¯¹äºå¸ƒå±€æˆ‘ä»¬è¿˜æ˜¯ä½¿ç”¨é€»è¾‘åˆ†è¾¨ç‡ ï¼Œç‰©ç†åˆ†è¾¨ç‡çš„é€‚é…åº•å±‚å°±æ˜¯å¯¹è±¡ç´ çš„é€‚é…

![](https://cdn.nlark.com/yuque/0/2022/png/1627571/1641478801817-96c893b6-1cf6-4805-a5e8-809124b040fe.png)

> å®é™…ä¸Š ä½¿ç”¨ä»£ç çš„çš„æ–¹å¼ä½ å°±éœ€è¦æ˜ç¡®@2ximg.pngä»€ä¹ˆçš„ï¼Œæ‰èƒ½æ­£ç¡®çš„å±•ç¤º ï¼Œé‚£ä¹ˆæœ‰æ²¡æœ‰æ›´å¥½çš„å®ç°æ–¹å¼å‘¢ ImagerAsset å°±æ˜¯ä¸€ç§è§£å†³æ–¹æ¡ˆ
>

## ä½¿ç”¨ImagerAssetåšé€‚é…
> æˆ‘ä»¬ä¹‹å‰çš„å›¾ç‰‡éƒ½æ”¾åˆ°äº†bundleä¸­ ï¼ˆå®é™…ä¸Šå®ƒå°± æ˜¯ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼‰ã€‚å¦‚æœéœ€è¦è‡ªåŠ¨åŒ–é€‚é…çš„è¯ åœ¨xcoodeä¸­ä¹‹éœ€è¦æ”¾åˆ°ImageAssetå°±å¥½äº†ï¼Œç³»ç»Ÿåœ¨ç¼–è¯‘æ—¶æœŸå°±èƒ½å®ç°è‡ªåŠ¨ä¼˜åŒ–
>

![](https://cdn.nlark.com/yuque/0/2022/png/1627571/1641479283890-36ff02df-bf9c-4238-a3ee-5e6ec775c7c5.png)

å®è·µæŒ‡å—

![](https://cdn.nlark.com/yuque/0/2022/png/1627571/1641479642509-7330486c-ee54-4fcc-8d91-51604aab66ce.png)

![](https://cdn.nlark.com/yuque/0/2022/png/1627571/1641479741708-94a255b0-493e-415b-8c3f-18c3e6cda1e2.png)

æ‹–å…¥å›¾ç‰‡å°±å¥½äº†

ç”¨çš„æ—¶å€™åªéœ€è¦å†™åå­—å°±å¥½äº†ç³»ç»Ÿä¼šè‡ªåŠ¨çš„ä¼˜åŒ–å’Œé€‰æ‹©

```objectivec
self.tabBarItem.image = [UIImage imageNamed:@"testImg"]; // è¿™æ ·å°±è¶³å¤Ÿäº†
```

171614 3665

## ä½¿ç”¨Iphonexåšé€‚é…
> è¿™é‡Œä¸»è¦æŒ‡çš„æ˜¯ æ‹¥æœ‰åˆ˜æµ·å±å¹•å’Œä¸‹å·´çš„æœºå‹
>

### ç†è®ºçŸ¥è¯†
![](https://cdn.nlark.com/yuque/0/2022/png/1627571/1641479897565-ab92387b-9137-43c3-8ff9-3513514b02d4.png)



ä¸»è¦å®ç°å°±æ˜¯ â€œè®©å‡ºè·ç¦»â€

![](https://cdn.nlark.com/yuque/0/2022/png/1627571/1641480034458-84a926d7-50ac-4bc1-a474-33ac2ba412e0.png)

æˆ‘ä»¬å¦‚æœä½¿ç”¨frmeå¸ƒå±€å°±æ¯”è¾ƒå¥½åš ï¼Œå¦‚æœå…¶ä»–å¸ƒå±€å°±éœ€è¦å¦å¤–çš„æ–¹æ¡ˆ autuLayoutä¹Ÿæœ‰æ–¹æ¡ˆï¼Œä¸Šé¢éƒ½å·²ç»ç»™å‡ºäº†  
 å…³äºå¦‚ä½•è®¾ç½® è·ç¦» å°±æ˜¯ä½¿ç”¨ç³»ç»Ÿæä¾›çš„ å®

### å®è·µæŒ‡å—
```objectivec
//
//  GTScreen.h
//  SimpelApp
//
//  Created by æä»•å¢ on 2022/1/6.
//

#import <UIKit/UIKit.h>

NS_ASSUME_NONNULL_BEGIN

// ä½¿ç”¨ä¸¤ä¸ªå® 1.æ˜¯å¦æ˜¯æ¨ªå‘å±å¹• 2. å®šä¹‰å±å¹•çš„å®½åº¦ 3. å®šä¹‰å±å¹•çš„é«˜åº¦ ï¼ˆéƒ½éœ€è¦æ³¨æ„å±å¹•æ¨ªå‘é—®é¢˜ï¼‰
#define IS_LANDSCAPE (UIInterfaceOrientationIsLandscape([ [UIApplication sharedApplication] statusBarOrientation  ]))

#define SCREEN_WIDTH (IS_LANDSCAPE ? [[UIScreen mainScreen] bounds].size.height :  [[UIScreen mainScreen] bounds].size.width )
#define SCREEN_HEIGHT (IS_LANDSCAPE ? [[UIScreen mainScreen] bounds].size.width :  [[UIScreen mainScreen] bounds].size.height )

//æˆ‘ä»¬åœ¨å®šä¹‰ä¸¤ä¸ªå‡½æ•°çš„åˆ«å ï¼ˆåˆæ˜¯ä¸¤ä¸ªå®ï¼‰
#define UI(x) UIAdapter(x)
#define UIRect(x,y,width,height) UIRectAdapter(x,y,width,height)

// å® æ‰‹å†™åˆ¤æ–­æœºå‹ å®é™…ä¸Š æ˜¯å“ŸUIDeivecä¹Ÿå¾ˆé¦™å•Šï¼ ä¸‹é¢çš„å…¨å±€éƒ½ä¸ç‰¹æ®Šå±å¹•çš„é€‚é…
#define IS_IPHONE_X_XR_MAX (IS_IPHONE_X || IS_IPHONE_XR || IS_IPHONE_XMAX)
#define IS_IPHONE_X (SCREEN_WIDTH  == [GTScreen sizeFor58Inch].width && SCREEN_HEIGHT  == [GTScreen sizeFor58Inch].height)
#define IS_IPHONE_XR (SCREEN_WIDTH  == [GTScreen sizeFor61Inch].width && SCREEN_HEIGHT  == [GTScreen sizeFor61Inch].height &&  [UIScreen mainScreen].scale == 2)
#define IS_IPHONE_XMAX (SCREEN_WIDTH  == [GTScreen sizeFor65Inch].width && SCREEN_HEIGHT  == [GTScreen sizeFor65Inch].height &&   [UIScreen mainScreen].scale == 3)

//44å’Œ20 å°±æ˜¯ x xr max çš„ä¸åŒçš„bar é«˜åº¦
#define STATUSBARHEIGHT (IS_IPHONE_X_XR_MAX ? 46 :20)

// å®šä¹‰ä¸€ä¸ªå†…è”å‡½æ•° ç”¨äºæŒ‰ç…§æ¯”ä¾‹çš„è¿›è¡Œç¼©æ”¾æ“ä½œ
static inline NSInteger UIAdapter (float x) {
//    1. åˆ†æœºå‹
//    2. æŒ‰å±å¹•æ¯”ä¾‹å»åšé€‚é…
    CGFloat scale = 414 / SCREEN_WIDTH;
    return (NSInteger) x / scale;
};

// å¯¹ä¸€äº›å¸ƒå±€çš„é€‚é…æ¯”å¦‚ å››è¾¹çš„é…ç½®
static inline CGRect UIRectAdapter(x,y,width,height) {
    return  CGRectMake(UIAdapter(x), UIAdapter(y), UIAdapter(width), UIAdapter(height));
};


@interface GTScreen : NSObject
+(CGSize) sizeFor65Inch;
+(CGSize) sizeFor61Inch; // æ³¨æ„âš ï¸XR å’ŒX å¤§å°ä¸€æ ·ä½†æ˜¯å±å¹•åˆ†è¾¨ç‡ä¸ä¸€æ ·
+(CGSize) sizeFor58Inch;
@end

NS_ASSUME_NONNULL_END


# .m
//
//  GTScreen.m
//  SimpelApp
//
//  Created by æä»•å¢ on 2022/1/6.
//

#import "GTScreen.h"

@implementation GTScreen

// ç›´æ¥ä½¿ç”¨ç±»æ–¹æ³• å»æ åˆ˜æµ·å±é€‚é… ä½†æ˜¯ä¹Ÿè¦é›†åˆå® å› ä¸ºæ˜¯å…¨å±€ç”¨ å“ˆå“ˆ
//iphone xs max
+(CGSize) sizeFor65Inch {
    return CGSizeMake(414, 896);
};

//iphone xr
+(CGSize) sizeFor61Inch {
    return CGSizeMake(414, 896);
};

//iphonex
+(CGSize) sizeFor58Inch {
    return CGSizeMake(375, 812);
};

//æ›´å¤š
@end


# æˆ‘ä»¬ä¹‹å‰çš„webView å»æ”¹ä¸€ä¸‹
#pragma DidLoad
- (void)viewDidLoad {
    [super viewDidLoad];
    
//    è®¾ç½®ä¸€ä¸ªWKWebView
    [self.view addSubview:({
        self.webView = [[WKWebView alloc] initWithFrame:CGRectMake(0,STATUSBARHEIGHT + 44, self.view.frame.size.width, self.view.frame.size.height - STATUSBARHEIGHT -44 )];
        self.webView;
    })];

//    è®¾ç½®å®ƒçš„delegate
    self.webView.navigationDelegate = self;
    
//    ç»™å®šä¸€ä¸ªç½‘é¡µå»åŠ è½½å®ƒ
    
    [self.webView loadRequest:[NSURLRequest requestWithURL:[NSURL URLWithString:self.articleUrl]]];
    
//    æä¸Šä¸€ä¸ªKVOè§‚å¯Ÿè€…æ¨¡å¼ 1. æ³¨å†Œ ç›‘å¬æŸäº›å±æ€§çš„å˜åŒ–ï¼Œæ¯”å¦‚è¿™é‡Œç›‘å¬çš„æ˜¯estimatedProgresså˜åŒ–æ—¶ï¼Œè¯¥å±æ€§å¦‚ä½•å˜åŒ–æ—¶è§¦å‘æ–¹æ³•å‘¢(estimatedProgresså±æ€§æ–°å˜åŒ–çš„æ—¶å€™è§¦å‘)ï¼Ÿ éœ€è¦ä¼ é€’ä»€ä¹ˆå‚æ•°å‘¢,
    [self.webView addObserver:self forKeyPath:@"estimatedProgress" options:(NSKeyValueObservingOptionNew) context:(nil)];
    
    //    KVOè®¾ç½®ä¸€ä¸ªè¿›åº¦æ¡ 4. å»ºç«‹ä¸€ä¸ªè¿›åº¦æ¡ view
    [self.view addSubview:({
        self.webProgreess = [[UIProgressView alloc] initWithFrame:CGRectMake(0, STATUSBARHEIGHT + 44, self.view.frame.size.width, 30) ];
        self.webProgreess;
    })];
}


# æ³¨æ„æˆ‘ä»¬å¯¹äºlist å°±æ˜¯layotå¸ƒå±€çš„éœ€è¦è°ƒæ•´ä¸€ç‚¹ç‚¹ğŸ¤
// IOS11 ä¹‹åæœ‰ä¸€ä¸ªæ–¹æ³• ç”¨æ¥ç¦æ­¢ æ»šåŠ¨é€‚é… ï¼ˆé»˜è®¤ç³»ç»Ÿè‡ªåŠ¨è®¾ç½®ï¼‰ æˆ‘ä»¬è¦è‡ªå·±å®ç°ï¼Œå› ä¸ºæˆ‘ä»¬è¿˜è¦å…¼å®¹ ä½ç‰ˆæœ¬çš„è®¾å¤‡
collectionViee.contentInsetAdjustmentBehavior = UIScrollViewContentInsetAdjustmentNever;
    

```

## IOSé€‚é…é—®é¢˜æ€»ç»“
### å®˜æ–¹é€‚é…
![](https://cdn.nlark.com/yuque/0/2022/png/1627571/1641482481722-b73962c6-a37d-44c1-bead-5d35648116fb.png)



â€œä¸¤ä¸ªç»´åº¦ ä¸‰ä¸ªæ–¹é¢â€ å»åšé€‚é… ï¼ˆé€»è¾‘åˆ†è¾¨ç‡ å’Œç‰©æµåˆ†è¾¨ç‡ç»´åº¦ï¼Œå¤§å°ç¼©æ”¾å¸ƒå±€é€‚é…ï¼ŒIphonexé€‚é…ï¼Œå›¾ç‰‡çš„é€‚é…xå€å›¾ï¼‰

