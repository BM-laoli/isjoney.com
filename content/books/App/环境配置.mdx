---
title: "React Native ç¯å¢ƒé…ç½®æŒ‡å—"
date: "2024-12-19"
summary: "è¯¦ç»†çš„ React Native å¼€å‘ç¯å¢ƒé…ç½®æ•™ç¨‹ï¼Œæ¶µç›– Mac å’Œ Windows å¹³å°ä¸‹çš„ Android/iOS ç¯å¢ƒæ­å»ºã€å¸¸è§é—®é¢˜è§£å†³æ–¹æ¡ˆåŠ M1 èŠ¯ç‰‡å…¼å®¹æ€§å¤„ç†ã€‚"
status: "completed"
tech: ["React Native", "Environment Setup", "Mobile Development"]
github: "https://github.com/BM-laoli"
arxiv: ""
keyId: "App"
---

> æœ¬æŒ‡å— ä¸»è¦æŒ‡å¯¼ Rnç¯å¢ƒçš„å®‰è£… ç›¸å…³ï¼Œå¦‚æœä½ ç…§ç€å®˜æ–¹æ–‡æ¡£é…ç½®æ²¡æœ‰é—®é¢˜çš„è¯ï¼Œå¯ä»¥ç•¥è¿‡
>



**<font style="color:#F5222D;">é‡è¦éå¸¸é‡è¦</font>****<font style="color:#F5222D;">âš ï¸</font>****<font style="color:#F5222D;">ï¼Œä¸€å®šè¦ç¡®ä¿æ‚¨æœ‰ä¸€ä¸ªéå¸¸å¥½å¾—ç½‘ç»œç¯å¢ƒï¼Œå®ƒéœ€è¦æ»¡è¶³è¿™æ ·çš„æ¡ä»¶</font>**

1. **<font style="color:#F5222D;">å¯ä»¥è¿æ¥åˆ°Google (ä¸€äº›SDK å’Œç¼–è¯‘å·¥å…·ä¸¥é‡ä¾èµ–GitHubï¼‰</font>**
2. **<font style="color:#F5222D;">ç½‘ç»œé€Ÿåº¦é«˜  ï¼ˆä¸€äº›SDKå¯èƒ½éå¸¸éå¸¸çš„å¤§ï¼å¤§åˆ°ä½ æ€€ç–‘äººç”Ÿ</font>****<font style="color:#F5222D;">ğŸ˜‚</font>****<font style="color:#F5222D;">ï¼‰</font>**

**<font style="color:#F5222D;"></font>**

## ä¸€ã€Macä¸‹çš„ç¯å¢ƒé…ç½®
> Macä¸‹çš„é…ç½®æ¯”è¾ƒçš„ç®€å•ï¼Œä¸»è¦æ˜¯æƒé™é—®é¢˜ï¼Œå…¶ä»–çš„éƒ½æ²¡æœ‰ä»»ä½•é—®é¢˜
>
> å¤§å“¥å¤§å§ä»¬ï¼Œçƒçƒä½ ä»¬å…ˆå»çœ‹çœ‹å®˜æ–¹æ–‡æ¡£ å§ [RNå®˜æ–¹æ–‡æ¡£-ç¯å¢ƒé…ç½®æŒ‡å—](https://reactnative.cn/docs/environment-setup)
>



> Vscode å›½å†…æº  ï¼ˆmacï¼‰[https://vscode.cdn.azure.cn/stable/3866c3553be8b268c8a7f8c0482c0c0177aa8bfa/VSCode-darwin-universal.zip](https://vscode.cdn.azure.cn/stable/3866c3553be8b268c8a7f8c0482c0c0177aa8bfa/VSCode-darwin-universal.zip)
>

### Mac -> Android
#### 1. å®‰è£…Brew 
è¯·ç‚¹å‡»è¿™ä¸ªè¿æ¥ [HomeBrewå›½å†…æº](https://gitee.com/cunkai/HomebrewCN) å»ä¾ç…§æŒ‡å¼•å®Œæˆå®‰è£…ï¼Œæ³¨æ„ğŸ“¢ ä¸è¦sudo ç„¶åæ‰§è¡Œï¼Œè¯·ç›´æ¥æ‰§è¡Œ é‡åˆ°è¦æ±‚å¯†ç å†å»è¾“å…¥

#### 2. å®‰è£…Node å’ŒWatchman
æ‰§è¡Œä»¥ä¸‹å‘½ä»¤

```shell
brew install node
brew install watchman
```

åˆ‡æ¢npmï¼ˆå¿…é¡»ï¼‰ä¸‹è½½æº å’Œä¸‹è½½yarn ï¼ˆéå¿…é¡»ï¼‰

```shell
# ä½¿ç”¨nrmå·¥å…·åˆ‡æ¢æ·˜å®æº
npx nrm use taobao

# å¦‚æœä¹‹åéœ€è¦åˆ‡æ¢å›å®˜æ–¹æºå¯ä½¿ç”¨
npx nrm use npm

# å®‰è£… yarn
npm install -g yarn
```

#### 3. å®‰è£…JDK
æ³¨æ„ğŸ“¢ éœ€è¦å®‰è£… <= 1.8çš„jdk ï¼Œé«˜ç‰ˆæœ¬ç›®å‰RN ä¸æ”¯æŒ

```shell
brew install adoptopenjdk/openjdk/adoptopenjdk8
```

#### 4. å®‰è£…å’Œé…ç½®Android Studio
è¿™ä¸ªæ­¥éª¤éå¸¸çš„å…³é”® ï¼Œåªè¦ä»”ç»†å®‰è£…æœ¬æ–‡æŒ‡å¼•ï¼ŒMacç”µè„‘åŸºæœ¬ä¸ä¼šèµ°ä¸ä¸‹å»

- [x] ä¸‹è½½ [Android studioä¸‹è½½ç«™](https://developer.android.google.cn/studio/)  ï¼ˆæ³¨æ„ï¼šå¦‚æœä½ æ˜¯M1çš„èŠ¯ç‰‡ï¼Œè¯·é€‰æ‹©ä¸€ä¸‹å“ˆï¼Œ åˆ«ä¸‹é”™äº†ï¼Œï¼‰

![](https://cdn.nlark.com/yuque/0/2021/png/1627571/1630403065728-97c1bd3a-87cb-4b17-893b-dde78442bc3b.png)![](https://cdn.nlark.com/yuque/0/2021/png/1627571/1630403117280-291c61c0-c381-45f9-8c92-0baf512621af.png)

![](https://cdn.nlark.com/yuque/0/2021/png/1627571/1630403198603-571c5fe8-b64c-4ecf-aa53-2bdab83b2529.png)

- [x] ç–¯ç‹‚ç‚¹å‡»Nextå®‰è£…å°±å¥½äº†
- [x] é‡ç‚¹ï¼ç¯å¢ƒSDKå®‰è£…âš ï¸

è¿™é‡Œå…ˆåˆ—ä¸€ä¸‹å®˜æ–¹æ–‡æ¡£åˆ¶å®šçš„ç‰ˆæœ¬

        * SKD Platforms è¯·é€‰æ‹©ï¼šAndroid 10.0 ï¼ˆQï¼‰  ä¸‹çš„ Android SDK Platform 29ï¼ŒInterl X86 Atom_64 System Image, å½“ç„¶å¦‚æœä½ éœ€è¦å®‰è£…å…¶ä»–æ›´é«˜çš„ç‰ˆæœ¬ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯29çš„ç‰ˆæœ¬æ˜¯å®˜æ–¹æŒ‡å®šçš„
        * SDK  Tools è¯·é€‰æ‹© Android SDK Build-Tools 31ä¸‹çš„ 29.0.2 ï¼ˆåŒæ ·ä¹Ÿæ˜¯å®˜æ–¹æ¨èçš„ç‰ˆæœ¬ï¼‰ ï¼ŒNDK ä¸‹çš„ 20.1.5948944ç‰ˆæœ¬å†ç„¶åå»å®‰è£…è¿™ä¸ª <font style="color:rgb(28, 30, 33);">Android SDK Command-line Tools (latest)å°±å¥½äº†</font>
- [x] ç¯å¢ƒé…ç½®ï¼ è¿™ä¸€æ­¥éå¸¸é‡è¦ï¼ğŸ“¢

æˆ‘ä»¬å…ˆçœ‹çœ‹ï¼Œshellä½¿ç”¨çš„æ˜¯ä»€ä¹ˆ ä½¿ç”¨ echo $0 å°±èƒ½å¾—åˆ°ç»“æœäº†ï¼Œ

å¦‚æœæ˜¯.zhrc å°±è¿è¡Œï¼Œä½ éœ€è¦å¾€ é…ç½®æ–‡ä»¶ä¸­è¾“å…¥ä¸‹é¢çš„å†…å®¹

```shell
# å¦‚æœä½ ä¸æ˜¯é€šè¿‡Android Studioå®‰è£…çš„sdkï¼Œåˆ™å…¶è·¯å¾„å¯èƒ½ä¸åŒï¼Œè¯·è‡ªè¡Œç¡®å®šæ¸…æ¥š
export ANDROID_HOME=$HOME/Library/Android/sdk
export PATH=$PATH:$ANDROID_HOME/emulator
export PATH=$PATH:$ANDROID_HOME/tools
export PATH=$PATH:$ANDROID_HOME/tools/bin
export PATH=$PATH:$ANDROID_HOME/platform-tools
```

```shell
# å¦‚æœä½ æ˜¯zhrc 
sudo vim i ~/.zshrc 

# å¦‚æœä½ æ˜¯ bash
sudo vim i ~/.bash_profile

# å¦‚æœåœ¨~ä¸‹çš„ï¼Œæ²¡æœ‰ è¿™ä¸¤ä¸ªæ–‡ä»¶ ï¼Œé‚£ä¹ˆæ‚¨å¯ä»¥touchåˆ›å»ºä¸€ä¸‹ ç„¶åå†å»ç¼–è¾‘ä»–
touch .zshrc  
touch .bash_profile  

# å…³äºVimè¯´æ˜
1. é”®ç›˜ i inter è¿›å…¥ä¿®æ”¹
2. ä¿®æ”¹å®Œä¹‹å å…ˆesc é€€å‡ºç¼–è¾‘æ¨¡å¼
3. shift + : å· è¾“å…¥wq ä¿å­˜å¹¶é€€å‡ºï¼Œå¦‚æœä½ é‡åˆ°é—®é¢˜å¯ä»¥å°è¯• wq! æˆ–è€…q! ç„¶åå®‰è£…æ­¥éª¤1.2.3é‡è¯•



```

#### 5. çœ‹çœ‹ä½ è¦è¿è¡Œå†æ¨¡æ‹Ÿå™¨è¿˜æ˜¯çœŸæœºä¸Š
+ æ¨¡æ‹Ÿå™¨

éšä¾¿å†Android Stuidoé‡Œåˆ›å»ºä¸€ä¸ª Androidé•œåƒ 

![](https://cdn.nlark.com/yuque/0/2021/png/1627571/1630407773305-7d4f57fc-ac62-4944-b2ed-1a4908ad9f43.png)

![](https://cdn.nlark.com/yuque/0/2021/png/1627571/1630407785651-676f45e0-fffe-42fc-a673-d7d4e5149283.png)

é€‰æ‹©ä¸€ä¸ªnextå°±å¥½äº†ï¼Œï¼ˆæ­¤æ­¥éª¤éœ€è¦ç½‘ç»œæ”¯æŒï¼è€Œä¸”å¿…é¡»æ˜¯åœ¨çº¿ä¸‹è½½çš„ï¼‰

+ çœŸæœº
    1. è¿æ¥ä¸Šç”µè„‘(usb) æ‰“å¼€è°ƒè¯•æ¨¡å¼
    2. çœ‹çœ‹æ˜¯å¦æœ‰è®¾å¤‡è¿æ¥ä¸Š

```shell
adb devices
```



### Mac -> IOS
> IOSçš„é…ç½® æ¯”è¾ƒçš„ç®€å• brew å’Œ Node Watchman éƒ½æ˜¯ä¸€æ ·çš„ï¼ŒJDKä¹‹åçš„ç« èŠ‚å°±æœ‰æ‰€ä¸åŒäº† éœ€è¦é¢å¤–æ³¨æ„
>

#### 1.  å®‰è£…Brew ï¼ˆåŒAndroidï¼‰
#### 2. å®‰è£…Node å’ŒWatchman ï¼ˆåŒAndroidï¼‰
#### 3. å®‰è£…Xcode ï¼ˆéå¸¸é‡è¦ï¼ï¼‰
Xcodeæ˜¯å¿…é¡»è¦è£…å¾—ï¼ŒXcode12 å¾—å®˜æ–¹è¯´æ˜å¾— éœ€è¦Xcode12ä»¥åŠæ›´é«˜çš„ç‰ˆæœ¬æ”¯æŒï¼Œå¦‚æœä½ çš„Macæ˜¯**<font style="color:#F5222D;">Bigsuer</font>**ç³»ç»Ÿé‚£å¯ä»¥ä¸å¿…æ‹…å¿ƒï¼Œç›´æ¥ä»App Storeä¸‹è½½ä¾¿æ˜¯ï¼Œå¦‚æœä½ çš„Macæ˜¯10.1xxçš„ç³»ç»Ÿéœ€è¦å»æ‰¾åˆ° **<font style="color:#F5222D;">Xcode12</font>**ç‰ˆæœ¬æœ€ä½èƒ½å¤Ÿæ”¯æŒåˆ°çš„ç‰ˆæœ¬ï¼Œå¦‚æœä¸æ”¯æŒï¼Œç›®å‰ä½ æ˜¯ç©ä¸è½¬çš„äº†ã€‚



å®‰è£…å®Œæ¯•ä¹‹åå®‰è£…å®˜æ–¹æ–‡æ¡£æ¥åŸºæœ¬ä¸ä¼šæœ‰é—®é¢˜

#### 4. å¹²ï¼æˆ‘çš„IOSæ€ä¹ˆè·‘ä¸èµ·æ¥
 

- [x] ( ä¸»è¦çš„é—®é¢˜è¿˜æ˜¯Cococapodçš„æºé—®é¢˜ ) Â 

 a.å®˜æ–¹æŒ‡å¯¼

è¯·æŒ‰ç…§å¦‚ä¸‹çš„è§„åˆ™ é…ç½®å¥½å…¬å¸çš„æºåœ°å€ï¼Œè¯¦ç»†çš„å¯ä»¥è§ å…¬å¸å®˜æ–¹çš„åœ°å€   
[https://confluence.newegg.org/pages/viewpage.action?pageId=129616563](https://confluence.newegg.org/pages/viewpage.action?pageId=129616563)  
çš„æ–‡æ¡£



 b. éå®˜æ–¹æŒ‡å¯¼![](https://cdn.nlark.com/yuque/0/2021/png/1627571/1630411193726-1cad1e5c-63da-4936-91fe-7b6bd1fa5259.png)

å¦‚æœä½ å‡ºæœ‰è¿™æ ·ç±»ä¼¼çš„é—®é¢˜ ï¼Œå¤šåŠè¿˜æ˜¯åŒ…å’Œç¯å¢ƒçš„é—®é¢˜,è¿™ç¯‡æ–‡ç« ç»™å‡ºäº†è¯¦ç»†çš„è¯´æ˜å’Œæ“ä½œæŒ‡å—,è¯·å‚é˜…

[https://zhuanlan.zhihu.com/p/376754036](https://zhuanlan.zhihu.com/p/376754036)

åœ¨æ¥ä¸‹æ¥çš„å®‰è£…ä¸­ï¼Œè¿˜æ˜¯ä¼šæŠ¥é”™ ï¼Œæ²¡å…³ç³» æŒä¹‹ä»¥æ’ å¤šæä¸€äº›å°±å¥½äº† è¿™å¯èƒ½éœ€è¦è¯æ‰ä½ ä¸€äº›æ—¶é—´ï¼Œè¯·è§„åˆ’å¥½

![](https://cdn.nlark.com/yuque/0/2021/png/1627571/1630411322949-b8be5a77-93f2-41c7-bf18-2b11d4dde686.png)

- [x] Macç”µè„‘çš„é—®é¢˜

ç›®å‰å·²çŸ¥çš„BUGï¼ŒM1èŠ¯ç‰‡IOSæ‰“åŒ…æ—¶å€™ ä¸èƒ½ä½¿ç”¨ use_flipper!() (åœ¨IOSç›®å½•ä¸‹çš„ï¼ŒPodfileä¸­) ä¸ç„¶è·‘ä¸èµ·æ¥éœ€è¦æŠŠè¿™ä¸ªæ³¨æ‰ï¼ŒMacosç³»ç»Ÿç‰ˆæœ¬11.4.x æ— æ³•çƒ­æ›´æ–°çš„ï¼Œè¯·å‡çº§åˆ°11.5.xç‰ˆæœ¬å°±å¯ä»¥è§£å†³äº†ï¼Œå…·ä½“çš„Issuesè¯·çœ‹å®˜æ–¹çš„é“¾æ¥ 

[https://github.com/facebook/react-native/issues/31941](https://github.com/facebook/react-native/issues/31941)

[https://github.com/facebook/metro/issues/686](https://github.com/facebook/metro/issues/686)



## äºŒã€Windowsç”¨æˆ·ä¸‹çš„ç¯å¢ƒé…ç½®
> windowsç”¨æˆ·ä¸‹åªæ”¯æŒå¼€å‘Androidçš„åº”ç”¨ï¼Œè¯·çŸ¥æ™“
>



## ä¸‰ã€é—®é¢˜æ”¶å½•
> ä¸»è¦æ˜¯Windowsä¸‹çš„é—®é¢˜æ¯”è¾ƒå¤šï¼Œä½†æ˜¯æœ€ä¸»è¦çš„é—®é¢˜æ˜¯ç½‘ç»œé€Ÿåº¦é—®é¢˜ï¼Œå’Œçƒ­ç¼–è¯‘é—®é¢˜ï¼Œ
>

### 1. ç½‘ç»œé€Ÿåº¦é—®é¢˜
> ä¸»è¦é—®é¢˜æ˜¯SDKä¸‹è½½éå¸¸æ…¢çš„é—®é¢˜ è¿™é‡Œæˆ‘ä»¬æ”¾åˆ°äº†ä¸€ä¸ªæ–‡ä»¶å¤¹ğŸ“‚ä¸‹ï¼ŒæŠŠAndroid Stuidoå®‰è£…å¥½ä¹‹åï¼Œæ‰¾åˆ°SDK
>
> é…ç½®çš„ç›®å½•ï¼ˆå°±æ˜¯Macå®‰è£…SDké…ç½®çš„é¡µé¢ï¼‰æœ‰å®ƒçš„SDKç›®å½•ï¼ŒæŠŠå…±äº«èµ„æºä¸‹çš„SDKè§£å‹ä¸‹æ¥ï¼Œé‡å¯Android Studio å®ƒå°±èƒ½è‡ªåŠ¨å»æ‰«ææ‚¨çš„SDKäº†
>

æ–‡ä»¶å¤¹ï¼š

### 2. çƒ­ç¼–è¯‘é—®é¢˜
> ç›®å‰å…¬å¸çš„ç”µè„‘ å°å¼æœº Windows æ˜¯è¿æ¥ä¸åˆ° å¯¹åº”çš„6xç½‘æ®µçš„ï¼Œä½†æ˜¯è¦è·å¾—çƒ­ç¼–è¯‘çš„æ•ˆæœè®©æ‰‹æœº å¼€å‘çš„æ—¶å€™è¿æ¥åˆ°ä½ çš„NodeæœåŠ¡å™¨ä¼ è¾“çƒ­ç¼–è¯‘çš„ä»£ç ï¼Œå°±å¿…é¡»è¦è¿æ¥ï¼Œæ‰€ä»¥ç›®å‰ä¸ºæ­¢Windows ç¯å¢ƒä¸‹æ˜¯æ— æ³•çƒ­ç¼–è¯‘ï¼Œä½†æ˜¯å¯ä»¥æ‰“åŒ…ç„¶åå®‰è£…ï¼Œï¼ˆè¯·ä¸è¦å°è¯•ä½¿ç”¨ä»€ä¹ˆå…¶ä»–è™šæ‹ŸåŒ–æ–¹æ¡ˆï¼Œå…¬å¸å†…éƒ¨å…¨éƒ¨ä¼šæ–­å¼€ï¼‰
>

### 3. é‚£ï¼Ÿwindowå¼€å‘å‡‰å‡‰äº†ï¼Ÿ
> åŸºæœ¬ä¸Šæ˜¯è¿™æ ·çš„äº†ï¼Œä½†æ˜¯ï¼æœ‰è§£å†³æ–¹æ¡ˆï¼Œå¯ä»¥è¯•ä¸€ä¸‹ç”¨ä½ Expo-cliæ¥è®©RNè¿è¡Œåˆ°Webç«¯ä¸Šï¼Œå¼€å‘å’Œå®è·µä½ çš„å°DemoğŸ˜
>

[æ–°ä¸€ä»£è„šæ‰‹æ¶Expo](https://docs.expo.dev/workflow/expo-cli/#installation)





## <font style="color:#F5222D;">å››ã€å…³äºM1èŠ¯ç‰‡çš„é—®é¢˜ é‡è¦ï¼</font>


> å¦‚æœæ‚¨çš„Macè®¾å¤‡ä¸æ˜¯M1èŠ¯ç‰‡ï¼Œå®é™…æµ‹è¯• å®‰è£…ä»¥ä¸Šæ­¥éª¤æ²¡æœ‰å‘ç°é—®é¢˜ï¼Œå¦‚æœä½ çš„è®¾å¤‡æ˜¯M1èŠ¯ç‰‡é‚£ä¹ˆï¼Œåœ¨å®˜æ–¹çš„issuesä¸‹æœ‰ä¸¤ä¸ªè§£å†³æ–¹æ¡ˆ
>

### 1. ä¸è¦ç”¨ use_flipper å»ç¼–è¯‘
æºåœ°å€[https://github.com/facebook/react-native/issues/31438](https://github.com/facebook/react-native/issues/31438)

```shell
1. Delete node_modules
2. Delete Podfile.lock and Pods/ folder
3. update Pod file and comment use_flipper() #use_flipper!()
4. Install node dependencies with npm install
5. Install pod dependencies with pod install in ios folder.
6. yarn run ios
```



### 2. æŒ‡å®š  use_flipper ç‰ˆæœ¬å†å»ç¼–è¯‘
è¯¦ç»†åœ°å€ï¼š[https://github.com/aiba/react-native-m1](https://github.com/aiba/react-native-m1)

### 3. é¢å¤–çš„å¤„ç† ï¼ˆæ›´åŠ è¯¦ç»†çš„M1èŠ¯ç‰‡å…¼å®¹å¤„ç†æ–¹æ¡ˆï¼‰
è¿˜æœ‰ä¸ªæƒ…å†µæ˜¯å®‰è£…çš„æ—¶å€™å‘ç”Ÿçš„é”™è¯¯ ï¼Œä½ å¯èƒ½éœ€è¦å‚è€ƒè¿™ä¸ª  [https://github.com/facebook/react-native/issues/31941](https://github.com/facebook/react-native/issues/31941)

æ€»çš„å¤„ç†æ­¥éª¤å¦‚ä¸‹

    1. åˆ é™¤node_modules
    2. åˆ é™¤Podfile.lock and Pods/ folder
    3. å¯¹Podfileæ·»åŠ å¦‚ä¸‹è®¾ç½®



```shell
++++
  post_install do |installer|
      installer.aggregate_targets.each do |aggregate_target|
        aggregate_target.user_project.native_targets.each do |target|
          target.build_configurations.each do |config|
            config.build_settings['LIBRARY_SEARCH_PATHS'] = ['$(SDKROOT)/usr/lib/swift', '$(inherited)']
          end
        end
        aggregate_target.user_project.save
      end
    react_native_post_install(installer)
  end
end
```

## äº”ã€å…³äºXcodeçš„é—®é¢˜
ä¸»è¦çš„é—®é¢˜è¿˜æ˜¯å¼€å‘çš„æ—¶å€™é—®é¢˜å’Œè°ƒè¯• ï¼ŒæŸ¥æ‰¾Iosç³»ç»Ÿé”™è¯¯çš„æ–¹å¼ï¼Œ

#### 1. é¡¹ç›®çš„Idè¢«å äº†
æ‚¨å¯ä»¥å‚è€ƒè¿™ä¸ªæ–‡æ¡£ï¼ŒæŠŠBundle identiferæ”¹ä¸€ä¸‹å°±å¥½äº†

[https://blog.csdn.net/qq_31337641/article/details/78401465](https://blog.csdn.net/qq_31337641/article/details/78401465)

![](https://cdn.nlark.com/yuque/0/2021/png/1627571/1630470909938-3339dd09-2ae4-4ea7-9939-b2c082f878fc.png)



